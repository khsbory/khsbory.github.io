
//uxIscrollSlider - use Besttab, departmentstoretab
$.fn.uxIscrollSlider = function(options){
	var settings =$.extend({
		'selector':'uxiscroll-slider', //parent 'div' element of 'ul'
		'ulWidthPlus' : 0,
		'refreshToSelectedTab' : true,
		'selectedTabClass' :'selected',
		'plusCenterwidth' : 0
	},options);
	var $this = this;
	$this.addClass(settings.selector);
	$this.each(function(){
		var boxW = 0,liW = 0;
		$(this).find('li').each(function(){
			liW = $(this).width();
			boxW += liW;
		});
		$(this).find('ul').css('width', boxW + settings.ulWidthPlus);
	});
	var myScroll = new Array();
	$this.each(function(i){
		$(this).attr('id', settings.selector+i);
		var sID = $(this).attr('id');
		myScroll.push(new  iScroll(sID , {
			vScroll:false,
			hScrollbar: false,
			vScrollbar: false,
			hideScrollbar:true,
			checkDOMChanges: true
		}));
		if(settings.refreshToSelectedTab === true){
			var refreshTab = function(target, scroll_menu) {
				if (scroll_menu !== undefined) {
					var target;
					var $ul = target.parent("ul");
					var w=0;
					var idx=0;
					target.each(function() {
						if($(this).hasClass(settings.selectedTabClass)) idx = $(this).index();
						w+=$(this).outerWidth(true);
					});
					if (target != undefined) {
						var innerW = parseInt($(window).innerWidth());
						var ulW =  $ul.outerWidth(true);
						var $curMenu = $ul.find("li").eq(idx);
						var cur_Padding = parseInt($curMenu.css('padding-left'));
						var curPosLeft;
						var curPos =($curMenu.position().left-cur_Padding) +  ($curMenu.outerWidth(true)/2);
						var centerPos = curPos*-1 + (innerW/2);
						var wmax = -1*($ul.outerWidth(true) - innerW + settings.plusCenterwidth) ;
						var tg;
						if(centerPos <=wmax )	{
							tg = wmax;
						}
						else if(centerPos>=0){
							tg = 0;
						}
						else{
							tg = centerPos;
						}
						setTimeout(function(){
							scroll_menu.scrollTo(tg,0,200);
						},100);
					}
				}
			}
			refreshTab($(this).find('li'), myScroll[i]);
		}//if
	});
}

// uxScrollFixedCtrl - use Besttab
$.fn.uxScrollFixedCtrl = function(options){
	var settings = $.extend({
		'selector': 'uxscroll-ctrl',
		'animationTime': 0,
		'fixClass': 'uxscroll-ctrl_fixed',
		'scrollLimit': 0,
		'ctrlTop': 0, //setting for value of top,
		//'delta' : 15, scroll감지 최소값
		'speed': 100,
		'wrapHeightNeccessary' : false,
		'reverseShow' : false, // when scroll reverse, some Element show
		'reverseSelector': '.reverse'
	},options);
	var $this = this;
	$this.addClass(settings.selector);
	var nTop;
	var ctrlTop = settings.ctrlTop;
	$(window).scroll(function(e){
		var sTop = $(document).scrollTop();
		var $reverseObj = $(settings.reverseSelector);
		if(settings.reverseShow === true){
			if (nTop <  sTop) {
				$reverseObj.stop().animate({'opacity' : '0'},settings.speed);
			}else{
				$reverseObj.stop().animate({'opacity' : '1'},settings.speed);
			}
		}
		nTop = sTop;
		if(sTop > settings.scrollLimit){
			$this.addClass(settings.fixClass);
			if(ctrlTop !== 0){
				$this.css('top',ctrlTop);
			}
		}else{
			$this.removeClass(settings.fixClass);
			if(settings.reverseShow === true){
				$reverseObj.stop().animate({'opacity' : '1'},settings.speed);
			}
			if(ctrlTop !== 0){
				$this.css('top','');
			}
		}
	});
	if(settings.wrapHeightNeccessary === true){
		var thisheight = $this.height();
		$this.parent('div').height(thisheight);
	}
}

$.fn.swiperSet = function(options){
	var option = {
		appendController : null,
		pageControl : false,
		nextControl : false,
		prevControl : false,
		scrollbarControl : false,
		playControl : false,
		pauseControl : false
	};

	this.each(function(){
		$.extend(option, options);
		var $this = $(this),
			$appendController = $this;

		if (option.appendController){
			$appendController = $(option.appendController);
		}

		if ($this.data('swiper') || !$.isFunction(window.Swiper)) return;

		if (option.pageControl){
			$appendController.append('<div class="swiper-pagination"></div>');
			option.pagination = $this.find('.swiper-pagination').get(0);
		}
		if (option.nextControl){
			$appendController.append('<button class="swiper-button-next"><span class="swiper-button-next-text">다음</span></button>');
			option.nextButton = $this.find('.swiper-button-next').get(0);
		}
		if (option.prevControl){
			$appendController.append('<button class="swiper-button-prev"><span class="swiper-button-prev-text">이전</span></button>');
			option.prevButton = $this.find('.swiper-button-prev').get(0);
		}
		if (option.scrollbarControl){
			$appendController.append('<div class="swiper-scrollbar"></div>');
			option.scrollbar = $this.find('.swiper-scrollbar').get(0);
		}
		if (option.playControl){
			$appendController.append('<button class="swiper-button-play"><span class="swiper-button-play-text">재생</span></button>');
			option.playButton = $this.find('.swiper-button-play').get(0);
		}
		if (option.pauseControl){
			$appendController.append('<button class="swiper-button-pause"><span class="swiper-button-pause-text">정지</span></button>');
			option.pauseButton = $this.find('.swiper-button-pause').get(0);
		}
		if (option.autoplay){
			$(option.playButton).addClass('active');
		} else {
			$(option.pauseButton).addClass('active');
		}

		if ($.isFunction(window.Swiper)){
			$this.data('swiper', new Swiper($this.get(0), option));
		}

		$(option.playButton).on('click', function(){
			$this.data('swiper').startAutoplay();
		});
		$(option.pauseButton).on('click', function(){
			$this.data('swiper').stopAutoplay();
		});
		$this.data('swiper').on('onAutoplayStart', function(){
			$(option.playButton).addClass('active');
			$(option.pauseButton).removeClass('active');
		});
		$this.data('swiper').on('onAutoplayStop', function(){
			$(option.playButton).removeClass('active');
			$(option.pauseButton).addClass('active');
		});
	});
}

/*
* name	: scrollProgressbar
* desc 	: 차오르는 스크롤바 interaction
*/
$.fn.uxeScrollProgressbar = function (options) {
    var settings = $.extend({
        'selector'	: 'uxe_scrollProgressbar',
        'item'		: $(this).children(),
		'moreBtn'	: $(this).find('.more')
    },options);
    return this.each(function(){
        if(!$(this).hasClass(settings.selector)){
            var $this 				= $(this);
            var $item				= $this.find(settings.item) ;
            var $exceptObj	= $this.find(settings.moreBtn);
            var li_len 				= $item.length;
            var li_w				= $item.outerWidth();
            var li_h					= $item.outerHeight();
            var initScrollPer, ratio, total_width =0;

            //SET Width
            if($exceptObj.length>0)	total_width=((li_len-$exceptObj.length)*li_w)+$exceptObj.outerWidth();
            else total_width=li_len * li_w;

            //SET dummy
            $this.addClass(settings.selector)
                .wrapInner('<div class="uxe_item_group" style="width:'+total_width+'px"></div>')
                .wrapInner('<div class="uxe_scroll_area" style="height:'+li_h+'px"></div>')
                .append('<div class="uxe_scroll_progress"><progress max="100" value="0"></progress></div>');

            //SET progressScroll
            var $scollArea	= $this.find('.uxe_scroll_area');
            var $progressBar= $this.find('progress');

            if(total_width < $this.width() ) {	//list size < scrollWindow size : hide progressbar
                $progressBar.hide();
                if($exceptObj.length>0) $exceptObj.addClass("on");
            }else{	//init scroll progressValue
                ratio =  $scollArea.width() / total_width;
                initScrollPer = Math.round(ratio* 100) ;
                $progressBar.attr('value', parseInt(initScrollPer));
                $progressBar.show();

                //event
                $scollArea.bind('scroll',function() {
                    var winWidth = $(this).width();
                    var max = total_width -  winWidth;
                    var now = $(this).scrollLeft() ;
                    var progressValue =  now/max ;
                    var moveProgresValue =0;

                    //이동거리 * 남은 프로그레스바 비율
                    moveProgresValue =  parseInt(progressValue*100) * ((100 - parseInt(initScrollPer))/100) ;
                    $progressBar.attr('value', moveProgresValue + parseInt(initScrollPer));
                    if($exceptObj.length>0){
                        var endPoint = $progressBar.attr('value');
                        if(endPoint==100)  setTimeout(function(){$exceptObj.addClass("on") }, 0.5);
                        else   $exceptObj.removeClass("on");
                    }
                });

            }
        }
    })
};


$.fn.uxSlidingMenu = function (options) {
    var settings = $.extend({
        'selector' : 'uxslide',
        'itemSelector' : '> li',
        'itemClass': 'uxslide__item',
        'navigation' : '.uxslide__nav',
        'activeItemClass': 'uxslide__item--active',
        'slidingContentSelector' : '.uxslide__content',
        'activeSlidingContentClass' : 'uxslide__content--active',
        'speed': 0,
        'clickedShowOnly': false,
        'memorizeScrollTop' : false
    }, options);
    return this.each(function(){
        var $this = $(this);
        var $nav = $(this).find(settings.navigation);
        var $con = $this.find(settings.slidingContentSelector);
        $this.addClass(settings.selector).find(settings.itemSelector).addClass(settings.itemClass);
        $nav.each(function(){
        	var $thisnav = $(this);
            $thisnav.unbind('click').bind('click',function(e){
                e.preventDefault();
                var toggleSlide = function(){
                	$thisnav.parents('.'+settings.itemClass).toggleClass(settings.activeItemClass).find(settings.slidingContentSelector).slideToggle(settings.speed).toggleClass(settings.activeSlidingContentClass);
                }
                if(settings.clickedShowOnly === true){
                   $thisnav.parents('.'+settings.itemClass).siblings().removeClass(settings.activeItemClass).find(settings.slidingContentSelector).hide();
                }
                toggleSlide();
            });
        });
    });
};

//by envyz - radio and checkbox
$.fn.checkForm = function () {
    return this.each(function () {
        var dsfrm = $(this).find("input:checkbox, input:radio");
        dsfrm.wrap("<em class='ds_form "+dsfrm.attr("class")+"'></em>");
        dsfrm.removeAttr("class");
        var wrap = $(this),
            label = wrap.find(".label"),
            trigger = wrap.find("em.ds_form input");
        if (trigger.is(":disabled")) {
            trigger.parent().addClass("js_disabled");
        } else if (trigger.is(":checked")) {
            trigger.parent().addClass("js_checked");
        }
        if (trigger.is("[type=checkbox]")) {
            _checkbox();
        } else if (trigger.is("[type=radio]")) {
            _radio();
        }
        //checkbox
        function _checkbox() {
            trigger.on("click", function() {
                if (trigger.parent().hasClass("js_checked")) {
                    trigger.prop("checked", false);
                    trigger.parent().removeClass("js_checked");
                } else {
                    trigger.prop("checked", true);
                    trigger.parent().addClass("js_checked");
                }
            });
        };
        //radiobutton
        function _radio() {
            var groupName = trigger.attr("name");
            wrap.find("em>input:radio[name="+groupName+"]").on("click", function() {
                $("em>input:radio[name="+groupName+"]").parent().removeClass("js_checked");
                $(this).attr("name", groupName).parent().addClass("js_checked");
            });
        };
        trigger.blur(function() {
            trigger.parent().removeClass("js_focus");
        }).focus(function() {
            trigger.parent().addClass("js_focus")
        });
    });
};

//찜하기 애니메이션 - 백화점, CPP, LP/SRP, 베스트
var addInterAni = function(callback){
	if( $(callback).parents('.smiledelivery').length ){
		$('<div class="ly_inter"><embed src="//pics.gmarket.co.kr/mobile/single/kr/common/vip_check.svg" type="image/svg+xml"></div>').appendTo('body');
	}else{
		$('<div class="ly_inter"><embed src="//pics.gmarket.co.kr/mobile/single/kr/common/heart_toast.svg" type="image/svg+xml"></div>').appendTo('body');
	}
	$('.ly_inter').animate(
	{opacity : 1}
	, 300).delay(1000).animate(
	{opacity : 0}
	, 300, function(){$('.ly_inter').remove();});
}

// 장바구니추가 애니메이션 - 백화점, CPP, LP/SRP, 베스트
var addCartAni = function(callback){
	$('<div class="ly_inter"><embed src="//pics.gmarket.co.kr/mobile/single/kr/common/vip_check.svg" type="image/svg+xml"></div>').appendTo('body');
	var tgRight = (window.innerWidth - 128)/2;
	var tgTop = (window.innerHeight - 128)/2;
	$('.ly_inter').css({right:tgRight + 64, top:tgTop+64});
	$('.ly_inter').animate({width : '128px', opacity : 1, marginTop  : -64, marginRight  : -64}, 200).delay(1000)
	.animate({top : 80 , right : 80 , opacity : 0, width: '16px', height : '16px'},500, function(){
		$('.ly_inter').remove();
		if(typeof callback === 'function') {
			callback();
		}
	});
}


// 찜하기/장바구니 애니메이션 버튼 토글 - 백화점, CPP, LP/SRP, 베스트
var btnToggleAction = function(){
	var btn = $('.btn_addcart,.btn_zzim,.element-info-cart,.element-info-favorite,.button__favor,.bask,.btn_add_all');
	btn.each(function(){
		$(this).on('click',function(e){
			e.preventDefault();
			if($(this).attr('data-click-state') == 1) {
				$(this).attr('data-click-state', 0).removeClass('on');
			} else {
				$(this).attr('data-click-state', 1).addClass('on');
				if($(this).hasClass('btn_zzim')){
					addInterAni();
				}
				else if($(this).hasClass('element-info-favorite')){
					addInterAni();
				}
				else if($(this).hasClass('button__favor')){
					addInterAni();
				}
				else if($(this).hasClass('btn_addcart')){
					addCartAni();
				}
				else if($(this).hasClass('element-info-cart')){
					addCartAni(this);
				}
				else if($(this).hasClass('bask')){
					addCartAni(this);
				}
				else if($(this).hasClass('btn_add_all')){
					addCartAni(this);
				}
			}
		}); //on
	}); //each
}

// 프리미엄 상품평
function textareaResize($target){
	var rows = $target.data("rows");
	var count = $target.data("count");
	if (!rows){
		rows = 1;
	}
	$target.attr("rows", rows);
	var textareaH = $target.get(0).scrollHeight-(parseInt($target.css("padding-top").replace(/px/g, ""))+parseInt($target.css("padding-bottom").replace(/px/g, "")));
	var textareaLineH = parseInt($target.css("line-height").replace(/px/g, ""));
	$target.attr("rows", Math.round(textareaH/textareaLineH));
	if (count){
		$(count).text($target.val().length);
	}
}
$(document).on("keyup", ".textarea_resize", function(){
	textareaResize($(this));
});
function primiumReview(){
	var $sns_noti = $('.primium_review .sns_area .btn_noti');
	var $sns_noti_layer = $('.primium_review .sns_area .sns_ly_noti');
	var $sns_noti_close = $sns_noti_layer.find('.btn_close');
	var $btn_notice = $('.primium_review .notice_area .tit');

	$sns_noti.click(function(e){
		e.preventDefault();
		if($sns_noti_layer.is(':visible')){
			$sns_noti.removeClass('on');
			$sns_noti_layer.hide();
		}else{
			$sns_noti.addClass('on');
			$sns_noti_layer.show();
		}
	});
	$sns_noti_close.click(function(e){
		e.preventDefault();
		$sns_noti.removeClass('on');
		$sns_noti_layer.hide();
	});
	$btn_notice.click(function(e){
		e.preventDefault();
		if($(this).hasClass('on')){
			$(this).removeClass('on');
			$(this).next().hide();
		}else{
			$(this).addClass('on');
			$(this).next().show();
		}
	});
}



//2016 GNB RENEWAL
$(function () {
	if ($('.header_fix, .category-slider, .card--full').length>0){ headerFix(); }

	// TOP button
	var toTheTop = $('.btn_top,.btn_top_main,.btn_top_bar');
	toTheTop.click(function(e){
		e.preventDefault();
		$(window).scrollTop(0);
	});
	$(window).on('scroll', function(e){
		if($(window).scrollTop() > 1){
			$('.btn_top_bar').addClass('active');
		}else{
			$('.btn_top_bar').removeClass('active');
		}
	});

	// SRP select
	$('.search_box .inp_blank, .keyword_swipe .word').click(function(){
		$('html').addClass('search-box-focused')
		$('.search_box').removeClass('focus');
		document.getElementById("scb_ip").focus();
	});
	SelectText();

	$('#header_search_layer .del_btn').click(function(){
		$('.search_box').removeClass('focus');
		$('#scb_ip').val(null).focus();
	});
	$('.keyword_swipe .del').click(function(){
		$(this).parents('li').remove();
	});

	gnbMenu();
});

var gnbMenu = function(){
	if($("#home_tabs").length == 0) return;
	var tab_trans_pos,
		home_tab_category_list = $('#home_tabs_scroll .inner'),
    	$scrollTab = $('.menu_scut .inner_wrap'),
    	scrollTabRight,
    	refreshTab,
    	gnbScroll,
    	boxW = 0,
		liW = 0;

	function tab_trans_pos_check(){
		var sTop = home_tab_category_list.css('transform');
		var values = sTop.split('(')[1];
		values = values.split(')')[0];
		values = values.split(',');
		tab_trans_pos = values[4];
	}

	$('#home_tabs a').each(function(){
		liW = $(this).width();
		boxW += liW;
	});

    home_tab_category_list.css('width', boxW);
	$scrollTab = $('.menu_scut .inner_wrap');
	scrollTabRight = -(boxW-$(window).width());
	gnbScroll = new iScroll('home_tabs_scroll', {
		vScroll: false,
		hScrollbar: false,
		vScrollbar: false,
		hideScrollbar: true,
		checkDOMChanges: true,
        onRefresh: function(){
            home_tab_category_list.addClass('on');
		},
		onScrollMove : function(){
			tab_trans_pos_check();
			if(tab_trans_pos >= 0){
				$scrollTab.removeClass('left');
			}else{
				$scrollTab.addClass('left');
			}
			if(tab_trans_pos >= scrollTabRight){
				$scrollTab.removeClass('right');
			}else{
				$scrollTab.addClass('right');
			}
		},
		onScrollEnd : function(){
			tab_trans_pos_check();
			if(tab_trans_pos == 0){
				$scrollTab.removeClass('left');
			}else if(tab_trans_pos == scrollTabRight){
				$scrollTab.addClass('right');
			}
		}
	});

	refreshTab = function(target, scroll_menu) {
		if (scroll_menu !== undefined) {
			var target;
			var $ul = target.parent(".inner");
			var w=0;
			var idx;
			target.each(function() {
				if($(this).hasClass("on")) idx = $(this).index();
				w+=$(this).outerWidth(true);
			});
			if($ul.find("a").length === idx+1){
				$ul.parents('.menu_scut').addClass('last');
			}
			var btnsW = 0;

			if (target != undefined) {
				var innerW = parseInt($(window).innerWidth());
				var ulW =  $ul.innerWidth(true);
				var $curMenu = $ul.find("a").eq(idx);
				var cur_Padding = parseInt($curMenu.css('padding-left'));
				var curPos =($curMenu.position().left-cur_Padding) +  ($curMenu.outerWidth(true)/2);
				var centerPos = curPos*-1 + (innerW/2);
				var wmax = -1*($ul.innerWidth(true) - innerW) ;
				var tg;
				if(centerPos <=wmax )	{
					tg = wmax;
				}
				else if(centerPos>=0){
					tg = 0;
				}
				else{
					tg = centerPos;
				}
				setTimeout(function(){
					scroll_menu.scrollTo(tg,0,200);
				},300);
			}
		}
	}
	refreshTab($('#head.new .menu_scut a'), gnbScroll);
}
function SelectText() {
	var box_width = $('#head .keyword_swipe').innerWidth() * 0.3;
	var w_ul = $('#keyword_swipe li').eq(0).outerWidth();
	var w_ks = $('#keyword_swipe').width();
	var li_inp = $('#head .keyword_swipe .inp_blank')
	if($('#keyword_swipe li').length > 2){
		li_inp.css('width',box_width);

	}else{
		li_inp.css('width',(w_ks -w_ul));
	}
	$('.keyword_swipe').scrollLeft(10000);
	$('.keyword_swipe .word').click(function(){
		$('.inp').scrollLeft  = $('.inp').scrollWidth;
		var wordIdx = $('.keyword_swipe li');
		var myIdx = $(this).parents('li').index()+1;
		var posCursor = 0;
		for ( i=0; i<myIdx; i++){
			var posCursor2 = wordIdx.eq(i).find('.word').text().length+1;
			posCursor = posCursor + posCursor2
		}
		posCursor = posCursor-1
		var input = document.getElementById("scb_ip");
		input.focus();
		input.setSelectionRange(posCursor,posCursor);
	});
	var kw_inp_w = $('.keyword_swipe .inp_blank').width();
	var kw_sl = $('.keyword_swipe').scrollLeft();
	$('.keyword_swipe').scrollLeft(kw_sl - kw_inp_w - 13);
}
function searchBoxGD(){
	var elmnt = document.getElementById("keyword_swipe");
	var obj_gd = $('#search_box');
	var sc_left =	elmnt.scrollLeft;
	var w_elmnt = elmnt.width;
	var w_elmnt_ul = elmnt.getElementsByTagName('ul').width;
	var len_li = $('#keyword_swipe li').length;
	if(sc_left > 0){
		if(w_elmnt > w_elmnt_ul){
			obj_gd.removeClass('gd');
		}else{
			if(len_li > 2){
				obj_gd.addClass('gd');
			}
		}
	}else{
		obj_gd.removeClass('gd');
	}
}

function focusKeypadShowHide(){
	var inp_txt_focus = [$('#content input[type="text"]'),$('#contents input[type="text"]'),$('textarea'),$('select')];

	$.each(inp_txt_focus, function(){
		$(this).focusin(function(){

		});
		$(this).focusout(function(){
			if($('.ip_delete' + ':hover').length) {
				$('.ip_delete').prev('input[type=text]').focus().val('');
			}
		});
	});
};




function srpFront(){
	$('#search_button').show();
};

$(document).on("touchstart", function(){  });
$(document).ready(function(){
	SelectText();
	focusKeypadShowHide();
	primiumReview();
	vipDetailTabNav();
	gVipTabScroll();
});

// VIP Detail Tab Nav
function vipDetailTabNav(){
	if($('.goods .vip_tab_nav.v2').length > 0) return;
	var banner_height = $('.scroll_wrap').height();
	var vipTabNav = $('.vip_tab_nav');
	$(window).scroll(function(){
		var scroll_top = $(window).scrollTop();
		if(scroll_top > banner_height){
			vipTabNav.addClass('bg');
		}else{
			vipTabNav.removeClass('bg');
		}
	});
};

window.bodyScrollFixed = { // body영역 스크롤 막기/풀기
	scrollStop : function(){
		var bodyScFixTop = $(window).scrollTop();
		this.oldScrollTop = bodyScFixTop;
		$('body').addClass('scFix').css('top',-bodyScFixTop);
	},
	scrollPlay : function(){
		$('body').removeClass('scFix').css('top','');
		$('html,body').scrollTop(this.oldScrollTop);
	}
};
window.bodyScrollFixed2 = { // body영역 스크롤 막기/풀기2
	scrollStop : function(){
		$('.dimmed, #foot').on('scroll touchmove mousewheel', function(e){
			e.preventDefault();
			e.stopPropagation();
			return false;
		});
	},
	scrollPlay : function(){
		$('.dimmed, #foot').off('scroll touchmove mousewheel');
	}
}

window.vipOptPrdlist = {
	init : function(pid){
		this.targetParentId = $('#'+pid);
		this.setElements();
		this.setOpts();
		this.initLayOut();
		this.bindEvents();
	},
	initReset : function(pid){
		this.targetParentId = $('#'+pid);
		this.setElements();
		this.selectListWrap.removeClass('on');
		bodyScrollFixed2.scrollPlay();
		this.goodsDimmed.hide();
		this.iScroll.destroy();
		this.iScroll = null;
		this.unBindEvents();
	},
	setElements : function(){
		this.selectListWrap = this.targetParentId.find('.selcted_card_box');
		this.btnSelect = this.selectListWrap.find('>.card');
		this.selectListBox = this.selectListWrap.find('.prd_selct_lst_wrap');
		this.selectList = this.selectListWrap.find('.prd_selct_lst > li');
		this.goodsDimmed = $('.goods .dimmed');
		this.goodsTabId = $('.goods').find('>div').attr('id');
	},
	setOpts : function(){
		this.currentScroll = 0;
		this.nextScroll = 0;
		this.selectLisLen = this.selectList.length;
	},
	initLayOut : function(){
		if(this.selectLisLen > 4){
			this.overScroll();
		}else{
			this.selectListBox.css('height',this.selectLisLen * 60)
		}
	},
	bindEvents : function(){
		if($._data(this.btnSelect[0], 'events') == undefined || $._data(this.btnSelect[0], 'events').click.length == 0) {
			// 중복 Binding 방어처리
			this.btnSelect.on('click', $.proxy(this.cardBoxToggle,this));
		}
		$('.sp_hd').on('click', $.proxy(this.cardBoxClose,this));
		$(window).on('scroll', $.proxy(this.scrollFunc,this));
	},
	unBindEvents : function(){
		this.btnSelect.off('click', $.proxy(this.cardBoxToggle,this));
		$('.sp_hd').off('click', $.proxy(this.cardBoxClose,this));
		$(window).off('scroll', $.proxy(this.scrollFunc,this));
	},
	scrollFunc : function(){
		this.nextScroll = $(window).scrollTop();
		if(this.nextScroll > this.currentScroll){
			this.selectListWrap.addClass('fixed').css('top',85);
		}else{
			this.selectListWrap.removeClass('fixed').css('top',0);
		}
		this.currentScroll = this.nextScroll;
	},
	overScroll : function(){
		this.iScrollId = this.targetParentId.find('.prd_selct_lst_wrap').attr('id');
		this.iScroll = new iScroll(this.iScrollId, {
			hScrollbar : false,
			vScrollbar : true,
			checkDOMChanges : true,
			momentum : true,
			desktopCompatibility: true
		});
	},
	cardBoxToggle : function(){
		this.selectListWrap.toggleClass('on');
		this.goodsDimmed.toggle();
		if(this.selectListWrap.hasClass('on')){
			bodyScrollFixed2.scrollStop();
		}else{
			bodyScrollFixed2.scrollPlay();
		}
		return false;
	}
};

// VIP inquire
var vipGoodsInquire = function(wrapId){
    if($('.goods .inquiry').length == 0) return;
    var btnInquire = wrapId.find('.box_notice > .btn_inquire');
    var btnCancel = wrapId.find('.btn_cancel');
    var slideBox = wrapId.find('.inquiry_inner');
    btnInquire.on('click',function(){
        slideBox.slideDown();
        $(this).css('top','59px');
    });
    btnCancel.on('click',function(){
        $(window).scrollTop(0);
        slideBox.slideUp();
        $(this).css('top','58px');
    });
};

var vipReviewSwiper = {
	init : function(wrapId){
		this.setElements(wrapId);
		this.swiperFunc();
	},
	setElements : function(wrapId){
		this.reviewListWrap = wrapId.find('.photo_rv');
		this.swiperWrap = wrapId.find('.swiper-container');
	},
	swiperFunc : function(){
		this.swiperWrap.each(function(){
			if($(this).find('.swiper-slide').length == 1){
                $(this).find('.swiper-pagination').remove();
			}else{
                var swiper = new Swiper($(this), {
                    pagination: '.swiper-pagination',
                    paginationType: 'fraction'
                });
			}
		});
        this.reviewListWrap.find('li:last-child').addClass('last_review');
	},
	reinit : function(wrapId){
		this.setElements(wrapId);
		this.reSwiperFunc();
	},
	reSwiperFunc : function(){
		var reivewListLength = this.reviewListWrap.find('>li').length;
        var lastIndex = this.reviewListWrap.find('.last_review').index();
        for(var i = lastIndex+1,max = reivewListLength;i < max; i++){
        	var targetSwiperWrap = this.reviewListWrap.find('li').eq(i).find('.swiper-container');
        	if(targetSwiperWrap.find('.swiper-slide').length == 1){
                targetSwiperWrap.find('.swiper-pagination').remove();
			}else{
                var swiper = new Swiper(targetSwiperWrap, {
                    pagination: '.swiper-pagination',
                    paginationType: 'fraction'
                });
			}
		}
        this.reviewListWrap.find('.last_review').removeClass('last_review');
        this.reviewListWrap.find('li:last-child').addClass('last_review');
	}
};

function vipOptionBottom(){
	if($('#vipOption').is(':visible')){
		$('#vipOption .button_wrap').on('touchmove mousewheel', function(e) {
			e.preventDefault();
		});
	}
}


// VIP Interest Product
function vipInterProd(obj){
	if(!obj.hasClass('on')){
		$('<div class="ly_inter"><embed src="//pics.gmarket.co.kr/mobile/single/kr/common/heart_toast.svg" type="image/svg+xml"></div>').appendTo('.goods');
		$('.goods .ly_inter').animate({opacity : 1}, 300).delay(1000).animate({opacity : 0}, 300, function(){
			$('.goods .ly_inter').remove();
		});
	} else {
		$('.goods .ly_inter').remove();
	}
}

// VIP Top Product
function goodsImgHeight(){
	var max = 0;

	$("#bnGrp").css("padding-bottom", "0");

	if($('#bnGrp img').length == 1){
	}else{
		$('#bnGrp span img').each(function(){
			var idxLst = $(this).parents('#swipeview-slider').find('>div').length;
			for ( i=0; i< idxLst; i++ ){
				var goodsImg = $(this).eq(i).height()
				if ( max < goodsImg){
					max = goodsImg
				}else{
					max = max
				}
			}
		});
		$('#bnGrp span img').height(max);
	}
	$(window).on("resize", function(){
		var wdW = $(window).width();
		var tgH;
		if(wdW <600){
			tgH = wdW
		}else{
			tgH = 600
		}
		$("#bnGrp").height(tgH);
		$('#bnGrp span img').height(tgH);
	});
}

// VIP Detail View layer
function vipDetailView(type_ck){
	var popBox = $('.detail_view_wrap .ly_notice');
	if(popBox.is(':visible')){
		if(type_ck == 'btn_cls'){
			popBox.hide();
			$('.detail_view_wrap').removeClass('on');
			$('#dvw_mask').remove();
			$('body').unbind('touchmove');
		}
	}else{
		popBox.show();
		$('.detail_view_wrap').addClass('on').append('<div id="dvw_mask" onclick="vipDetailView(\'btn_cls\')"></div>');
		$('body').bind('touchmove', function(e){e.preventDefault();});
	}
};

// SHOW/HIDDEN
function displayLayer(id, disp) {
	var obj = document.getElementById(id);
	if (obj) {
		obj.style.display = disp;
	}
}

function displayLayers(id, id2, disp) {
	var obj = document.getElementById(id);
	var obj2 = document.getElementById(id2);
	obj.style.display = disp;
	obj2.style.display = disp;
}

function displayLayer2(targetId, tabId, disp) {
	var target = $("#" + targetId);
	var tab = $("#" + tabId);
	var tabCnm = tab.attr("class");

	if(tabCnm.indexOf("on") >= 0){
		target.css("display", "none");
		tab.removeClass("on");
	}else{
		target.css("display", disp);
		tab.addClass("on");
	}
}

function displayLayer3(targetId, tabId, scrollId) {
    var MAX_LIST_SIZE;
    if( typeof optionModel !== "undefined" ){
        if (optionModel.getOptionSCombinationType() == null) {
            MAX_LIST_SIZE = 7;
        } else {
            MAX_LIST_SIZE = 5;
        }
    }

    var target = $("#" + targetId);
    var tab = $("#" + tabId);
    var tab_btn_dtl = $("#" + tabId + " > .btn_dtl");
    var scrId = $("#" + scrollId + " li"); //iscroll 내의 리스트 갯수

    if (!target.is(':visible')) {

        target.show()
        tab.addClass("on");
        tab_btn_dtl.addClass("on");
        if(scrollId !== undefined){ //받아오는 변수로 비교 (레이어 내에 iscroll이 존재할경우)
            if(scrId.size() > MAX_LIST_SIZE) { //리스트가 4개가 넘으면 iscroll 작동 (갯수변경가능)
                iFrameScroll(scrollId);
            }
        }

		// 배송예고제 열고닫기 사용되는 클래스 케이스
        // if (tabId && tabId != "add_comp" && tabId != "clr_mth_ship" && tabId != "pur_open" && tabId != "tel_open" && tabId != "etc_open" && tabId != "ship_open" && tabId != "smile_open" && tabId != "book_dtl_open" && tabId != "prod_info_open" && tabId != "safe_info_open" && tabId != "ecoupon_open" && tabId != "book_open") {
        //     var tab_offset = $("#" + tabId).offset();
        //     $(window).scrollTop(tab_offset.top - 49);
        // }

        if(tab.parents().hasClass('disct_wrap') || tab.parents().hasClass('gvip_wrap')){
        }else{
            if(tab.hasClass('add_comp')){

            }else{
                tab.parents('.sub_tit_grp').addClass('first').show();
                target.addClass('fixed');
            }
        }

    } else {
        tab.removeClass("on");
        tab_btn_dtl.removeClass("on");
        target.hide()

        if(tab.parents().hasClass('disct_wrap') || tab.parents().hasClass('gvip_wrap')){

        }else{
            if(tab.hasClass('add_comp')){

            }else{
                tab.parents('.sub_tit_grp').removeClass('first').show();
            }
        }
    }



}

function displayLayerComment(targetId, tabId, disp, scomid) {
	var target = $("#" + targetId);
	var sTarget = $("#" + scomid);
	var tab = $("#" + tabId);
	var tabCnm = tab.attr("class");

	if (tabCnm.indexOf("on") >= 0) {
		target.css("display", "none");
		sTarget.css("display", "none");
		tab.removeClass("on");
	} else {
		target.css("display", disp);
		sTarget.css("display", disp);
		tab.addClass("on");
	}
}

// TAB TOGGLE
function tabView(tabSize, tabId, idx, targetId) {
	for ( var i = 0; i < tabSize; i++ ) {
		if ( i == idx ) {
			$("#"+tabId+i)[0].className = $("#"+tabId+i)[0].className.replace("off", "on");
			if ( $("#"+targetId+i) ) {
				$("#"+targetId+i).show();
				//$(window).resize();
				$("#"+targetId+i).find(".bnGrp").each(function(){
					var _id = $(this).attr('id');
					var _prev = $(this).next().find('.btn_prev').attr('id');
					var _next =  $(this).next().find('.btn_next').attr('id');
					flicking(_id, _prev, _next);
				});
			}
		}else{
			$("#"+tabId+i)[0].className = $("#"+tabId+i)[0].className.replace("on", "off");
			if ( $("#"+targetId+i) ) {$("#"+targetId+i).hide();	}
		}
	}
}

function tabView2(tabSize, tabId, idx, targetId) {
	for ( var i = 0; i < tabSize; i++ ) {
		if ( i == idx ) {
			$("#"+tabId+i)[0].className = $("#"+tabId+i)[0].className.replace("off", "on");
			if ( $("#"+targetId+i) ) { $("#"+targetId+i).css("height", "100%"); }
		}else{
			$("#"+tabId+i)[0].className = $("#"+tabId+i)[0].className.replace("on", "off");
			if ( $("#"+targetId+i) ) {$("#"+targetId+i).css("height", "0")	}
		}
	}
}

function tabView5(tabSize, idx, targetId) { //140227 front.js에서 가져옴
	for ( var i = 0; i < tabSize; i++ ) {
		if ( i == idx ) {
			if ( $("#"+targetId+i) ) { $("#"+targetId+i).show(); }
		}else{
			if ( $("#"+targetId+i) ) {$("#"+targetId+i).hide();	}
		}
	}
}

// TAB TOGGLE
function tabView6(tabSize, tabId, idx, targetId) {
   for ( var i = 0; i < tabSize; i++ ) {
      if ( i == idx ) {
         $("#"+tabId+i)[0].className = $("#"+tabId+i)[0].className.replace("off", "on");
         if ( $("#"+targetId+i) ) { $("#"+targetId+i).css('visibility','visible'); }
      }else{
         $("#"+tabId+i)[0].className = $("#"+tabId+i)[0].className.replace("on", "off");
         if ( $("#"+targetId+i) ) {$("#"+targetId+i).css('visibility','hidden');}
      }
   }
}

// HEADER SEARCH BAR
// ipId : 입력창, delId : 삭제버튼, lyrId : 자동완성레이어, displayYN : Y=보여줌, N=감춤)
function hdScbKeyEvent(ipId, delId, lyrId, displayYN){
	var ipId = $("#" + ipId);
	var delId = $("#" + delId);
	var lyrId = $("#" + lyrId);

	if(0 < ipId.val().length){ // 입력창에 글자를 입력한 경우
		delId.css('display', "block");
		$('#search_button').css('display', "none");

		// '닫기'버튼을 선택시 자동완성 레이어만 감춤
		if("N" == displayYN){
			lyrId.css('display', "none");
		}else if("Y" == displayYN){
			lyrId.css('display', "block");
		}//end else if
	}else if(0 == ipId.val().length){ // 입력창에 글자가 없을 경우

		// 삭제버튼, 자동완성레이어 감춤
		delId.css('display', "none");
		lyrId.css('display', "none");
	}//end else if
}//end function


// HEADER CATEGORY
var nCtgyNum = -1;
var nSubNum = -1;
function showCategory(subNum, ctgyNum){

	var ctgrGrpLength = $("#hd .ctgr").length; //Category Count
	var ctgrSubLength = $("#hd .ctgr_sub").length;	//CategorySub Count

	for(var i=0;i<=ctgrGrpLength;i++){
		var ctgrGrp = $("#ctgr" + i);
		var ctgrGrpCnm = ctgrGrp.attr("class");

		if(i == ctgyNum){
			if(ctgrGrpCnm.indexOf("on") >= 0){
				if(nCtgyNum !== ctgyNum){
					ctgrGrp.removeClass("on");
				}
				if(nSubNum == subNum){
					ctgrGrp.removeClass("on");
				}
			}else{
				ctgrGrp.addClass("on");
			}
		}
		else{
			ctgrGrp.removeClass("on");
		}
	}
	nCtgyNum = ctgyNum;
	nSubNum = subNum;

	for(var i=0;i<=ctgrSubLength;i++){
		var ctgrSub = $("#ctgr_sub" + i);
		var ctgr = $(".ctgr" + (i+1));

		if(i == subNum && ctgrSub.css("display") != "block"){
			ctgr.addClass("on");
			ctgrSub.css("display", "block");
		}
		else{
			ctgr.removeClass("on");
			ctgrSub.css("display", "none");
		}
	}
}


// ROLLING(FOOTER NOTICE)
function rolling(rollGrp){
	setInterval(function(){
		var rollList = $("#" + rollGrp + " li");
		var nRollList = $(rollList[0]).clone();

		$(rollList[0]).remove();
		$("#" + rollGrp).append(nRollList);
	}, 3000);
}


// FLICKING MAIN
function flicking(bnGrp, prev, next){
	$(window).bind("load", function(){
		imgPos();
	});
	var userAgent = navigator.userAgent.toLowerCase();

	if(userAgent.search("iphone|ipod|ipad") > -1){
		$(window).bind("orientationchange", function(){
			imgPos();
		});
	}else{
		$(window).bind("resize", function(){
			imgPos();
		});
	}

	function imgPos(){ // RESIZE, LOAD 이미지의 넓이와 양쪽 화살표의 위치를 계산한다.
		var imgHeight = $("#" + bnGrp + " span img").css('height'); // 계산되어진 이미지의 높이값을 가져온다.
		var imgHeightNum = parseInt(imgHeight);
		var btnHeightHalfSize = parseInt($("#" + prev).css('height')); // 좌우 플리킹 버튼의 높이의 반.

		$("#" + bnGrp).css('height', imgHeight); // 가져온 높이값을 이미지를 감싸고 있는 곳(div id="bnWrap")에 넣어준다.
		$("#" + prev).css('height', imgHeight);
		$("#" + next).css('height', imgHeight);
		$("#" + prev).css('top', -imgHeightNum + "px"); // 좌우 플리킹 버튼의 TOP위치, 이미지의 높이의 중간에서 버튼높이사이즈의 반을 빼준값을 넣어준다.
		$("#" + next).css('top', -imgHeightNum + "px"); // 좌우 플리킹 버튼의 TOP위치, 이미지의 높이의 중간에서 버튼높이사이즈의 반을 빼준값을 넣어준다.

	}

	$("#" + bnGrp + " > ul").not(".bn_sub4").remove(); // 기존 데이터 삭제, MAIN(반응형웹을 위한 소스부분빼고 모두 제거(메인, 서브))
	$("#" + bnGrp + " > ol").remove(); // 기존 데이터 삭제

	setTimeout(function() { //20130424 수정
		$("#" + bnGrp + " > .temp").remove(); // 기존 데이터 삭제
	}, 1500);

	//ios7에서 높이값 잡지 못하는 버그
	function setSpHeight(){
		var bnGrpHeight = $('#'+bnGrp).css('height');
		$(instance.slider).children().height(bnGrpHeight);
	}
}

// FLICKING SUB
function flicking2(bnGrp){
	$("#" + bnGrp + " > ul").remove(); // 기존 데이터 삭제
	$("#" + bnGrp + " > ol").remove(); // 기존 데이터 삭제
}

// 반응형웹
function responseWeb() {
    var windowWidth = $(window).width(); //기기 가로사이즈
    var bnSub4 = $(".bn_sub4"); //기존 모바일 기획전 소스
    var bnGrp4Div = $("#bnGrp4 > div"); //플리킹 모바일 기획전 소스
    var bnSub3 = $("#bnGrp3 .bn_sub3"); //기존 G마켓 베스트 소스
    var bnGrp3Div = $("#bnGrp3 > div"); //플리킹 G마켓 베스트 소스
    var userAgent = navigator.userAgent; //갤럭시s3만 분기처리하기위해

    if (514 < windowWidth) { //기준픽셀보다 기기의 가로사이즈가 크면
        $("#bnGrp3 > div").remove(); //플리킹 G마켓 베스트 소스 제거
        $("#bnGrp3").append(bnSub3); //기존 G마켓 베스트 소스 추가
        $("#bnGrp4 > div").remove(); //플리킹 모바일 기획전 소스 제거
        $("#bnGrp4").append(bnSub4); //기존 모바일 기획전 소스 추가
    } else { //기준픽셀보다 기기의 가로사이즈가 작으면
        $(".bn_sub3").remove(); //기존 G마켓 베스트 소스 제거
        $("#bnGrp3").append(bnGrp3Div); //플리킹 G마켓 베스트 소스 추가
        $(".bn_sub4").remove(); //기존 모바일 기획전 소스 제거
        $("#bnGrp4").append(bnGrp4Div); //플리킹 모바일 기획전 소스 추가
    }

    $(window).bind("resize", function () {
        //리사이즈될때도 위와 같은 방식으로 한다.
        var windowWidth = $(window).width(); //기기 가로사이즈

        if (514 < windowWidth) {
            $("#bnGrp3 > div").remove();
            $("#bnGrp3").append(bnSub3);
            $("#bnGrp4 > div").remove();
            $("#bnGrp4").append(bnSub4);
        } else {
            $(".bn_sub3").remove();
            $("#bnGrp3").append(bnGrp3Div);
            $(".bn_sub4").remove();
            $("#bnGrp4").append(bnGrp4Div);
        }

        //갤럭시s3만 따로 처리
        /*
        if (userAgent.indexOf("SHV-E210") > -1 || userAgent.indexOf("SHW-M440") > -1) {
        $(window).bind('orientationchange', function(e){
        if (window.orientation == 90 || window.orientation == -90 || window.orientation == 270) {
        $(window).width() = 801;
        }
        else if(window.orientation == 0){
        $(window).width() = 480;
        }
        }).trigger('orientationchange');
        }*/
    });
}


// 기존 스크립트 기획전_상품가로정렬
function UL_layoutFix(el, isNewLine, addMargine){
	var obj = $(el).find("li");
	var win_w,obj_w,n,x, nmg;
	var tempWidth = 0;
	function init(){
		obj = $(el).find("li");

		win_w = $(window).width();

		//if (tempWidth == win_w) return;
		tempWidth = win_w;

		obj_w = $(obj).outerWidth();
		n = Math.floor(win_w / obj_w); //라인당 li 갯수

		//개행되는 목록과 개행되지 않는 목록을 분기
		if (isNewLine){
			x = win_w % obj_w; //남는 영역
			x = (x/n)/2;
			obj.css({marginLeft:x,marginRight:x});

		}
		else {
			win_w = win_w - 30; //화면너비 - 좌우기본마진(15px/15px)

			//기본 마진 외에 추가로 공간이 발생하는 경우 보정해 주어야 한다.
			if (addMargine != undefined) {
				win_w = win_w - addMargine;
			}

			n = Math.floor(win_w / obj_w); //라인당 li 갯수
			nmg = win_w - (obj_w * n);
			x = (n > 1) ? (nmg /(n - 1)) : nmg;
			obj.css({marginLeft:0,marginRight:x});
		}
	}

	if (typeof orientationchange != "undefined"){
		$(window).bind("orientationchange", function(){
			init();
		});
	}
	else{
		$(window).bind("resize",function(){
			init();
		});
	}
	init();
}

// 장바구니 담기완료
function hplusCartEnd(popId){
	var popUp = document.getElementById(popId);
	var btnBox = document.getElementsByTagName("button");
	var scrnHeight = window.innerHeight; // 화면 높이
	var pageY = window.pageYOffset; // 스크롤 위치
	var popHeight = parseInt($('#'+popId).css('height')); // 팝업 높이
	var popHeightHalf = popHeight/2; // 팝업 높이의 반
	var layerPos = (scrnHeight/2) - popHeight + pageY; //
	var layerPos2 = pageY; //
	$('#hplus_cart').css('display','none');
	$('#mask').remove();
	$('#'+popId).css({'top' : layerPos + 'px', 'opacity' : '0'});
	$('#'+popId).css('display' , 'block').animate({opacity:'1'},500).delay(1000).fadeOut(800);
	// button
	if(btnBox){
		for(var i=0; i<btnBox.length; i++){
			btnBox[i].disabled = false;
		}
	}
}

// BlockUI_레이어외의 다른곳은 클릭되지 않는다. (클릭수 레이어가 뜰경우)
function popBlockUI(popId) {

	var popUp = document.getElementById(popId);
	var aTag = document.getElementsByTagName("a");
	var inputBox = document.getElementsByTagName("input");
	var textBox = document.getElementsByTagName("textarea");
	var selBox = document.getElementsByTagName("select");
	var btnBox = document.getElementsByTagName("button");
	var popIdDis = $('#'+popId).css('display');

	if(popIdDis == 'none'){
		$('#'+popId).css("display", 'block');
		var scrnHeight = window.innerHeight; // 화면 높이
		var pageY = window.pageYOffset; // 스크롤 위치
		var popHeight = parseInt($('#'+popId).css('height')); // 팝업 높이
		var popHeightHalf = popHeight/2; // 팝업 높이의 반

		var layerPos = (scrnHeight/2) - popHeight + pageY;
		var layerPos2 = pageY; //

		if($('#'+popId).hasClass('bef2')){
			$('#'+popId).css("top", layerPos2 + 'px');
		}else if($('#'+popId).hasClass('ly_benefit')){
			$('#'+popId).css("top", layerPos2 + 'px');
		}else if($('#'+popId).hasClass('bef3')){
			$('#'+popId).css("top", layerPos2 + 'px');
		}
		else{
			$('#'+popId).css("top", layerPos + 'px');
		}
		if($('#mask').length == 0){
			if($('.ly_smile_box').is(':visible')){
				$("<div id='mask' selected='true' style='z-index:310'></div>").appendTo("#wrap");
			}else{
				$("<div id='mask' selected='true'></div>").appendTo("#wrap");
			}
		}else{
			$('#mask').show();
		}
	}
	else{
		$('#'+popId).css("display", 'none');
		$('#mask').remove();
	}

	// aTag
	if(!$(aTag).parents('#footer_bar_menu')){
		for(var i=0; i<aTag.length; i++){
			if(popUp.style.display == 'block'){aTag[i].className +=  (aTag[i].className ? ' ' : '') + "noBorder";}
			else{aTag[i].className = aTag[i].className.replace("noBorder", "");}
		}
	}

	// inputBox
	if(!$(inputBox).parents('#footer_bar_menu')){
		if(inputBox){
			for(var i=0; i<inputBox.length; i++){
				if(popUp.style.display == 'block'){
					inputBox[i].disabled = true;
					$('#'+popId + ' input').prop("disabled",false);
				}
				else{inputBox[i].disabled = false;}
			}
		}
	}
	// textarea
	if($('.ly_photo_detail').length < 1){
		if(textBox){
			for(var i=0; i<textBox.length; i++){
				if(popUp.style.display == 'block'){textBox[i].disabled = true;}
				else{textBox[i].disabled = false;}
			}
		}
	}

	// select
	if(selBox){
		for(var i=0; i<selBox.length; i++){
			if(popUp.style.display == 'block'){selBox[i].disabled = true;}
			else{selBox[i].disabled = false;}
		}
	}
	// button
	if(!$(btnBox).parents('#footer_bar_menu')){
		if(btnBox){
			for(var i=0; i<btnBox.length; i++){
				if(popUp.style.display == 'block' && !$(btnBox[i]).hasClass("click_a")){btnBox.disabled = true;}
				else{btnBox[i].disabled = false;}
			}
		}
	}
}

// BlockUI_레이어외의 다른곳은 클릭되지 않는다. (레이어가 떠있을경우)
function popBlockUI2(popId) {

	var popUp = document.getElementById(popId);
	var aTag = document.getElementsByTagName("a");
	var aTag2 = popUp.getElementsByTagName("a");
	var inputBox = document.getElementsByTagName("input");
	var textBox = document.getElementsByTagName("textarea");
	var selBox = document.getElementsByTagName("select");
	var btnBox = document.getElementsByTagName("button");

	// aTag
	for(var i=0; i<aTag.length; i++){
		aTag[i].className +=  (aTag[i].className ? ' ' : '') + "noBorder";
	}
	// inputBox
//	for(var i=0; i<inputBox.length; i++){
//		inputBox[i].disabled = true;
//	}
	// textarea
	for(var i=0; i<textBox.length; i++){
		textBox[i].disabled = true;
	}
	// select
	for(var i=0; i<selBox.length; i++){
		selBox[i].disabled = true;
	}
	// button
	for(var i=0; i<btnBox.length; i++){
		btnBox[i].disabled = true;
	}


	for(var i=0; i<aTag2.length; i++){
		aTag2[i].className = aTag2[i].className.replace("noBorder", "");
	}
}

function popBlockUI3(popId) {
	var popUp = document.getElementById(popId);
	var popIdDis = $('#'+popId).css('display');

	if(popIdDis == 'none'){
		$('#'+popId).css("display", 'block');
		var scrnHeight = window.innerHeight; // 화면 높이
		var pageY = window.pageYOffset; // 스크롤 위치
		var popHeight = parseInt($('#'+popId).css('height')); // 팝업 높이
		var popHeightHalf = popHeight/2; // 팝업 높이의 반
		var layerPos = (scrnHeight/2) - popHeight + pageY; //
		//var layerPos = (scrnHeight-popHeight)/2 + pageY + 40;
		var layerPos2 = pageY;

		//풀레이어 페이지 인 경우 scroll hidden
		if($('#'+popId).outerHeight() == $(window).outerHeight()) {
			$('html').addClass("box__hidden");
		}

		if(popId == 'ly_mart_smenu'){
			$("<div id='mask' selected='true' style='z-index:310'></div>").appendTo("#wrap");
		}else{
			$("<div id='mask' selected='true'></div>").appendTo("#wrap");
		}

	}
	else{
		$('#'+popId).css("display", 'none');
		$('#mask').remove();
		$('html').removeClass("box__hidden");
	}
}

// 이미지 Rolling
function ImageRotation() {
    var scroll = {time:1, start:0, change:0, duration:25, timer:null};
    var originaltime = scroll.time;
    var objWidth = 0;
    var currentNum = 0;
    var tmpName, tmpWrap, tmpListId, tmpNext, tmpPrev, tmpNum, tmpTime, moveEvent, restNum, objNum, nowNum, totNum, cntTmp, nowTmp, totTmp, cntNum, tmpTit, tmpDir, tmpPage, cntRoll, tmpMg;
    this.GoodsSetTime = null;
    var cloneElement = [];

    this.setScrollType = function (obj) {}


	this.initialize = function () {
        tmpNum = this.listNum;
        tmpTime = this.GoodsSetTime;
        tmpDir = this.scrollDirection;
        tmpMg = this.mg;
        tmpWrap = document.getElementById(this.wrapId);
        tmpListId = document.getElementById(this.listId);
        tmpNext = document.getElementById(this.btnNext);
        tmpPrev = document.getElementById(this.btnPrev);
        nowNum = document.getElementById(this.nowCnt);
        totNum = document.getElementById(this.totCnt);
        //tmpTit = document.getElementById(this.titName);
        tmpPage = document.getElementById(this.cntPage);
        cntRoll = this.sRoll;


        objNum = tmpListId.getElementsByTagName('li').length;
        cntNum = tmpNum;

		liWidth = tmpListId.getElementsByTagName('li')[0].offsetWidth + tmpMg; // + parseInt(li.style.marginLeft) + parseInt(li.style.marginRight);

	//	if (liWidth == 0){liWidth = tmpWdth;}

        tmpListId.style.width = (objNum * liWidth) + 'px';

		objWidth = liWidth * tmpNum;

        tmpListId.style.overflow = 'hidden';
        tmpWrap.style.overflow = 'hidden';

        tmpNext.onclick = setPrev;
        tmpPrev.onclick = setNext;

        if (this.autoScroll == 'none') {
                // do nothing.
        } else {
            clearInterval(tmpTime);
            /* 0525
            if(tmpDir == 'direction'){moveEvent = 'setPrev';}
            else{moveEvent = 'setNext';}
            tmpTime = setInterval(function () { eval(moveEvent + '();'); }, this.scrollGap);
			*/
			this.startTimer();
        }

        // count
        if(totNum){totNum.innerHTML= objNum/tmpNum;}

        //img name
        //if(tmpTit){tmpTit.innerHTML = tmpListId.getElementsByTagName("img")[0].alt;}

        // PAGES
        if(tmpPage){setPages(1);}

    }

    var setPages = function (pNum) {
        var pBtn;

        totNum = parseInt(objNum/tmpNum);


        if(totNum){
            for (var i=1; i<totNum+1; i++){
                if(pBtn == undefined){pBtn = "";}
                if(i == pNum){pBtn += "<strong  id='"+cntRoll+"_sBtn"+i+"' class='on'></strong>";}
                else{pBtn += "<strong id='"+cntRoll+"_sBtn"+i+"' class='off'></strong>";}
            }
            tmpPage.innerHTML = pBtn;
        }
        nowNum = pNum;
    }


    var setNext = function () {
        if (objNum <= tmpNum) return false;
        // count
        cntNum = cntNum - tmpNum;
        if(cntNum < 1){cntNum = objNum;}
        if(nowNum){nowNum.innerHTML = parseInt(cntNum/tmpNum);}

        // PAGES
        if(tmpPage){setPages(parseInt(cntNum/tmpNum));}

        //moveEvent = 'setNext';
        for (var i=0; i<tmpNum; i++) {
            var objLastNode = tmpListId.removeChild(tmpListId.getElementsByTagName('li')[objNum - 1]);
            tmpListId.insertBefore(objLastNode, tmpListId.getElementsByTagName('li')[0]);

            //img name
            //if(tmpTit){tmpTit.innerHTML = tmpListId.getElementsByTagName("img")[tmpNum-1].alt;}
        }

        tmpWrap.scrollLeft = objWidth;
        var position = getActionPoint('indirect');

        startScroll(position.start, position.end, 'next');
        return false;
    }

    var setPrev = function () {
        if (objNum <= tmpNum) return false;
        // count
        cntNum = cntNum + tmpNum;
        if(objNum < cntNum){cntNum = tmpNum;}
        if(nowNum){nowNum.innerHTML = parseInt(cntNum/tmpNum);}

        // PAGES
        if(tmpPage){setPages(parseInt(cntNum/tmpNum));}

        //moveEvent = 'setPrev';
        var position = getActionPoint('direct');
        startScroll(position.start, position.end, 'prev');
        return false;
    }

    var startScroll = function (start, end, location) {
        if (scroll.timer != null) {
            clearInterval(scroll.timer);
            scroll.timer = null;
        }

        scroll.start = start;
        scroll.change = end - start;
        scroll.timer = setInterval(function () {
            scrollHorizontal(location);
        }, 15);
    }

    var scrollHorizontal = function (location) {
        if (scroll.time > scroll.duration) {
            clearInterval(scroll.timer);
            scroll.time = originaltime;
            scroll.timer = null;
            if (location == 'prev') {
                for (var i=0; i<tmpNum; i++) {
                    var objFirstNode = tmpListId.removeChild(tmpListId.getElementsByTagName('li')[0]);
                    tmpListId.appendChild(objFirstNode);
                    //img name
                    //if(tmpTit){tmpTit.innerHTML = tmpListId.getElementsByTagName("img")[tmpNum-1].alt;}
                }

            }
            tmpWrap.scrollLeft = 0;
        } else {
            tmpWrap.scrollLeft = sineInOut(scroll.time, scroll.start, scroll.change, scroll.duration);
            scroll.time++;
        }
    }

    var getActionPoint = function (dir) {
        var end;

        if (dir == 'direct') end = tmpWrap.scrollLeft + objWidth;
        else end = tmpWrap.scrollLeft - objWidth;

        var start = tmpWrap.scrollLeft;

        var position = {start:0, end:0};
        position.start = start;
        position.end = end;

        return position;
    }

    var sineInOut = function (t, b, c, d) { return -c/2 * (Math.cos(Math.PI*t/d) - 1) + b; }

    var findElementPos = function (elemFind) {
        var elemX = 0;
        elemX = tmpWidth*(elemFind/tmpNum);
        return elemX;
 }

	this.stopTimer=function(){
		if(tmpTime!=0)
		{
			clearInterval(tmpTime);
			tmpTime=0;
		}
	}

	this.startTimer=function(){
			if(tmpTime==0 || tmpTime==null)
			{
       		     tmpTime = setInterval(function () { setPrev() }, this.scrollGap);
			}
      }

}

//Plus & Minus & Delete
function setPlus2(sid) {
	if ($("#" + sid).closest("div .nec_comp_conf").find(".cpn").val() == 1) {
		alert('할인쿠폰을 적용한 후에 [주문수량]을 변경하실 수 없습니다. 주문수량을 변경하시려면, "취소" 를 눌러 쿠폰적용을 해제해 주십시요.');
		return false;
	}
    var value = $("#"+sid).val();
    value++;
    if(value > 999){return false;}
    $("#"+sid).val(value);
    $("#" + sid).trigger("keyup");
}
function setMinus2(sid) {
	if ($("#" + sid).closest("div .nec_comp_conf").find(".cpn").val() == 1) {
		alert('할인쿠폰을 적용한 후에 [주문수량]을 변경하실 수 없습니다. 주문수량을 변경하시려면, "취소" 를 눌러 쿠폰적용을 해제해 주십시요.');
		return false;
	}
    var value = $("#"+sid).val();
    value--;
    if(value < 1){return false;}
    $("#"+sid).val(value);
    $("#" + sid).trigger("keyup");
}
function deleteTag2(listId){
	var obj = document.getElementById(listId);
	$(obj).remove();
}

function deleteTag3(object){
	var listId = object.listId;
	var index = object.index;
	var obj = document.getElementById(listId);

	$("#nec_comp" + index).parent().remove();
	$(obj).remove();
}

//쿠폰함관련
function LayerToggle(lyrId,a,type){//레이어 ID

	var stat = $("#"+lyrId).css('display');		//레이어 상태
	var scn_ht = $(window).height();			//화면 높이

	var lyr_ht = $("#"+lyrId).height();			//레이어 높이
	var scrollTop = $(window).scrollTop();		//스크롤 위치
	var sumTop = scn_ht + lyr_ht + scrollTop;

	var lyr_pos = scrollTop;					//레이어 위치 변수

	if(scn_ht > lyr_ht){lyr_pos = parseInt((scn_ht-lyr_ht)/2) + scrollTop + 40} //모바일 주소창(40px)

	if (stat == 'none'){
		if(type == undefined){
			$("#"+lyrId).css('top', sumTop);		//최초레이어 위치
			$("#"+lyrId).show().animate({top: lyr_pos}, 500).css('z-index',100);
		}else{
			var scn_wd = $(window).width();		//화면 넓이
			var defLeft = parseInt($("#"+lyrId).css("left"));

			defLeft = defLeft;

			$("#"+lyrId).css({top: lyr_pos,left: (defLeft+scn_wd)+"px"});		//최초레이어 위치
			$("#"+lyrId).show()
				        .animate({left: defLeft+"px"}, 500, null, function(){
							//[2012-06-12] 쿠폰함의 SELECT 선택이 잘 안되는 현상 처리
							if (lyrId == "ctCpn") {
								var objFocus = document.getElementById('selector_coupon2');
								if (objFocus != undefined) {
									objFocus.focus();
								}
							}
			            }).css('z-index',100);
		}

		// BLOCK UI
		//$.blockUI({message:$('#layerCpn')});
		$("<div id='mask' selected='true'></div>").appendTo("body");
		resizeMaskLayer(40);
	}else{


		if(type == undefined){

			// BLOCK UI
			$('#mask').remove();

			$("#"+lyrId).css('top',lyr_pos).animate({top: sumTop}, 500).fadeOut(100);
		}
		else {

			var scn_wd = $(window).width();		//화면 넓이
			var defLeft = parseInt($("#"+lyrId).css("left"));

			//defLeft = defLeft;	//[2012-06-11] 팝업 좌측 여백 처리(너비의 10%)

			$("#"+lyrId)
				.css('top',lyr_pos)
				.animate({left: defLeft + "px"}, 300)
				.fadeOut({
					dutation : "fast",
					complete : function(){
						$(this).css({left: defLeft + "px"});
					}
				});

			// BLOCK UI
			//$.unblockUI();//블록UI제거
			$('#mask').remove();
		}
	}
}

//팝업2(아래에서위로) : LyrToggle 레이어 위에 중첩레이어를 올림
function LayerToggle2(lyrId){//레이어 ID

	var stat = $("#"+lyrId).css('display');		//레이어 상태
	var scn_ht = $(window).height();			//화면 높이

	var lyr_ht = $("#"+lyrId).height();			//레이어 높이
	var scrollTop = $(window).scrollTop();		//스크롤 위치
	var sumTop = scn_ht + lyr_ht + scrollTop;

	var lyr_pos = scrollTop;					//레이어 위치 변수

	if(scn_ht > lyr_ht){lyr_pos = parseInt((scn_ht-lyr_ht)/2) + scrollTop + 40} //모바일 주소창(40px)

	if (stat == 'none'){
		// BLOCK UI
		$("<div id='mask2' selected='true'></div>").appendTo("body");
		$('#mask2').css({
			width:"100%",
			height:$(document).height(),
			position:'absolute',
			left:0,
			top:0,
			background:'#000',
			opacity:0.5,
			'z-index':140
		});

		$("#"+lyrId).css('top', sumTop);		//최초레이어 위치
		$("#"+lyrId).show().animate({top: lyr_pos}, 500).css('z-index',200);

	}else{
		// BLOCK UI
		$('#mask2').remove();
		$("#"+lyrId).css('top',lyr_pos).animate({top: sumTop}, 500).fadeOut(100);
	}
}

function resizeMaskLayer(zIndexNum) {
	$('#mask').css({
				width:"100%",
				height:$(document).height(),
				position:'absolute',
				left:0,
				top:0,
				background:'#000',
				opacity:0.5,
				'z-index':zIndexNum	//[2012.06.25] 카테고리 상세검색 레이어를 덮는 문제가 있어 z-index 값을 40->10으로 변경
			});
}

function LayerToggle2AndRefreshScroll(layerId, scrollId) {
	LayerToggle2(layerId);
	iFrameScroll(scrollId);
}

var standAlonescrollGB1 = "";
var standAlonescrollGB2 = "";
var standAlonescrollGB3 = "";
var standAlonescrollGB4 = "";
var standAlonescrollGB5 = "";
var standAlonescrollGB6 = "";
var myScroll = {};

function iFrameScroll(sId) {
	if ( sId == "fixed_scr1" ) {
		if ( standAlonescrollGB1 == "" ) {
			standAlonescrollGB1 = new iScroll(sId, { desktopCompatibility: true });
			standAlonescrollGB1.refresh();
		} else {
			standAlonescrollGB1.refresh();
		}
	} else if ( sId == "fixed_scr2" ) {
		if ( standAlonescrollGB2 == "" ) {
			standAlonescrollGB2 = new iScroll(sId, { desktopCompatibility: true });
			standAlonescrollGB2.refresh();
		} else {
			standAlonescrollGB2.refresh();
		}
	} else if ( sId == "fixed_scr3" ) {
		if ( standAlonescrollGB3 == "" ) {
			standAlonescrollGB3 = new iScroll(sId, { desktopCompatibility: true });
			standAlonescrollGB3.refresh();
		} else {
			standAlonescrollGB3.refresh();
		}
	} else if ( sId == "fixed_scr4" ) {
		if ( standAlonescrollGB4 == "" ) {
			standAlonescrollGB4 = new iScroll(sId, { desktopCompatibility: true });
			standAlonescrollGB4.refresh();
		} else {
			standAlonescrollGB4.refresh();
		}
	} else if ( sId == "fixed_scr5" ) {
		if ( standAlonescrollGB5 == "" ) {
			standAlonescrollGB5 = new iScroll(sId, { desktopCompatibility: true });
			standAlonescrollGB5.refresh();
		} else {
			standAlonescrollGB5.refresh();
		}
	} else if ( sId == "fixed_scr6" ) {
		if ( standAlonescrollGB5 == "" ) {
			standAlonescrollGB6 = new iScroll(sId, { desktopCompatibility: true });
			standAlonescrollGB6.refresh();
		} else {
			standAlonescrollGB6.refresh();
		}
	}else if ( sId == "fixed_scroll_addr3" ) {
		if (myScroll[sId] == undefined) {
			var height = $(window).height();
			if($("#header_wrapper").length > 0) height = height - $("#header_wrapper").outerHeight();
			if($(".addr_tab_new").length > 0) height = height - $(".addr_tab_new").outerHeight();
			if($("#fixed_btn").length > 0) height = height - $("#fixed_btn").outerHeight();
			if($(".ft_box").length > 0) height = height - $(".ft_box").outerHeight();
			$("#fixed_scroll_addr3").css("height", height + 20 + "px");
			myScroll[sId] = new iScroll(sId, {
				desktopCompatibility: true,
					click:true,
					tap:true,
				onBeforeScrollStart : function(e){
					var target = e.target;
					if(target.tagName.toLowerCase() != "input" && target.tagName.toLowerCase() != "label") {
						e.preventDefault();
						e.stopPropagation();
					}
				}
			});
			myScroll[sId].refresh();
		}
	}else if ( sId == "fixed_scroll_addr4" ) {
		var height = $(window).height();
		if($("#header_wrapper").length > 0) height = height - $("#header_wrapper").outerHeight();
		if($(".addr_tab_new").length > 0) height = height - $(".addr_tab_new").outerHeight();
//		if($("#fixed_btn2").length > 0) height = height - $("#fixed_btn2").outerHeight();
		if($("#fixed_btn2").length > 0) height = height - 59;
		if($("div.adr_find").length > 0) height = height - 97;
		$("#fixed_scroll_addr4").css("height", height + "px");
		$(sId).parents(".ser_zip").show();
		if (myScroll[sId] == undefined) {
			myScroll[sId] = new iScroll(sId, {
				desktopCompatibility: true,
				onBeforeScrollStart : function(e){
					var target = e.target;
					if(target.tagName.toLowerCase() != "input" && target.tagName.toLowerCase() != "label") {
						e.preventDefault();
						e.stopPropagation();
					}
				}
			});
		}
		setTimeout(function(){ myScroll[sId].refresh(); },1);
	}else if ( sId == "fixed_scroll_addr2" ) {
		$(sId).parents(".ser_zip").show();
		if (myScroll[sId] == undefined) myScroll[sId] = new iScroll(sId, { desktopCompatibility: true });
		setTimeout(function(){ myScroll[sId].refresh(); },1);
	}else {
		if (myScroll[sId] == undefined) myScroll[sId] = new iScroll(sId, {
			desktopCompatibility: true,
			onBeforeScrollStart : function(e){e.preventDefault(),e.stopPropagation()}
		});
		myScroll[sId].refresh();
	}
}

function deviceHeight(){
	var dHeight = $(window).height();
	var sHeight = dHeight - 150;
	$("#scroller").height(sHeight);
}

function iframeResize(ifrm,ifrmCont) {
	var iframeHeight = ifrm.contents().find('body').height();
	if(typeof ifrmCont[0] !== undefined){
		iframeHeight = ifrm.contents().find(ifrmCont).height();
	}
    ifrm.height(iframeHeight);
}

$(document).ready(function() {

	// vip_btn_top
	if($(".goods .btn_top").size() > 0){
		$(".goods .btn_top").click(function(e){
			e.preventDefault();
			if($('.minivip_layer_content').length){
                $('.minivip_layer_content').scrollTop(0);
			}else{
				$(window).scrollTop(0);
            }
		});
	}

	// search scroll
	$('#header_search_layer #scb_ip').click(function(e){
		e.preventDefault();
		$(window).scrollTop(0);
	});

	// ly_package
	$('#ly_order_package .btn_close,#ly_order_package .btn_cancel').click(function(){
		$('#mask,#ly_order_package').hide();
		$('.ly_op_wrap').hide();
	});
	$('#ly_order_package .selec_box select').change(function(){
		if($(this).children('option:selected').index() == $(this).children('option').index()){
			$(this).parent().hide();
			$(this).parent().next().show();
		}
	});

	// LOOK 리뉴얼
	$('.look_renewal .look_tab a').click(function(e){
		e.preventDefault();
		if(!$(this).hasClass('on')){
			$('.look_renewal .look_tab a').removeClass('on');
			$(this).addClass('on');
		};
	});
	$('.look_renewal .look_cate a').click(function(e){
		e.preventDefault();
		if(!$(this).hasClass('on')){
			$('.look_renewal .look_cate a').removeClass('on');
			$(this).addClass('on');
		};
	});
	if($('.ly_data_alert').size() > 0){
		var ly_pop = $('.ly_data_alert');
		ly_pop.find('.btn_ok').click(function(){
			ly_pop.fadeOut(500);
		});
		setTimeout(function(){ly_pop.fadeOut(500);},3000);
	}

	if($('.goods .prod_img #bnGrp').size() > 0){
		goodsImgHeight();
	}
	// 로그인
 	var telW = $('.login_tab').width();
 	$('.at_log .lst_tel').css('width',telW-200);
 	$(window).resize(function(){
 		var telW = $('.login_tab').width();
 		$('.at_log .lst_tel').css('width',telW-200);
 	});
 	if(typeof $('.at_log')[0] !== "undefined"){
		$('html').addClass('login_wrapper');
 		$('.lgb.mem').css('display','block')
 		$('.login_wrapper .login_tab a').bind('click',function(){
 			var idchked = $(this).attr('href');
 			$('.login_wrapper .at_log, .login_wrapper .lgb').hide();
 			$('.login_wrapper .login_tab a').removeClass('on');
 			$(this).addClass('on');
 			if(idchked == '#mem'){
 				$('.login_wrapper .at_log.mem').show();
 				$('.login_wrapper .lgb.mem').show();
				history.replaceState(null, null, "#mem");
 			}else{
 				$('.login_wrapper .at_log.nm').show();
 				$('.login_wrapper .lgb.nm').show();
				history.replaceState(null, null, "#nm");
 			}
 		});
 		if (location.hash) {
 			var lglink = document.location.href;
 			var lgtab = lglink.split('#').pop();
 			$('.login_wrapper .login_tab a[href$='+lgtab+']').trigger("click");
 		}
 	}

 	$('.at_log .inp_tel .clear').click(function(){
 		$(this).hide().next().focus();
 	});
 	$('.at_log .inp_tel input').each(function(){
 		var txtval = $(this).val();
 		$(this).focusin(function(){
 			if($(this).val() == txtval){
				$('.at_log .inp_tel .clear').hide()
			}
			$(this).parents('.inp_tel').addClass('focuson');
 		});
 		$(this).focusout(function(){
 			if($('.at_log .inp_tel input.fst_tel').val() == "" && $('.at_log .inp_tel input.mid_tel').val() == "" && $('.at_log .inp_tel input.lst_tel').val() == ""){
 				$('.at_log .inp_tel .clear').show()
 			}
			$(this).parents('.inp_tel').removeClass('focuson');
 		});
 	});
 	$('.login .keyboard button.off').click(function(){
 		$(this).hide();
 		$('.login .keyboard button.on').show();
 		$(this).parent().find('.key').show();
 	});
 	$('.login .keyboard button.on').click(function(){
 		$(this).hide();
 		$('.login .keyboard button.off').show();
 		$(this).parent().find('.key').hide();
 	});
 	$('.login .ico_app_txt').click(function(){
 		$(this).addClass('on');
 		$('.login .app_txt').show()
 	});
 	$('.login .app_txt .close').click(function(){
 		$('.login .ico_app_txt').removeClass('on');
 		$(this).parents('.app_txt').hide()
 	});

	//비회원 배달주문표 약관동의
 	$('.del_cont .agree_lst .all input').bind('click' , function(){
 		var chk = $(this).is(':checked');
 		if(chk) $('.del_cont .agree_lst input').prop('checked' , true);
 		else $('.del_cont .agree_lst input').prop('checked' , false);
 	});
 	$('.del_cont .use_info .agree_detail').css('display' , 'block');
 	$('.del_cont .agree_lst .btn_detail').bind('click' , function(){
 		if(!$(this).hasClass('selected')){
 			$(this).addClass('selected');
 			if(!$(this).hasClass('btn_opener')){
 				$(this).text('닫기');
 			}
 			else{
 				$(this).text('상세닫기');
 			}
 			$(this).siblings('.agree_detail').css('display' , 'block');
 			$(this).siblings('.del_cont .use_info .agree_detail').addClass('view');
 		}
 		else{
 			$(this).removeClass('selected');
 			if(!$(this).hasClass('btn_opener')){
 				$(this).text('자세히');
 			}
 			else{
 				$(this).text('상세보기');
 			}
 			$(this).siblings('.agree_detail').css('display' , 'none');
 			$(this).siblings('.del_cont .use_info .agree_detail').removeClass('view').css('display' , 'block');
 		}
 		return false;
 	});

	//연관 faq 보기
	$('.faq_lst .ct').css('display' , 'none');
	$('.faq_lst .qa').bind('click', function(){
		if(!$(this).parent('li').hasClass('selected')){
			$(this).parent('li').addClass('selected');
			$(this).next('.faq_lst .ct').css('display' , 'block');
		}
		else{
			$(this).parent('li').removeClass('selected');
			$(this).next('.faq_lst .ct').css('display' , 'none');
		}
		return false;
	});

	//스마트배송 보기
	$('.smart_delbx .smart_lst').css('display' , 'none');
	$('.smart_delbx .smart_txt').bind('click' , function(){
		if(!$(this).parent('.smart_delbx').hasClass('selected')){
			$(this).parent('.smart_delbx').addClass('selected');
			$(this).find('.btn_arrow').text('닫기');
			$('.smart_delbx .smart_lst').css('display' , 'block');
		}
		else{
			$(this).parent('.smart_delbx').removeClass('selected');
			$(this).find('.btn_arrow').text('자세히 보기');
			$('.smart_delbx .smart_lst').css('display' , 'none');
		}
		return false;
	});

	// main super deal
	$('.super_deal .m_title h3 .tit').bind('click', function(){
		$('.super_deal .m_title .cate_view').hide();
		$('.super_deal .m_title .cate_view li a').removeClass('selected');
		$('.super_deal .m_title .cate_area .btn_view').removeClass('selected');
		$('.super_deal .m_title .cate_view li .cate1').addClass('selected');
		$('.super_deal .m_title h3 .s_tit').html($('.super_deal .m_title .cate_view li .cate1').text());

	});
	$('.ecpn_tit .cate_lst .btn_info, .ecpn_tit .cate_lst .ly_info .btn_clse').bind('click', function(){
		$('.ecpn_tit .cate_lst .btn_info').toggleClass('selected');
		$('.ecpn_tit .cate_lst.best .ly_info').toggle();
	});
	$('.ecpn_tit h3 .t_dep').hide();
	$('.ecpn_tit h3').addClass('fl_bx');
	$('.ecpn_tit.best h3').css('display' , 'block');
	$('.ecpn_tit h3 .s_tit').addClass('on');
	$('.ecpn_tit .cate_lst .btn_cate').bind('click' , function(){
		$(this).parents('.ecpn_tit .cate_area').siblings('.ecpn_tit h3').removeClass('fl_bx');
		var txtDeal3 = $('.ecpn_tit .s_tit .in_txt');
		var txtCate2 = $(this).text();
		//if(!$(this).parents('.ecpn_tit .cate_lst .cate_sect').hasClass('selected')){
			txtDeal3.html(txtCate2)
			if(txtDeal3.show()){
				$(this).siblings('.cate_area .btn_view').removeClass('selected');
				$('.ecpn_tit .s_tit').removeClass('selected');
				$('.ecpn_tit .cate_view').hide().removeClass("on dep1 dep2");
				txtDeal3.siblings('.ecpn_tit .btn_view').show();
				$('.ecpn_tit .t_dep').show();
				$('.ecpn_tit .t_dep .btn_view').show();
				$('.ecpn_tit .t_dep').addClass('on');
			}
			$('.ecpn_tit h3 .s_tit').removeClass('on');
		//}
		if($(this).parents('li').hasClass('all')){
			$('.t_dep').hide();
			$('.ecpn_tit h3').addClass('fl_bx');
			$('.ecpn_tit h3 .s_tit').addClass('on');
		}
		if($(this).hasClass('all')){
			$('.t_dep').hide();
			$('.ecpn_tit h3').addClass('fl_bx');
			$('.ecpn_tit h3 .s_tit').addClass('on');
		}
		$('.ecpn_tit .t_dep .in_txt').html('전체');
		$('.ecpn_tit .t_dep').removeClass('selected');
	});
	$('.ecpn_tit .s_tit').bind('click' , function(){
		$(this).next().removeClass('selected');
		$('.ecpn_tit h3.fl_bx .s_tit').removeClass('on');
		$('.ecpn_tit .cate_sub_lst').hide();
		$('.ecpn_tit .cate_lst .btn_cate').show();
		$('.ecpn_tit .cate_lst').css('padding-bottom' , 0);

		$('.cate_area .cate_view').hide().removeClass("on dep2 dep1");
		if(!$(this).hasClass('selected')){
			$(this).addClass('selected')
			$('.cate_area .cate_view').show().addClass("on dep1");
			if($('.t_dep').hasClass('on')){
				$('.t_dep').removeClass('on');
			}
		}
		else{
			$(this).removeClass('selected')
			$('.cate_area .cate_view').hide().removeClass("on dep1 dep2");
		}
		return false;
	});

	$('.ecpn_tit .t_dep').bind('click' , function(){
		if(!$(this).hasClass('selected')){
			$(this).prev().removeClass('selected');
			$(this).addClass('selected');
			$(this).removeClass('on');
			$('.cate_area .cate_view').show();
			$('.ecpn_tit .selected .cate_sub_lst').show();
			$('.cate_area .cate_view').removeClass("dep1");
			if($('.ecpn_tit .selected .cate_sub_lst').css('display') == 'block'){
				var cate_height = $('.ecpn_tit .selected .cate_sub_lst').height();
				$('.ecpn_tit .cate_lst').css('padding-bottom' , cate_height + 'px');
				$('.ecpn_tit .cate_lst .btn_cate').css('display' , 'none');
				$('.cate_area .cate_view').show().addClass("on dep2");
			}
		}else{
			$('.ecpn_tit .cate_lst').css('padding-bottom' , 0);

			$(this).removeClass('selected')
			$('.ecpn_tit .selected .cate_sub_lst').hide();
			$('.cate_area .cate_view').hide().removeClass("on dep2 dep1");

		}
		return false;
	});
	$('.cate_area .cate_view li>a').bind('click' , function(){
		var txtDeal = $('.super_deal .s_tit');
		var txtDeal2 = $('.ecpn_tit .t_dep .in_txt');
		var txtCate = $(this).text();
		$(this).parents('.super_deal .cate_view').hide();
		$('.super_deal .btn_view').removeClass('selected');
		$('.cate_area .cate_view li a').each(function(){
			$(this).removeClass('selected');
		});
		$(this).addClass('selected');
		if(!$(this).parents().hasClass('super_deal')){
			$('.ecpn_tit h3 .t_dep').show();
			$('.cate_view').hide().removeClass("on dep2 dep1");
			$('.ecpn_tit .cate_lst').css('padding-bottom' , 0);
			$('.ecpn_tit h3 .t_dep').removeClass('selected');
			$('.ecpn_tit .t_dep').addClass('on');
			if(!$(this).parents().hasClass('best')){
				txtDeal2.html(txtCate);
			}
			else{
				txtDeal2.html(txtCate);
			}
		}
		else{ txtDeal.html(txtCate); }
	});
	/* 베스트 상단 탭  */
	$('.best_tab .tab_cont').hide()
	$('.best_tab .tab_cont').first().show()
	$('.best_tab .dsc .sp_best,.best_tab .bx .btn_clse').bind('click' , function(){
		if(!$(this).hasClass('btn_clse')){
			$(this).parent().siblings('.bx').toggle();
		}else{
			$(this).parent().toggle();
		}
	});
	$('.best_tab .tab_area a').bind('click' , function(){
		$(this).addClass('on').siblings().removeClass('on');
		var idx = $(this).index();
		$('.best_tab .tab_cont').hide().eq(idx).show()
	});
	$('.best_tab .cate_lst .btn_cate').bind('click' , function(){
		$('.best_tab .sel_area').show();
		$('.best_tab .cate_lst .btn_cate').hide();
		$(this).parent().addClass('selected');
		var $obj = $(this).parent();
		$('.best_tab .cate_lst .cate_sect').not($obj).each(function(){
			$(this).removeClass('selected');
		});
		var thisTxt = $(this).html();
		var thisTxt2 = $(this).siblings('ul').find('a').first().text();
		$('.best_tab .sel_area a').first().html(thisTxt);
		$('.best_tab .sel_area a').last().html('전체');
		$('.best_tab .sel_area a').removeClass('selected');
		$('.best_tab .cate_sub_lst').each(function(){
			$(this).find('a').first().removeClass('selected')
		});
	});
	$('.best_tab .cate_sub_lst a').bind('click' , function(){
		var thisTxt = $(this).html();
		$('.best_tab .sel_area a').last().html(thisTxt);
		$('.best_tab .cate_sub_lst a').each(function(){
			$(this).removeClass('selected');
		});
		$(this).addClass('selected');
		$('.best_tab .cate_sub_lst').hide();
		$('.best_tab .sel_area a').removeClass('selected');
	});
	$('.best_tab .sel_area a').bind('click' , function(){
		var idx = $(this).index();
		if(idx == '0'){
			$('.best_tab .cate_sect .cate_sub_lst').hide();
			if(!$(this).hasClass('selected')){$('.best_tab .cate_lst .btn_cate').show();}
			else{$('.best_tab .cate_lst .btn_cate').hide();}
		}else{
			$('.best_tab .cate_lst .btn_cate').hide();
			if(!$(this).hasClass('selected')){$('.best_tab .cate_sect.selected .cate_sub_lst').show();}
			else{$('.best_tab .cate_sect.selected .cate_sub_lst').hide();}
		}
		$(this).toggleClass('selected').siblings().removeClass('selected');
	});
	/* //베스트 상단 탭  */
	//마트 메인 탭메뉴
	$('.ecpn_tit.mart .cate_view').show();
	$('.ecpn_tit.mart h3').hide();
	$('.ecpn_tit .cate_lst .btn_cate').bind('click' , function(){
		if(!$(this).parent().hasClass('selected')){
			$(this).parent().addClass('selected');
			var $obj = $(this).parent();
			$('.ecpn_tit .cate_lst .cate_sect').not($obj).each(function(){
				$(this).removeClass('selected');
			});
			$('.ecpn_tit.mart h3').show();
		}
		else{
			$('.ecpn_tit .cate_lst .btn_cate').removeClass('selected');
		}
		return false;
	});

	//VIP TAB
	$(window).scroll(function(){
		vipTab();
		mainTop();
		vipOrigin();
		vipOptionBottom();
		mainClub();
	});
	function vipOrigin(){
		if($('#detailView img').length == 0) return;
		if($('.goods .zoom_noti').length > 0){
			if ($(this).scrollTop() >= $('.zoom_noti').offset().top - 48) {
				$('.goods .ly_info').show().delay(2000).fadeOut(function(){
					$(this).remove();
				});
			}
		}
	}
	$('.goods .ly_info,.goods .ly_info .btn_clse').on('click' , function(){
		$('.goods .ly_info').remove();
	});

	var app_ver_check = 0;
	var app_ver_check2 = 0;
	function isAppHigherVersionThan(compareVersion) {
		app_pcid = checkAppCookie("pcid");
		app_version = checkAppCookie("app_info");
		start = app_version.indexOf(":") + 1;
		version = app_version.substring(start, start + 5).replace(/\./g, "");
		if (app_pcid == "") {
			app_user = false;
		} else {
			app_user = true;
		}
		if (app_user == true && parseInt(version) > compareVersion) {
			app_ver_check = 1;
			return true;
		} else {
			return false;
		}
	}

	function vipTab(){
		if($(".goods").length == 0) return;

		/* android App Check */
		var name="pcid", start, end, pcid = "", isAndroidApp;
		if (document.cookie.length > 0) {
			start = document.cookie.indexOf(name + "=");
			if (start != -1) {
				start = start + name.length + 1;
				end = document.cookie.indexOf(";", start);
				if (end == -1) end = document.cookie.length;

				pcid = unescape(document.cookie.substring(start, end));
			}
		}
		isAndroidApp = (pcid.substr(0, 1) == "3");

		/* ios Version Check */
		var ua = navigator.userAgent.toLowerCase();
		var iosIndex = ua.indexOf('ios');
		var isIphoneApp = (iosIndex != -1);
		var versionStartIndex, versionEndIndex;
		var iosVersion = -1;

		if (isIphoneApp) {
			versionStartIndex = iosIndex + 4;
			versionEndIndex = ua.indexOf(';', versionStartIndex);
			iosVersion = parseInt(ua.slice(versionStartIndex, versionEndIndex).replace(/\./g, ""));
		}

		if(isAndroidApp || isIphoneApp){
			isAppHigherVersionThan(561);
		}

		if ((!isIphoneApp || iosVersion >= 521 || $('#wrap').hasClass('app_sfc'))) {
			if ($(this).scrollTop() <= 50) {
				$('.goods .btn_top').hide();
				$('.goods .btn_detail_view').hide();
			}
			if ($(this).scrollTop() > 50) {
				if (app_ver_check == 1) {
					$('.goods .btn_top').show();
					if(!$('.goods .btn_top').hasClass('type2')){
						$('.goods .btn_detail_view').show();
					}
				}else if(!isAndroidApp){
					$('.goods .btn_top').show();
					if(!$('.goods .btn_top').hasClass('type2')){
						$('.goods .btn_detail_view').show();
					}
					if(iosVersion >= 570 && iosVersion <= 10000){
						$('.goods .btn_top').hide();
						$('.goods .btn_detail_view').hide();
					}

				}
			}
		}else{
		}

		if ((!isIphoneApp || iosVersion >= 521) && $('.tab_wrap').css('display') === "block") {
			if ($(this).scrollTop() < $('.tab_wrap').offset().top - 46) {
				$('.tab_wrap .tab_detail').removeClass('tab_layer');
				if(typeof $('.goods .btn_detail')[0] !== "undefined")	$('.goods .btn_detail').hide();
			}
			if ($(this).scrollTop() >= $('.tab_wrap').offset().top - 46) {
				$('.tab_wrap .tab_detail').addClass('tab_layer');
				if($('#simple_header').css('display')=='none' || $('#simple_header').length == 0){
					$('.tab_wrap .tab_detail').addClass('v2');
				}else{
					$('.tab_wrap .tab_detail').removeClass('v2');
				}
				if(typeof $('.goods .btn_detail')[0] !== "undefined")	$('.goods .btn_detail').show();
			}
			if ($(this).scrollTop() < $('.tab_wrap').offset().top || $(this).scrollTop() >= $('#liveHolder').offset().top - 300) {
				$('.goods .prod_dtl .btn_origin').hide();
			} else if (!isAndroidApp && !isIphoneApp) {
				$('.goods .prod_dtl .btn_origin').show();
			}
		}
	}

	// app header
	function appHeaderCheck(){
		/* android App Check */
		var name="pcid", start, end, pcid = "", isAndroidApp;
		if (document.cookie.length > 0) {
			start = document.cookie.indexOf(name + "=");
			if (start != -1) {
				start = start + name.length + 1;
				end = document.cookie.indexOf(";", start);
				if (end == -1) end = document.cookie.length;

				pcid = unescape(document.cookie.substring(start, end));
			}
		}
		isAndroidApp = (pcid.substr(0, 1) == "3");

		/* ios Version Check */
		var ua = navigator.userAgent.toLowerCase();
		var iosIndex = ua.indexOf('ios');
		var isIphoneApp = (iosIndex != -1);
		var versionStartIndex, versionEndIndex;
		var iosVersion = -1;


		if(isIphoneApp){
			versionStartIndex = iosIndex + 4;
			versionEndIndex = ua.indexOf(';', versionStartIndex);
			iosVersion = parseInt(ua.slice(versionStartIndex, versionEndIndex).replace(/\./g, ""));
		}

		var andIndex = ua.indexOf('android;');
		var andVersion = -1;
		if(isAndroidApp){
			versionStartIndex = andIndex + 8;
			versionEndIndex = ua.indexOf(';', versionStartIndex);
			andVersion = parseInt(ua.slice(versionStartIndex, versionEndIndex).replace(/\./g, ""));
		}

		if(!isAndroidApp && !isIphoneApp){
			if(typeof $('.login .at_log')[0] !== "undefined"){
				$('.login input').not("input[type='radio'], input[type='checkbox']").each(function(){
					$(this).focusin(function(){ $('.lgb').hide() });
					$(this).focusout(function(){
						if ($(this).parents('.at_log').hasClass('mem')) {
							$('.lgb').hide();
							$('.lgb.mem').show();
						}else{
							$('.lgb').hide();
							$('.lgb.nm').show();
						}
					});
				});
			}
		}

		/* sfc App Check */
		var sfc_ua = navigator.userAgent.toLowerCase();
		var sfcIndex = ua.indexOf('sfc');
		var isSfcApp = (sfcIndex != -1);

		var head = $('#head');
		var homeTab = $('#home_tabs');
		var superDealCate = $('.super_deal .sdeal_cate');
		var superDealLy = $('.super_deal .ly_sub');
		var cateLy = $('.cate_tab .tab_slide');
		var btnTopBar = $('.btn_top_bar');

		if(andVersion > 573 || iosVersion > 573 && iosVersion <= 10000){
			head.addClass('app');
			$('#wrap').addClass('app_gm');
			if(superDealCate.length > 0){
				superDealLy.addClass('app');
			};
			if(cateLy.length > 0){
				cateLy.addClass('app');
			}
			if(btnTopBar.length > 0){
				btnTopBar.addClass('app');
			}
			if($('.gds_list .bot_ordbx').length > 0){
				$('.gds_list .bot_ordbx').css('bottom',0);
			}
		}else if(isSfcApp){
			head.addClass('sfc');
			$('#wrap,html').addClass('app_sfc SFC'); //기존 분기내용 포함

			if($('body').hasClass('service__cart')){ //cart saturn  - sfc
                $('html').addClass('app_sfc');
            }
			if(homeTab.is(':visible')){
				$('<div class="home_tab_blank"></div>').appendTo($('#head'));
			}
			if(superDealCate.length > 0){
				superDealLy.addClass('app');
			};
			if(btnTopBar.length > 0){
				btnTopBar.addClass('sfc');
			}
			if(cateLy.length > 0){
				cateLy.addClass('app');
			}
		}

		if(isAndroidApp || isIphoneApp){
			if(!isSfcApp){
				if(iosVersion < 574 || andVersion < 574){
					if(iosVersion > 10000){
					}else{
						btnTopBar.addClass('old');
					}
				}
			}else{
			}
		}
	}
	appHeaderCheck();

	function mainTop(){
		if($(".btn_top_main").length == 0) return;
		if ($(this).scrollTop() > 50){
			$(".btn_top_main").fadeIn();
		}
		else{
			$(".btn_top_main").fadeOut();
		}
	}

	//배달
	// main input
	$('.shop_srchbx .inp_wrap input').focus(function () {
		$(this).siblings().hide();
	})
	.blur(function () {
		$(this).siblings().show();
		if(!$(this).val() == "") {
			$(this).siblings().hide();
		}
	});

	//VIP 단골설정
	$('.del_vipbx .btn_like').bind('click' , function(){
		if(!$(this).hasClass('selected')){
			$(this).addClass('selected');
		}
		else{
			$(this).removeClass('selected');
		}
		return false
	});

	//인기메뉴
	$('.mprice_lst .series, .mprice_lst .btn_more').bind('click' , function(){
		if($(this).siblings('.mprice_inlst').css('display') == 'none'){
			$(this).parent().addClass('selected');
			$(this).parent().siblings().removeClass('selected');
		}
		else{
			$(this).parent().removeClass('selected');
		}
	});
	$('.ly_align .ly_lst a').bind('click' , function(){
		if(!$(this).parent().hasClass('selected')){
			$(this).parent().addClass('selected');
			$(this).parent().siblings().removeClass('selected');
		}
		else{
			$(this).parent().removeClass('selected');
		}
	});

	//배달헤더
	$('#head .delivery .scb_hd').hide();
	$('#head .delivery .dret_btn .srch').bind('click' , function(){
		$(this).parent().hide();
		$(this).parent().next('#head .delivery .scb_hd').show();
	});
	$('#head .delivery .scb_hd .btn_close').bind('click' , function(){
		$(this).parents('#head .delivery .scb_hd').hide();
		$(this).parents('#head .delivery .scb_hd').siblings('#head .delivery .dret_btn').show();
	});
	$('#head .delivery .scb_hd .del_btn').bind('click' , function(){
		$(this).siblings('.scb_sub').find('input').val('');
	});

	//상점 한마디
	$('.pr_wrap .btn_more').click(function(){
		var prLayer = $(this).siblings('.pr_layer')
		, isPrHeight = prLayer.height() / 2;
		if(prLayer.show()){
			prLayer.css ({
				'top' : '50%' ,
				'margin-top' : -isPrHeight
			})
		}
	});

	//배달 옵션레이어
	$('.mprice_inlst .inp_chk').bind('click', function(){
		var ischked = $(this).is(':checked');
		var isparent = $(this).parent();
		var isOpt = isparent.siblings('.ly_opt');
		if(ischked){
			isOpt.show();
			$("<div id='mask' selected='true'></div>").appendTo("#wrap");
			if(isparent.next().size() == 0){
				$('#mask').remove();
			}

			if(isOpt.find('.opt_plus').size() == 0){
				var isOptHeight = isOpt.height() /2;
				isOpt.css('margin-top' , -isOptHeight );
				return;
			}
			var bxHeight = isOpt.find('.scroll_box').height();
			if(bxHeight < 158){
				isOpt.find('.opt_wrapper').css('height' , bxHeight);
			}else{
				isOpt.find('.opt_wrapper').css('height' , '158');
			}
			var isOptHeight = isOpt.height() /2;
			isOpt.css('margin-top' , -isOptHeight );
		}else{
			$('#mask').remove();
		}
	});

	$('.ly_opt .btn_close,.ly_opt .btn_plus').click(function() {
		if($(this).hasClass('btn_plus')){
			$(this).parents('.ly_opt').addClass('checked');
		}else{
			$(this).parents('.ly_opt').removeClass('checked');
		}
		var rdochked =  $(this).parents('.ly_opt');
		if(!rdochked.hasClass('checked')){
			$(this).parents('.ly_opt').siblings().children('input').attr("checked", false);
		}
	});

	//배달 FAQ, 공지사항
	$('.board_subtab a').bind('click', function(){
		if(!$(this).parent().hasClass('selected')){
			$(this).parent().addClass('selected');
			$(this).parent().siblings().removeClass('selected');
		}
		else{
			$(this).parent().removeClass('selected');
		}
	});

	//배달 쿠폰 탭
	$('.coupon_tab a').bind('click' , function(){
		if(!$(this).hasClass('on')){
			$('.coupon_tab a').removeClass('on');
			$(this).addClass('on');
		}
		else if($('.opt_plus a').hasClass('on')){
			$('.coupon_tab a').removeClass('on');
			$(this).addClass('on');
		}
	});

	//배달 배송지 정보
	$('.ord_cont .adr_new').css('display' , 'none');
	$('.ord_arttit .btn_edit').bind('click' , function(){
		if(!$(this).hasClass('selected')){
			$(this).addClass('selected');
			$('.ord_cont .adr_info').css('display' , 'none');
			$('.ord_cont .adr_new').css('display' , 'block');
		}
		else{
			$(this).removeClass('selected');
			$('.ord_cont .adr_info').css('display' , 'block');
			$('.ord_cont .adr_new').css('display' , 'none');
		}
		return false;
	});

	$('.del_menulst .btn_cate').bind('click' , function(){
		$(this).parent().addClass('selected').siblings().removeClass('selected');
	});

	//배달 추천할인상점 레이어 20170801
	$('.notipop').click(function(){
		$(this).next('.noti_shop').show();
	});
	$('.noti_clse').click(function(){
		$(this).parents('.noti_shop').hide();
	});

	// 그룹보기
	$('#group_view').bind('click' , function(){
		$('#mask').remove();
		$('.box').toggle();

		if($('.box').css("display") == "block"){
			$("<div id='mask'></div>").appendTo("#h_list");
		}
		else{
			$('#mask').remove();
		}
		return false;
	});

	$('.filter_group .opt_plus li').bind('click' , function(){
		$('#group_view').html($(this).text());
		$('.box').hide();
		$('#mask').remove();
	});

	//기획전 상품리스트 보더
	var listNumber = $('.item_line1 .horizontal_list li').size();
	if(listNumber % 2 == 0){
		 $('.item_line1 .horizontal_list li:last-child,.item_line1 .horizontal_list li:nth-last-child(2)').addClass('last_line');
		}else{
		 $('.item_line1 .horizontal_list li:last-child').addClass('last_line');
	}

	$('.tab_wrap .tab_detail a').bind('click' , function(){
		if($(this).find('#reviewCount').text().replace(/[^0-9]/g,"") == '0'){
			alert('등록된 상품평이 없습니다. \n첫 포토상품평 작성하시고, 혜택 받아가세요~')
		}else{
			$('.tab_wrap .tab_detail a').removeClass('selected');
			$(this).addClass('selected');
			var viewIndex = $(this).index();
			if(viewIndex == 0){
				$('.prod_view').show();
			}
			else{
				$('.prod_view').hide();
				$('.prod_view').eq(viewIndex).show();
			}
			if($('.vip_header').css('display')=='none' || $('.vip_header').length == 0){
				$(window).scrollTop($('.tab_wrap').offset().top);
			}else{
				$(window).scrollTop($('.tab_wrap').offset().top - 46);
			}
		}

		return false;
	});

	//회원가입 전체동의
	$('.agree_all input').bind('click' , function(){
		var chk = $(this).is(':checked');
		if(chk) $('.agree_chkbx input').prop('checked' , true);
		else $('.agree_chkbx input').prop('checked' , false);
	});

	//회원가입 약관 내용보기
	$('.agr_pointbx .btn_more').click(function(e){
		e.preventDefault;
		showAgree();
	});

	//회원가입 동일 CI , DI 있을경우
	var dupliChkId = $('.person_cnt .dup_area').find('.view_txt');
	dupliChkId.on({
		click:function(e){
			e.preventDefault;
			$(this).toggleClass('on').siblings().removeClass('on');
		}
	});

	function showAgree(){
		if( $(".agr_pointbx").hasClass('agr_open') ){
			$(".agr_pointbx").removeClass('agr_open');
			$('.agr_pointbx .point_artwrap').hide();
		} else {
			$('.agr_pointbx').addClass('agr_open');
			$('.agr_pointbx .point_artwrap').show();

			var ifrmPos = $('.point_artwrap iframe');
			var ifrmCont = 'body .point_agrwrap';
			iframeResize(ifrmPos, ifrmCont);
		}
	}

	//스마트 배송관
	//검색
	$('.smart_box .btn_srch').click(function() {
		var smartBx = $(this).parent();
		smartBx.toggleClass('srch');
		if(smartBx.hasClass('srch')){
			smartBx.find('.srch_bx').show();
		} else {
			smartBx.find('.srch_bx').hide();
		}
	});

	//스마트 배송관 셀렉트 레이어
	$('.srch_in .btn_sel').click(function() {
		var srchBx = $(this).parent(),
		layer = $('.srch_bx').find('.ly_sel');

		$('.srch_bx').find('.ly_sel').toggle();

		$('.sel_lst a').click(function(e) {
			e.preventDefault();
			var t = $(e.currentTarget)
			, text = t.text()
			, btnSel = $('.srch_in .btn_sel');

			t.parent().addClass('selected').siblings().removeClass('selected');
			btnSel.html(text);
			layer.hide();
		});
	});

	//스마트배송관 탭
	$('.main_cate .btn_menu').click(function() {
		var menuList = $(this).parent()
		, btnMore = $(this).parents('.cate_wrap').find('.btn_more')
		, listHeight = ($(this).siblings().height() - (btnMore.height() + 11)) + 'px';

		menuList.toggleClass('on').siblings().removeClass('on');
		if(menuList.hasClass('on')){
			$(this).parents('.main_cate').css('padding-bottom', listHeight);
		}else{
			$(this).parents('.main_cate').css('padding-bottom', 0);
		}
	});

	//스마트배송관 탭 리스트
	$(window).on("load resize orientationchange", function(){
		changeCtext();
	});

	function changeCtext(){
		var wrapObj = $('.tab_cntwrap .prod_box');
		var bnrUL = wrapObj.find('ul');
		var bnrLI = wrapObj.find('li');
		var bnrULHeight = bnrLI.height();//이미지높이값
		wrapObj.css('height',bnrULHeight);//래퍼높이값 조절
		if(!wrapObj.parents('.tab_cntwrap').length == 0){
			wrapObj.parents('.tab_cntwrap').css('height',bnrULHeight);
		}
	}

	//스마트배송관 베스트
	$('.arttit_bx .sb_tab li a').click(function(e){
		e.preventDefault();
		$(this).parent('li').addClass('on').siblings().removeClass('on');
	});

	//비즈온
	//비즈온 추천검색어 인기상품
	$('.biz_cont .biz_pop_list>li').click(function() {
		if(!$(this).hasClass('selected')){
			$(this).siblings().removeClass('selected');
			$(this).addClass('selected');

			var tgH = $(this).find(".pop_list_bx").outerHeight(true);
			$('.biz_pop_list').css('padding-bottom' , tgH);
			return false;
		}
	});

	function bizPrd(){// 높이값만큼 padding 값으로 삽입
		var ulHeight = $('.biz_pop_list .pop_list_bx').height() ;
		$('.biz_pop_list').css('padding-bottom' , ulHeight)
	}

	var ulLength = $('.biz_pop_list>li').length;
	$('.biz_pop_list>li').css('width', 100/ulLength+'%');
	$('.biz_pop_list>li:first-child').addClass('selected');

	$('img').load(function(){
		bizPrd(); //이미지를 모두 불러온 후 함수실행
	});
	$(window).bind("resize", function(){
		if($('.biz_pop_list .pop_list_bx').length == 0) return;
		bizPrd();
	});

	//비즈온 lp 카테고리 탭
	$('.biz_cont .lp_cate>li').click(function() {

		$('.biz_cont .lp_sub_cate').css('display','none');
		$(this).children('.lp_sub_cate').css('display','block');
		$(this).addClass('on').siblings().removeClass('on');
		if($('.biz_cont .lp_cate li:first-child').addClass('on')){
			$('.lp_cate').css('padding-bottom', '0');
		}

		var menuList = $(this)
		, listHeight = ($(this).children('.lp_sub_cate').height()) + 'px';

		menuList.addClass('on').siblings().removeClass('on');
		if(menuList.hasClass('on')){
			$(this).parents('.lp_cate').css('padding-bottom', listHeight);
		}else{
			$(this).parents('.lp_cate').css('padding-bottom', 0);
		}
		return false;
	});
	$('.biz_cont .lp_sub_cate>li').click(function() {
		$('.biz_cont .lp_sub_cate>li').removeClass('on');
		$(this).addClass('on').siblings().removeClass('on');
		return false;
	});

	//비즈온 FAQ
	$('.fnq_wrap .btn_open').bind('click' , function(){
		$(this).parent().siblings('.answer').css('display','block');
		$(this).css('display','none')
		return false;
	});
	$('.fnq_wrap .btn_cls').bind('click' , function(){
		$(this).parent().siblings('.question').children('.btn_open').css('display','block');
		$(this).parent().css('display','none');
		return false;
	});
	//비즈온 판매가이드 - 카테고리 안내
	$('.biz_cont .cate_name').bind('click' , function(){
		if($(this).parent().hasClass('on')){
			$(this).parent().removeClass('on');
		}else{
			$(this).parent().addClass('on');
		}
		return false;
	});
	//문의하기
	$('.inq_notebx .btn_more').click(function(e){
		e.preventDefault;
		$(this).parent('.inq_notebx').toggleClass('note_more');
		if($(this).parent('.inq_notebx').hasClass('note_more')){
			$(this).text('펼침닫기');
		} else {
			$(this).text('펼쳐보기');
		}
	});
    //여행
	$('.select_area').on("click", '.country_select', function(){
		$(this).toggleClass('on');
		$('.select_area .select_lst').toggle();
		return false;
	});
	$('.select_lst li').click(function(){
		var replaceTxt = $(this).children().html();
		var country = $('.country_select');
		$('.select_lst li').removeClass('on');
		$(this).addClass('on');
		country.text(replaceTxt);
		country.removeClass('on');
		$(this).parents('.select_lst').hide();
		return false;
	});
	$('.select_area').on("click", '.btn_align', function(){
		$('.select_area .align_lst').toggle();
		$(this).toggleClass('on');
		return false;
	});
	$('.select_area .align_lst li').click(function(){
		$('.select_area .align_lst li').removeClass('on');
		$(this).addClass('on');
		$(this).parents('.select_area .align_lst').hide();
		$('.select_area .btn_align').removeClass('on');
		return false;
	});
	$('.select_area').on('click', '.info', function(){
		$(this).toggleClass('on');
		$('.select_area .info_box').toggle();
		return false;
	});

	//백화점
	$('.sec_dept .noti_best > a').click(function(){
		$(this).next('.ly').show();
	});
	$('.sec_dept .noti_best .ly .btn_close').click(function(){
		$(this).parents('.ly').hide();
	});

	//마트탭 개편
	if ($('.lst_mart_cate, .others_view').length>0){
	$('.lst_mrt').bxSlider({
		moveSlides: 1,
		infiniteLoop: true,
		oneToOneTouch: false,
		touchEnabled: ($('.lst_mrt > li').length > 1) ? true: false,
		pager: ($('.lst_mrt > li').length > 1) ? true: false,
		controls: ($('.lst_mrt > li').length > 1) ? true: false
	});
	$('.lst_mrt2').bxSlider({
		moveSlides: 1,
		infiniteLoop: true,
		oneToOneTouch: false,
		touchEnabled: ($('.lst_mrt2 > li').length > 1) ? true: false,
		pager: ($('.lst_mrt2 > li').length > 1) ? true: false,
		controls: ($('.lst_mrt2 > li').length > 1) ? true: false
	});
	$('.others_view > ul').bxSlider({
		mode: 'fade',
		speed: 0,
		moveSlides: 1,
		randomStart: false,
		oneToOneTouch: false,
		pager: false,
		touchEnabled: ($('.others_view > ul > li').length > 1) ? true: false,
		controls: ($('.others_view > ul > li').length > 1) ? true: false,
		preventDefaultSwipeY: true,
		infiniteLoop: false,
		hideControlOnEnd:true
	});
	}
	var lstIndex = $('.scroll_mart_cate li').length;
	var lstWidth = $('.scroll_mart_cate li').width();
	$('.scroll_mart_cate ul').css('width',lstWidth*lstIndex);

	//e쿠폰
	$('.ecpn_state h4 > a, .ecpn_state h5 > a').click(function(){
		if ($(this).parent().hasClass('cur')){
			$(this).parent().toggleClass('select');
		}
	});
	$('.slt_btn_all .btn_all').click(function(){
		$(this).toggleClass('on');
	});
	$('.slt_btn_all li').click(function(){
		$(this).addClass('cur');
		$('.slt_btn_all li').not(this).removeClass('cur');
		$('.slt_btn_all .btn_all').removeClass('on');
		bestEcpnScroll()
	});

	//취소신청
	$('.chkbx.all .input_chk').bind('click' , function(){
		var chk = $(this).is(':checked');
		if(chk) $('.cancel_list .input_chk').prop('checked' , true);
		else $('.cancel_list .input_chk').prop('checked' , false);
	});
	if(typeof $('#ly_scroll_cont')[0] !== "undefined"){
		var cclbxScroll = new iScroll('ly_scroll_cont', { hScrollbar: true, vScrollbar: true, checkDOMChanges: true});
		if ($(this).find('.goods').length > 1){
			if(cclbxScroll == null){
				cclbxScroll = new iScroll('ly_scroll_cont', { hScrollbar: true, vScrollbar: true, checkDOMChanges: true});
			}
		}else{
			cclbxScroll.destroy();
		$('.buy_list.step2').css('height', $(this).find('.goods').height()+22)
		}
	}
	var mainClub = function(){
		if($(".sevlist_cnt").length == 0) return;
		var sTop = $(document).scrollTop() + 99;
		var clubTop = $('.sevlist_cnt').offset().top;
		if(sTop > clubTop){
			$('.sevlist_cnt .info_sc').css('z-index' , '10');
		}else{
			$('.sevlist_cnt .info_sc').css('z-index' , '410');
		}
	}

});

function bestEcpnScroll() {
	if(typeof $('#lst_ecpn2')[0] !== "undefined"){
		var hCateScroll = new Swiper('#lst_ecpn2', {
			slidesPerView: 'auto',
			freeMode: true,
		});
	}
}
document.addEventListener('DOMContentLoaded', bestEcpnScroll, false);

var setClickEvent = function () {
  //homeplus
    var tab_bx = $(".addr_tab")
        ,addr_tab = $(tab_bx).find("li a")
		,tab_bx_new = $(".addr_tab_new")
        ,addr_tab_new = $(tab_bx_new).find("li a")
        ,tab_view = $(".layer_hplus .htab_view")
		,tab_view_new = $(".layer_hplus_new .htab_view")
        ,btn_zip = $(tab_view).find(".btn_zip")
		,btn_zip_new = $(tab_view_new).find(".btn_zip")
        ,ipt_sec = $(".new_addr_bx .ipt_sec")
        ,ipt_input = $(ipt_sec).find('input')
        ,ipt_zip = $(".ser_zip")
        ,zip_ok = $(ipt_zip).find(".chk");
        $(addr_tab).click(function(e){
            e.preventDefault();
            var href = $(this).attr("href");
            $(".addr_tab li").removeClass("on");
            $(this).parent('li').addClass("on");
            $(tab_view).css({'display':'none'});
            $(this).parents('.addr_tab').siblings("#"+href).css({'display':'block'});
        });
		 $(addr_tab_new).click(function(e){
            e.preventDefault();
            var href = $(this).attr("href");
            $(".addr_tab_new li").removeClass("on");
            $(this).parent('li').addClass("on");
            $(tab_view_new).css({'display':'none'});
            $(this).parents('.addr_tab_new').siblings("#"+href).css({'display':'block'});
        });
        $(btn_zip).click(function(){
            $(ipt_sec).addClass("none");
            $(ipt_zip).addClass("on");
        });
	    $(btn_zip_new).click(function(){
            $(ipt_sec).addClass("none");
            $(ipt_zip).addClass("on");
        });
        $(zip_ok).click(function(){
            $(ipt_sec).removeClass("none");
            $(ipt_zip).css({'display':'none'});
        });
        $(ipt_input).on({
            focus : function(){
                $(this).parents('.input_area').addClass("on");
            },
            blur : function(){
                $(this).parents('.input_area').removeClass("on");
            }
        });
}
function join(){
	var joinObj = {
		$iconChk : $(".join_art .dash "),
		$placeholder : $(".form_bx label"),
		setFn : function () {
			(joinObj.$placeholder.length > 0 )? joinObj.placeholder() : null ; // placeholder
		},
		placeholder : function(){
			var $inputType;
			var $input = joinObj.$placeholder.closest(".form_bx").find("input");

			joinObj.$placeholder.click(function(){
				( $(this).parent().hasClass("textarea") ) ? $inputType = "textarea" : $inputType = "input" ;
				$(this).parent().find(".form_bx").addClass("hide_lb");
				$(this).parent().find($inputType).eq(0).focus();
			});
			$input.focus(function(){
				$(this).parent(".form_bx").addClass("hide_lb");

			}).blur(function(){
				if($(this).siblings("input").val() == undefined){
					( $(this).val() == "" )? $(this).parent(".form_bx").removeClass("hide_lb") : $(this).parent(".form_bx").addClass("hide_lb");
				}else{
					( $(this).val() == "" && $(this).siblings("input").val() == "" )? $(this).parent(".form_bx").removeClass("hide_lb") : $(this).parent(".form_bx").addClass("hide_lb");
				}
			}).change(function(){
				if($(this).val() == "" && $(this).siblings("input").val() == ""){
					$(this).parent(".form_bx").removeClass("hide_lb");
				}else {
					$(this).parent(".form_bx").addClass("hide_lb");
				}
			}).blur();

			 joinObj.$placeholder.closest(".form_bx").find("textarea").blur(function () {
				 ( $(this).val() == "" )? $(this).parent(".textarea").find(".form_bx").removeClass("hide_lb") : $(this).parent(".textarea").find(".form_bx").addClass("hide_lb");
			 }).change(function() {
				( $(this).val() == "" )? $(this).parent(".textarea").find(".form_bx").removeClass("hide_lb") : $(this).parent(".textarea").find(".form_bx").addClass("hide_lb");
			 });
		},
		eventBlock : function (e){
			if(e.preventDefault) e.preventDefault();
			else e.returnValue = false;
		}
	};
	joinObj.setFn();
}

var cartPop = function(btn){
	var $tgbtn = $(btn);
	var lycartTag = '<div class="ly_inter"><img src="//pics.gmarket.co.kr/mobile/img_bask_chk.png" alt=""></div>';
	$(lycartTag).appendTo($tgbtn.parents('.kind_artwrap'));
	var tgRight = (window.innerWidth - 112)/2;
	var tgTop = (window.innerHeight - 112)/2;

	var $lycart = $('.kind_artwrap .ly_inter');
	$lycart.css(
		{right:tgRight + 56, top:tgTop+56}
	);
	$lycart.animate(
		{width : '112px', opacity : 1, marginTop : -56, marginRight : -56}
	, 500).delay(600)
	.animate(
		{top : 74 , right : 104 , opacity : 1, width: '40px', height : '40px'}
	, function(){
		$lycart.remove();
		for(var i = 0 ; i < 2 ; i ++) {
			$('#head .dret_btn .cart.cart_in .num').animate(
				{fontSize : '0.85rem'}
			, 600).animate(
				{fontSize : '0.68rem'}
			, 200);
		}
	});
};

$(function(){
	join();
});

var vipCart = function(callback){
	$('<div class="ly_inter"><img src="//pics.gmarket.co.kr/mobile/img_bask_chk.png" alt=""></div>').appendTo($('.goods .btn_list_wrap .bask').parents('.btn_list_wrap'));
	var tgRight = (window.innerWidth - 112)/2;
	var tgTop = (window.innerHeight - 112)/2;
	$('.goods .btn_list_wrap .ly_inter').css({right:tgRight + 56, top:tgTop+56});
	$('.goods .btn_list_wrap .ly_inter').animate({width : '112px', opacity : 1, marginTop  : -56, marginRight  : -56}, 300).delay(600)
	.animate({top : 74 , right : 104 , opacity : 1, width: '40px', height : '40px'},300, function(){
		$('.goods .btn_list_wrap .ly_inter').remove();
		if(typeof callback === 'function') {
			callback();
		}
		for(var i = 0 ; i < 2 ; i ++) {
			$('#head .dret_btn .cart.cart_in .num').animate({fontSize : '0.85rem'}, 600).animate({fontSize : '0.68rem'}, 200);
		}
	});
}
var pushInterPrd;
var deleteInterPrd;
var resetRecent;
var initRecentItem = function(){
	var $ly_recent = $(".recent_wrap");
	var $btn_edit;
	var $btn_sel;
	var $box_recent = $ly_recent.find(".ly_recent");
	var $interBox = $ly_recent.find(".ly_inter");
	var $delBox = $ly_recent.find(".ly_del");
	var $delBox2 = $ly_recent.find(".ly_del.comp");
	var $snsLayer = $(".share_sns");

	var recentScroll;
	var resizeViewRecent = function(){
		var recentWrapHt = $(window).outerHeight(true) - ( ( $("#header_wrapper").size() >0 )? $("#header_wrapper").height() : 0 ) - (parseInt($box_recent.css("bottom")) + 10)  - $box_recent.find(".art_titbx").height();
		if($('#footer_bar_menu .recent_wrap').hasClass('disable')){
		}else{
			if(typeof recentScroll === "undefined") recentScroll = new iScroll("recent-scr",{
				click:true,
				scrollbarClass: 'myscrollbar',
				onBeforeScrollStart: function (e) {
					var target = e.target;
					while (target.nodeType != 1) target = target.parentNode;

					if (target.tagName != 'SELECT' && target.tagName != 'INPUT' && target.tagName != 'TEXTAREA')
						e.preventDefault();
				}
			});
		};

		if(recentWrapHt <= $box_recent.find(".recen_bx").innerHeight()) {
			$box_recent.find(".art_cntbx").height(recentWrapHt);
		}
		else{
			if(typeof recentScroll !== "undefined"){
				$box_recent.find(".art_cntbx").height('auto');
			}
		}
		if($('#footer_bar_menu .recent_wrap').hasClass('disable')){
		}else{
			recentScroll.refresh();
		};
	};

	var interItem = function() {
		$interBox.fadeIn(function(){
			setTimeout(function(){
				$interBox.fadeOut();
				$ly_recent.find(".recen_lst .inp_chk").prop("checked", false);
			}, 700);
		});
	}
	pushInterPrd = interItem;

	var delLayerPrd = function() {
		$delBox2.show();

		setTimeout(function() {
			$delBox.hide();
			$('#mask').remove();
		}, 1300);
	}
	deleteInterPrd = delLayerPrd;

	var resetLayer = function() {
		$ly_recent.removeClass("ly_open");
		$ly_recent.find(".ly_recent").removeClass("int_edit");
		$btn_sel.css({display:"none"});
		$btn_edit.css({display:"block"});
		$ly_recent.find(".recen_lst .inp_chk").prop("checked", false);
		$(".re_dimmed").remove();
		document.removeEventListener("touchmove", onRemoveScroll, false);

		if($(".recent_wrap").css("display") =="none"){
			$(".btn_top_main").removeClass("type2");
		}
	}
	resetRecent = resetLayer;

	$ly_recent.find(".btn_wrap").each(function(){
		var $this = $(this);
		if($this.hasClass("type2")) {
			$this.addClass("set-cancel");
			$btn_sel = $this;
		}
		else{
			$this.addClass("set-editor");
			$btn_edit = $this;
		}
	});

	$ly_recent.find(".btn.edit").on({
		click : function(e){
			e.preventDefault();
			var $this = $(this);
			if($this.parents(".set-editor").size()>0){
				$btn_sel.css({display:"block"});
				$btn_edit.css({display:"none"});
				$ly_recent.find(".ly_recent").addClass("int_edit");
			}
			else{
				$btn_sel.css({display:"none"});
				$btn_edit.css({display:"block"});
				$ly_recent.find(".ly_recent").removeClass("int_edit");
				$ly_recent.find(".recen_lst .inp_chk").prop("checked", false);
			}
		}
	});

	$ly_recent.find(".btn_recent").on({
		click:function(e){
			e.preventDefault();
			if($ly_recent.hasClass("ly_open")){
				resetLayer();
			}
			else{
				if($('#footer_bar_menu').is(':visible')){
					if($('#footer_bar_menu .btn_recent img').is(':visible')){
						document.addEventListener("touchmove", onRemoveScroll, false);
						$("<div class='re_dimmed' style='z-index:390'></div>").appendTo("#footer_bar_menu");
						$(".re_dimmed").show();
						$ly_recent.addClass("ly_open");
						resizeViewRecent();
					}
				}else{
					document.addEventListener("touchmove", onRemoveScroll, false);
					$("<div class='re_dimmed' style='z-index:390'></div>").appendTo("#wrap");
					$(".re_dimmed").show();
					$ly_recent.addClass("ly_open");
					resizeViewRecent();
				}
			}

			$('.re_dimmed').click(function(e){
				e.preventDefault();
				resetLayer();
			});
		}
	});

	$btn_sel.find("button").on({
		click:function(e){
			e.preventDefault();

			if($(this).hasClass("del")){
				$delBox.css({display:"-webkit-box"});
				$("<div id='mask'></div>").appendTo(".ly_recent");
				if($delBox.hasClass('comp')) {
					$delBox2.hide();
				}
			} else {
				$('#mask').remove();
			}

			if($(this).hasClass("share")){
				if($snsLayer.show()){
					$snsLayer.addClass('fix_layer');
					$snsLayer.css('top' , '50%')
					$("<div id='mask'></div>").appendTo(".ly_recent");
					$snsLayer.find('.close_sns').click(function(e){
						e.preventDefault();
						$snsLayer.removeClass('fix_layer');
					});
				} else {
					$snsLayer.removeClass('fix_layer');
					$('#mask').remove();
				}
			}
		}
	});

	$delBox.find(".cancel").on({
		click:function(e){
			e.preventDefault();
			$delBox.hide();
			$('#mask').remove();
		}
	});

	$(window).resize(function(){
		resizeViewRecent();
	});

	function onRemoveScroll(e){
		e.preventDefault();
	}
}

var lpAdBox = function(){
	//LP/SRP 포커스 광고태그 변경
	$('.best_lst.type li .q_mark').click(function(e){
		e.preventDefault();
		$(this).next('.focus_box').show();
		var $tgLi = $(this).parent().parent();
		$tgLi.addClass('on');
		var i = $tgLi.index();
		if(i % 2 == 1){
			$tgLi.prev().addClass('on');
		}
		else{
			$tgLi.next().addClass('on');
			$tgLi.find('.focus_box').css('left',0);
		}

	});

	$('.best_lst2 li .q_mark').click(function(){
		$(this).next('.focus_box').toggle();
		$(this).parent().parent().toggleClass('on');
		return false;
	});

	$('.best_lst li .close').click(function(e){
		e.preventDefault();
		$(this).parent().parent().hide();
		$('.best_lst li').removeClass('on');
	});

	$(window).resize(function(){
		var $bestList =  $('.best_lst.type li');
		var li_width = $bestList.outerWidth();
		var focus_width = ((li_width-145)/2)*2 + 290;
		$bestList.find('.focus_box').width(focus_width);
		$bestList.find('.focus_box').css('left',-focus_width+145);
		var $bestList2 =  $('.best_lst2 li');
		var li_width2 = $bestList2.outerWidth();
		$bestList2.find('.focus_box').width(li_width2);
		$bestList2.find('.focus_box').css('left',0);

		$('.best_lst.type li').each(function (i) {
			var $this = $(this);
			if(i%2 != 0 ){
				if($this.find(".best_tit").size()<1){
					$this.prev("li").find(".q_mark").css('left',focus_width-15).addClass("right");

				}
			}
		});
	});
	$(window).trigger("resize");
}

// 메인 슈퍼딜배너
function mainSuperDeal(){
	var boxWidth = $('.lst_prd > li.first .bx_prd').width()
	var boxHeight = $('.lst_prd > li.first .bx_prd').height()
	$('.lst_prd > li .bx_prd.bx_banner').css('height',boxHeight);
	$('.super_deal .ty2 a').css('height',(boxHeight-54)/2);
	$('.super_deal .ty4 a').css('height',boxHeight-48);
	$('.super_deal .ty2 li,.super_deal .ty4 li').css('width',(boxWidth-20)/2);
	$('.super_deal .ty5 li').css('height',(boxHeight-56)/2);
	$('.super_deal .ty6 li').css('height',boxHeight-60);

	$('.super_deal .ty1 a img, .super_deal .ty3 a img').each(function(){
		var eachImgHeight = $(this).height()
		$(this).css('margin-top',-eachImgHeight/2);
	})
}
var superDealCate = function(){
	if($(".sdeal_cate").length == 0) return;
	$(window).on("resize orientationchange", function(){
		setTimeout(function() {$(".superdeal_lazy").trigger("scroll"); }, 500);
	});

	$('.sdeal_cate .lst_cate').each(function(){
		var boxW = 0,liW = 0;
		$(this).find('li').each(function(){
			liW = $(this).width();
			boxW += liW;
		})
		$(this).css('width', boxW + 28);
	})
	var myScroll = new Array();
	$('.sdeal_cate').each(function(i){
		$(this).attr('id', 'sdScroll'+i)

		var sID = $(this).attr('id');
		myScroll.push(new  iScroll(sID , {  vScroll:false, hScrollbar: false, vScrollbar: false,  hideScrollbar:true, checkDOMChanges: true}));
	})
	if($(".super_deal_sub").length == 0) return;
	if($(".subtab_wrap").length == 0){
		$('.super_deal .sub_cate').css('height' , '62px');
	}else{
		$('.super_deal .sub_cate').css('height' , '100px');
	}

	var refreshTab = function(target, scroll_menu) {
		if (scroll_menu !== undefined) {
			var target;
			var $ul = target.parent("ul");
			var w=0;
			var idx;
			target.each(function() {
				if($(this).hasClass("selected")) idx = $(this).index();
				w+=$(this).outerWidth(true);
			});

			var btnsW = 0;
			var btnAll = $('#supdTab').find('button').each(function() {
				btnsW += $(this).outerWidth(true);
			});

			if (target != undefined) {
				var innerW = parseInt($(window).innerWidth()) - btnsW;
				var ulW =  $ul.outerWidth(true);
				var $curMenu = $ul.find("li").eq(idx);
				var cur_Padding = parseInt($curMenu.css('padding-left'));
				var curPos =($curMenu.position().left-cur_Padding) +  ($curMenu.outerWidth(true)/2);
				var centerPos = curPos*-1 + (innerW/2);
				var wmax = -1*($ul.outerWidth(true) - innerW + 40) ;
				var tg;
				if(centerPos <=wmax )	{
					tg = wmax;
				}
				else if(centerPos>=0){
					tg = 0;
				}
				else{
					tg = centerPos;
				}

				setTimeout(function(){
					scroll_menu.scrollTo(tg,0,200);
				},300);
			}
		}
	}
	refreshTab($('.super_deal .sdeal_cate_v2 .lst_cate li'), myScroll[0]);
	refreshTab($('.super_deal .sdeal_cate_sub .lst_cate li'), myScroll[1]);

	var nTop;
	$(window).scroll(function(e){
		var sTop = $(document).scrollTop();
		var subCate = $('.super_deal .sub_cate').offset().top - 46;
		var subCateLy = $('.super_deal .ly_sub');
		var subtabWrap = $('.super_deal .subtab_wrap');
		if(sTop > 0){
			if (nTop < sTop) {
				subtabWrap.stop().animate({'opacity' : '0'},100);
			}else{
				subtabWrap.stop().animate({'opacity' : '1'},100);
			}
			nTop = sTop;
			if(sTop > subCate){
				subCateLy.addClass('ly_sub_fix');
			}else{
				subCateLy.removeClass('ly_sub_fix');
				subtabWrap.stop().animate({'opacity' : '1'},100);
			}
		}
	});
}
var superDealBtn = function(){
	var domPos = $('.super_deal .sdeal_cate_v2 .lst_cate');
	var scPos;
	$('.super_deal .sub_cate .btn_more').click(function(){
		scPos = domPos.css('transform');
		$("<div class='dimmed'></div>").appendTo(".super_deal");
		$(this).parents('.sub_cate').addClass('sub_cate_ly');
		$('.super_deal .sub_cate .subtab_wrap').css('position' , 'absolute');
		$('body').bind('touchmove', function(e){e.preventDefault();});
	});
	$('.super_deal .sub_cate .btn_clse').click(function(){
		$(".dimmed").remove();
		$(this).parents('.sub_cate').removeClass('sub_cate_ly');
		$('.super_deal .sdeal_cate_v2 .lst_cate').css('transform',scPos);
		$('.super_deal .sub_cate .subtab_wrap').css('position' , 'static');
		$('body').unbind('touchmove');
	});
}
var superSlide = function(){
	var smartSwiper;
	if($('.super_deal .ad_area .swiper-container').size() > 0) {
		if($('.ad_area .swiper-slide').size() > 1) {
			$('.super_deal .swiper-container').each(function(){
				var $this = $(this);
				$(this).append('<div class="ad_no" style="display:none"><img src=""></div>');
				smartSwiper = new Swiper($(this), {
					slidesPerView: 'auto',
					centeredSlides: true,
					spaceBetween: 0,
					pagination: $(this).find('.swiper-pagination'),
					paginationClickable: true,
					onSlideChangeEnd: function (swiper) {
						var adNo2 = $this.find('.swiper-slide-active img').attr('ad');
						$this.find('.ad_no img').attr('src' , adNo2);
					}
				});
				var adNo = $(this).find('.swiper-slide-active img').attr('ad');
				$(this).find('.ad_no img').attr('src' , adNo);
			})
		}
		else{
			$('.ad_area').addClass('swiper_single')
		}
	}
}
var superInter = function(){
	$('<div class="ly_inter"><img src="//pics.gmarket.co.kr/mobile/img_inter_chk.png" alt=""></div>').appendTo('.super_deal');
	$('.super_deal .ly_inter').animate(
	{opacity : 1}
	, 300).delay(1000).animate(
	{opacity : 0}
	, 300, function(){$('.super_deal .ly_inter').remove();});
}


$(document).ready(function(){
	//mainSuperDeal();
	superDealCate();
	superDealBtn();
	bestDealBtn();
	superSlide();
	//$(window).resize(function(){superDealCate();});
	deptSearchDeleteCtrl(); // for departmentstore search delete btn ctrl
	dptSuperDealCateCtrl(); // for departmentstore lpsrp category iscroll

	//베스트 탭 - 서브 - 카테고리 fixed 메뉴 구현
	if($('.best_deal .sub_cate').length > 0 ){
		$('.best_deal .ly_sub').uxScrollFixedCtrl({
			'ctrlTop': 46,
			'wrapHeightNeccessary' : true,
			'reverseShow': true,
			'reverseSelector':'.best_deal .subtab_wrap'
		});
	}

	//베스트 탭 - 메인 - 카테고리 iscroll 구현
    if($('.bestdeal_cate_main').length > 0 ) {
        $('.bestdeal_cate_main').uxIscrollSlider({
            'wrapHeightNeccessary': true
        });
    }

	//베스트 탭 - 서브 - 카테고리 iscroll 구현
    if($('.bestdeal_cate').length > 0 ) {
        $('.bestdeal_cate').uxIscrollSlider({
            'ulWidthPlus': 28,
            'plusCenterwidth': 40
        });
    }

	//백화점탭 LP - 카테고리 iscroll구현
    if($('.sdeal_cate_wrap .sdeal_cate').length > 0 ) {
        $('.sdeal_cate_wrap .sdeal_cate').uxIscrollSlider({
            'ulWidthPlus': 1
        });
    }

	//백화점탭 main - 카테고리 iscroll구현
    if($('.sdeal_wrap .sdeal_cate').length > 0 ) {
        $('.sdeal_wrap .sdeal_cate').uxIscrollSlider({
            'refreshToSelectedTab': false,
            'ulWidthPlus': 1
        });
	}
});

//myG _ 타이어 장착
var tireIScroll;
var tireSetLayer = function() {
	var tireScroll = null;
	var $tstChoiceBtn = $('.option-item-tire .btn_search');
	var $tstLayer = $('.goods .etc.tire .add_cho_wrap');
	var $btnSrch = $tstLayer.find('.srch_area .btn_srch');
	var $btnCancle = $tstLayer.find('.srch_area .btn_cancle');
	var $tstSrchInp = $tstLayer.find('.input_wrap input');
	var $btnSrchDel = $tstLayer.find('.input_wrap .btn_del');
	var $btnClose = $tstLayer.find('.cls');
	var $tstLstWrap = $('.tire_result');
	var $tstLst = $tstLstWrap.find('.tstore_lst');
	var $resultHeight = $('.goods .add_cho_wrap .nec_comp_conf');

	var closeLayer = function() {
		$tstLayer.hide();
		if(tireScroll != null)	{ del_iscroll(); }
	}

	var resetResult = function() {
		$tstLstWrap.hide();
		if(tireScroll != null)	{ del_iscroll(); }
	}

	$tstChoiceBtn.click(function(e){

		e.preventDefault();
		$tstLayer.toggle();

		if($tstLstWrap.is(':visible')) {
			$tstLstWrap.hide();
		}
	});

	tireIScroll = tireSrch;
	function tireSrch(){
		$resultHeight.addClass('on');
		if(tireScroll) {
			del_iscroll();
		}
		$tstLstWrap.show();
		var $tireLstHeight = $tstLst.outerHeight();
		if($tireLstHeight >  250) {
			set_iscroll(tst_rlst);
		}
	}

	$btnCancle.click(function(e){
		$resultHeight.removeClass('on');
		e.preventDefault();
		resetResult();
	});

	$btnClose.click(function(e){
		$('#mask').remove();
		e.preventDefault();
		closeLayer();
	});

	$btnSrchDel.click(function(e){
		e.preventDefault();
		$tstSrchInp.val('');
	});

	function set_iscroll(itemId) {
		if(itemId=='' || itemId===undefined) return;
		tireScroll = new iScroll(itemId);
	}

	function del_iscroll() {
		tireScroll.destroy();
		tireScroll = null;
	}
}

$(function(){
	tireSetLayer();
});

//배너박스높이 조절
var bnrDeptHeight = function(){
	$('.bnr_dept').each(function(){
		$(this).find('li').not(".big").css('height',$(this).find('.big').height()/2);
	});
}
$(window).on("load resize orientationchange", function(){
	if(typeof $('.bnr_dept')[0] !== "undefined") {
		bnrDeptHeight();
	}
});

//반품
$(document).ready(function(){

	$('.bx_return .reason_detail a').click(function(){
		$(this).toggleClass('open');
		$(this).next('textarea').slideToggle(150);
	});
	var delvSelect = $('.tbl_rtrn_addr .bx_slt.delv select');
	$(delvSelect).focus(function(){ $(this).parent().addClass("focused"); });
	$(delvSelect).focusout(function(){ $(this).parent().removeClass("focused"); });

	$('.logis_list > li').click(function(){
		$(this).parent().find('>li').removeClass('on');
		$(this).addClass('on');
	});

	$('.bx_return .btn_rtncp').click(function(){
		if ($(this).hasClass('on') == true){
			$(this).removeClass('on');
			$(this).next('.bx_return_cp').slideUp(100);
		}else{
			$(this).addClass('on');
			$(this).next('.bx_return_cp').slideDown(100);
		}
	});
	$('.how_rtn ul').css('height',$('.how_rtn li.on .txt').height()+87);
	$('.how_rtn li').click(function(){
		$('.how_rtn li').removeClass('on');
		$(this).addClass('on');
		var contHeight = $(this).find('.txt').height();
		$(this).parents('ul').css('height',contHeight+87);
	});
	fCouponClose();
	couponSlide();
	couponLayerTab();
});
var fCouponClose = function(){
	$('.bx_return_cp').slideUp(100);
	$('.bx_return .btn_rtncp').removeClass('on');
}

//나의 계좌 체크박스 이미지 처리부분 (front.js 에서 가져옴)
function checkBoxSwitch(id){
	var idAttrSrc = $('#' + id).attr("src");
	if(idAttrSrc.indexOf('off') >=0){
		$('#' + id).attr("src", $('#' + id).attr("src").replace("_off.png", "_on.png"));
	}
	else{
		$('#' + id).attr("src", $('#' + id).attr("src").replace("_on.png", "_off.png"));
	}
}

/* coupon zone renewal */
var couponSlide = function(){
	var couponSwiper;
	if(!$('.coupon_wrap .swiper-container').size() == 0) {
		if($('.coupon_wrap .swiper-slide').size() > 1) {
			$('.swiper-container').each(function(){
				couponSwiper = new Swiper($(this), {
					slidesPerView: 'auto',
					centeredSlides: true,
					spaceBetween: 0,
					pagination: {
						el: $(this).find('.swiper-pagination'),
						type: 'bullets',
					},
					paginationClickable: true
				});
			})
		}
		else{
			$('.coupon_wrap .swiper_section').addClass('swiper_single')
		}
	}
}
var couponLayerTab = function(){
	$('.coupon_wrap .ly_cp .btn_tab').click(function(e){
		e.preventDefault();
		var tabIndex = $(this).index();
		$(this).addClass('on').siblings().removeClass('on');
		$('.ly_cp .ly_cont').eq(tabIndex).show().siblings('.ly_cont').hide();
	});
}

//백화점탭  검색어 삭제
var deptSearchDeleteCtrl = function(){
	if($('.sch_dept input[type=text] + .ip_delete').length > 0){
		var input = $('.sch_dept input[type=text]');

		input.each(function(){
			var initVal = '';
			if (typeof attr !== typeof undefined && attr !== false) {
				initVal = $(this).val();
			}

			var $this = $(this);
			var placeholderVal = $this.attr('placeholder');
			var $delBth = $this.next('.ip_delete');

			function inputInitialize(){
				$delBth.removeClass('ip_delete_active');
				$this.val('').focus();

			}

			$delBth.click(function(){
				inputInitialize();

			});

			$this.focus(function(){
				$delBth.addClass('ip_delete_active');
				if($this.val()=='' || $this.val() == placeholderVal){
					$delBth.removeClass('ip_delete_active');
				}
			}).blur(function(){
				if($this.val() == initVal){
					$delBth.removeClass('ip_delete_active');
				}
			});

			$this.keyup(function(){
				$delBth.addClass('ip_delete_active');

				if($this.val()=='' || $this.val() == initVal){
					$delBth.removeClass('ip_delete_active');
				}
			});

		});
	}
}

//백화점탭  수퍼딜 카테고리
var dptSuperDealCateCtrl = function(){
	if($(".sdeal_cate_wrap").length == 0) return;

	$('.sdeal_cate_wrap .lst_cate').each(function(){
		var boxW = 0,liW = 0;
		$(this).find('li').each(function(){
			liW = $(this).width();
			boxW += liW;
		})
		$(this).css('width', boxW + 28);
	})

	var myScroll = new Array();
	$('.sdeal_cate_wrap .sdeal_cate').each(function(i){
		$(this).attr('id', 'dptScroll'+i);
		var $this = this;
			var id = $this.id;
			$this.scrollTab = null;
			var currentX = -1;
			var $cont = $("#"+id);
			var $maxItemLI = $cont.find("li");
			var $maxItemUL = $cont.find("ul");
			var liWidth = 0;
			$maxItemLI.each(function(){
				liWidth += $(this).width();
			});
		function tab_trans_pos_check(){
				var sTop = $maxItemUL.css('transform');
				var values = sTop.split('(')[1];
				values = values.split(')')[0];
				values = values.split(',');
				tab_trans_pos = values[4];
		}
		var sID = $(this).attr('id');
		myScroll.push(new  iScroll(sID , {  vScroll:false, hScrollbar: false, vScrollbar: false,  hideScrollbar:true, checkDOMChanges: true
			, checkDOMChanges: true,
			onScrollMove : function(){
				tab_trans_pos_check();
				//console.log('move', tab_trans_pos);
				if(tab_trans_pos >= 0){
					$cont.removeClass('left');
				}else{
					$cont.addClass('left');
				}
			},
			onScrollEnd : function(){
				tab_trans_pos_check();
				console.log('end', ($cont.attr('id')),(tab_trans_pos),(($cont.width())));
				if(tab_trans_pos == 0){
					$cont.removeClass('left');
				}else{
				}
			}
		}));
	})

	var refreshTab = function(target, scroll_menu) {
		if (scroll_menu !== undefined) {
			var target;
			var $ul = target.parent("ul");
			var w=0;
			var idx;
			target.each(function() {
				if($(this).hasClass("selected")) idx = $(this).index();
				w+=$(this).outerWidth(true);
			});

			var btnsW = 0;
			var btnAll = $('.sdeal_cate_wrap').find('a').each(function() {
				btnsW += $(this).outerWidth(true);
			});

			if (target != undefined) {
				setTimeout(function(){
					scroll_menu.scrollToElement('.sdeal_cate_wrap li:nth-child('+(idx-1) +')', 100);
					scroll_menu.refresh

				},300);
			}
		}
	}
	refreshTab($('.super_deal .sdeal_cate_wrap .lst_cate li'), myScroll[0]);
}

//CPP 광고레이어
$(document).on('click', '.ct_best .btn_ad, .best_deal .btn_ad', function(e){
	e.preventDefault();
	if($(this).siblings('.ad_layer').css('display') === 'none'){
		$('.ad_area .ad_layer').removeClass('on');
		$(this).siblings('.ad_layer').addClass('on');
	}else{
		$(this).siblings('.ad_layer').removeClass('on');
	}
});
$(document).on('click','.ad_area .bt_close',function(e){
	e.preventDefault();
	$(this).parent('.ad_layer').removeClass('on');
});

var bestDealBtn = function(){
	var domPos = $('.best_deal .sdeal_cate_v2 .lst_cate');
	var scPos;
	$('.best_deal .sub_cate .btn_more').click(function(){
		scPos = domPos.css('transform');
		$("<div class='dimmed'></div>").appendTo(".best_deal");
		$(this).parents('.sub_cate').addClass('sub_cate_ly');
		$('.best_deal .sub_cate .subtab_wrap').css('position' , 'absolute');
		$('body').bind('touchmove', function(e){e.preventDefault();});
	});
	$('.best_deal .sub_cate .btn_clse').click(function(){
		$(".dimmed").remove();
		$(this).parents('.sub_cate').removeClass('sub_cate_ly');
		$('.best_deal .sdeal_cate_v2 .lst_cate').css('transform',scPos);
		$('.best_deal .sub_cate .subtab_wrap').css('position' , 'static');
		$('body').unbind('touchmove');
	});
}

/* footer */
var footerInfo = function(){
	$('#foot .info_area .btn_info').click(function(e){
		e.preventDefault();
		if($('#foot .info_area').hasClass('info_on')){
			$('#foot .info_area').removeClass('info_on');
		}else{
			$('#foot .info_area').addClass('info_on');
			$('html, body').animate({scrollTop : $(document).height()}, 1500)
		}
	});
}

$(document).on("click", ".btn_gvip_top", function(e) {
	e.preventDefault();
	myItemScroll.scrollTo(0, 0, 0);
});

$(document).on("click", ".item_info_card .favor", function(e) {
	e.preventDefault();
	if($(this).hasClass("on")) {
		$(this).removeClass("on");
		$(this).text("관싱삼품 On");
		$('.goods .ly_inter_vip').remove();
	}
	else {
		$(this).addClass("on");
		$(this).text("관싱삼품 Off");
		$('<div class="ly_inter_vip"><img src="//pics.gmarket.co.kr/mobile/img_inter_chk.png" alt=""></div>').appendTo('.goods');
		$('.goods .ly_inter_vip').animate({opacity : 1}, 300).delay(1000).animate({opacity : 0}, 300);
	}
});

$(document).on("click", ".gvip_layer_wrap .btn_top", function(e) {
	e.preventDefault();
	myItemScroll.scrollTo(0, 0, 0);
});

/* Group VIP 상세 보기 레이어 */

var gvip_layer_swiper = null
var myItemScroll = null;
var myThumbnailScroll = null;

$(document).ready(function(e) {
	if($(".gvip_layer_wrap").length > 0) {
		GroupVIPDetailLayer.InitSwiper();
		$('.gvip_layer_wrap .button__top').on('click', function(){
			$('#gvip_layer_content2').css({"transform":"translate(0,0)"})
		});
	}
});

GroupVIPDetailLayer = {
	CloseLayer : function() {
		var $layerPopupObj = $('.layer_detail_items');
		$("#head.new.vip").removeClass("head_new_groupvip");
		$(".gvip_layer_wrap .btn_gvip_top").hide();
		// $layerPopupObj.hide();
		$layerPopupObj.removeClass('on');
		$layerPopupObj.next('.dimmed').fadeOut(500,function(){
			$(this).remove();
		})
		$("#footer_back").css("z-index", "100");
		if(top_title_swiper && top_title_swiper.activeIndex > 0) top_title_swiper.slideTo(0);
	}, //CloseLayer
	OpenLayer : function() {
		event.preventDefault();
		event.stopPropagation();
		var $layerPopupObj = $('.layer_detail_items');
		var height = $(window).height();
		var zindex = $(".buy_option_wrap").css("z-index");
		var $dimmedHtml = '<div class="dimmed" style="display:none"></div>';
		$layerPopupObj.after($dimmedHtml);
		$layerPopupObj.next('.dimmed').fadeIn(300);
		// $("#head.new.vip").addClass("head_new_groupvip");
		$(".gvip_layer_wrap .btn_gvip_top").show();
		$layerPopupObj.addClass('on');
		$("#footer_back").css("z-index", zindex);

	}, //OpenLayer
	InitSwiper : function() {
		myItemScroll = null;
		myItemScroll = new iScroll("gvip_layer_content" , { vScroll:true, hScrollbar: true, vScrollbar: true, hScroll:true,  hideScrollbar:false, checkDOMChanges: true, bounce:true, freeModeMomentum:false, freeModeMomentumBounce:false, freeModeMomentumBounceRatio:0
			, zoom: true
			, onZoomEnd: function(e) {
				if(parseInt(this.scale) == 1) {
				  gvip_layer_swiper.unlockSwipes();
				  $("#gvip_layer_content2 #swiper-container").css("touch-action", "auto");
				} else {
				  gvip_layer_swiper.lockSwipes();
				  $("#gvip_layer_content2 #swiper-container").css("touch-action", "none");
				}
			}
			, onZoomStart: function(e) {
				if(e.type === 'touchstart') {
				  this.originX = Math.abs(e.touches[0].pageX + e.touches[1].pageX) / 2 - this.x;
				} else if(e.type === 'touchend') {
				  this.wrapperOffsetLeft = 0;
				}
		   },
		   onScrollEnd: function(){
				var scrollState = parseInt($('#gvip_layer_content2').css('transform').split(',')[5]);
				if(!scrollState){
					$('.gvip_layer_wrap--additional .top_thumbnail').removeClass('top_thumbnail--active')
				}else{
					$('.gvip_layer_wrap--additional .top_thumbnail').addClass('top_thumbnail--active')
				}
			}
			,onBeforeScrollStart : function(e){
				var target = e.target;
				if(target.className != "item_name" && target.tagName.toLowerCase() != "td" && target.className != "table_area2") {
					e.preventDefault();
				}
			}
		});
		$("#gvip_layer_content").css("height", $(window).outerHeight() - 108 + 55);
	}, //InitSwiper
	InitThumbnailSlide: function(idx) {
		$('.thumbnail_cate .lst_cate').each(function(){
			var boxW = 0,liW = 0,padW = 0;
			$(this).find('li').each(function(){
				liW = $(this).width();
				padW = parseInt($(this).css("padding-left"), 10) + parseInt($(this).css("padding-right"), 10);
				boxW += liW + padW;
			})
			$(this).css('width', boxW);
		})
		myThumbnailScroll = null;
		myThumbnailScroll = new  iScroll("sdScroll0" , {  vScroll:false, hScrollbar: true, vScrollbar: false,  hideScrollbar:true, checkDOMChanges: true, bounce:false})

		$(".thumbnail_list .lst_cate li").unbind("click").bind("click", function(e) {
			e.preventDefault();
			e.stopPropagation();
			$(".thumbnail_list .lst_cate li").removeClass("selected");
			$(this).addClass("selected");
			refreshTab($('.thumbnail_cate .lst_cate li'), myThumbnailScroll);
		    setTimeout(function() {
			  window.scrollTo(0, 1);
		    }, 200);
		});

		if($(".subtab_wrap").length == 0){
			$('.thumbnail_list .thumbnail_sub').css('height' , '62px');
		}else{
			$('.thumbnail_list .thumbnail_sub').css('height' , '100px');
		}

		var nTop;
		$(window).scroll(function(e){
			var subCate = $('.thumbnail_list .thumbnail_sub').offset().top - 46;
			var subCateLy = $('.thumbnail_list .ly_sub');
			var subtabWrap = $('.thumbnail_list .subtab_wrap');
			var sTop = $(document).scrollTop();
			if (nTop <  sTop) {
				subtabWrap.stop().animate({'opacity' : '0'},100);
			}else{
				subtabWrap.stop().animate({'opacity' : '1'},100);
			}
			nTop = sTop;
			if(sTop > subCate){
				subCateLy.addClass('ly_sub_fix');
			}else{
				subCateLy.removeClass('ly_sub_fix');
				subtabWrap.stop().animate({'opacity' : '1'},100);
			}
		});

		if(idx >= 0) {
			$(".thumbnail_list .lst_cate li").removeClass("selected");
			$(".thumbnail_list .lst_cate li").eq(idx).addClass("selected");
			refreshTab($('.thumbnail_cate .lst_cate li'), myThumbnailScroll);
		}
	}, //InitThumbnailSlide
	InitTopTitleSwiper: function() {
		top_title_swiper = new Swiper('.top_title .swiper-container', {
			direction:"vertical",
			autoplay : false,
			autoHeight: true,
			onInit: function(swiper) {
			}
		});
	}, //InitTopTitleSwiper
	InitMainItemSwiper: function(onSlideNextEndCb, onSlidePrevEndCb) {
		if(gvip_layer_swiper == null)
		{
//			$(".gvip_layer_content .gvip_layer_body").empty();
			gvip_layer_swiper = new Swiper('.gvip_layer_content .swiper-container', {
				autoplay : false,
				autoHeight: false,
				calculateHeight: false,
				threshold : 50,
				followFinger:false,
				nextButton: "#next",
				prevButton: "#prev",
				onInit: function(swiper) {
				},
				onSlideNextEnd: function(swiper) {
					if(onSlideNextEndCb !== undefined && typeof onSlideNextEndCb === 'function') {
						onSlideNextEndCb();
					}
				},
				onSlidePrevEnd: function(swiper) {
					if(onSlidePrevEndCb !== undefined && typeof onSlidePrevEndCb === 'function') {
						onSlidePrevEndCb();
					}
				},
				onSlideChangeEnd: function(swiper) {
//					refreshTab($('.thumbnail_list .thumbnail_cate .lst_cate li'), myThumbnailScroll);
				}
			});
		}
	}, //InitMainItemSwiper
	SetSlideChangeEnd: function(currentPos, totalCount) {
		$(".thumbnail_cate .lst_cate li").removeClass("selected");
		$(".thumbnail_cate .lst_cate li:eq(" + (currentPos) + ")").addClass("selected");

		refreshTab($('.thumbnail_cate .lst_cate li'), myThumbnailScroll);
		top_title_swiper.slideTo(currentPos);

		if(currentPos <= 0) $("#prev").addClass("disabled");
		else $("#prev").removeClass("disabled");

		if(currentPos >= totalCount - 1) $("#next").addClass("disabled");
		else $("#next").removeClass("disabled");

		setTimeout(function() {
			GroupVIPDetailLayer.GetItemSlideHeight(currentPos);
			myItemScroll.scrollTo(0, 0, 0);
	    }, 300);
	}, //SetSlideChangeEnd
	GetItemSlideHeight: function(pos) {
		var $activeSlide = $("#iSlide" + pos);
		var baseHeight = $activeSlide.find(".item_info").height() + $activeSlide.find(".item_info_detail").height() + $activeSlide.find(".prod_info#safe_info").height() + $activeSlide.find(".prod_info#item_add_info").height() + 170;
		$("#iSlide"+pos).css("height", baseHeight + "px");
		$("#gvip_layer_content2").css("height", $("#iSlide"+pos).outerHeight()+ "px");
		myItemScroll.refresh();
	}, //GetItemSlideHeight
	DisplayLayerGVip: function(targetId, tabId, currentPos) {
 		var target = $("#" + targetId);
		var tab = $("#" + tabId);
		var tab_btn_dtl = $("#" + tabId + " > .btn_dtl");

		if (!target.is(':visible')) {
			target.show()
			tab.addClass("on");
			tab_btn_dtl.addClass("on");

			var tab_offset = $("#" + tabId).offset();
			$(window).scrollTop(tab_offset.top - 49);
		} else {
			tab.removeClass("on");
			tab_btn_dtl.removeClass("on");
			target.hide()
		}

		setTimeout(function() {
			GroupVIPDetailLayer.GetItemSlideHeight(currentPos);
		}, 200);
	}
}

function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

var refreshTab = function(target, scroll_menu) {
	if (scroll_menu !== undefined) {
		var target;
		var $ul = target.parent("ul");
		var w=0;
		var idx;
		target.each(function() {
			if($(this).hasClass("selected")) idx = $(this).index();
			w+=$(this).outerWidth(true);
		});

		var btnsW = 0;

		if (target != undefined) {
			var innerW = parseInt($(window).innerWidth());
			var ulW =  $ul.outerWidth(true);
			var $curMenu = $ul.find("li").eq(idx);
			var cur_Padding = parseInt($curMenu.css('padding-left'));
			var curPos =($curMenu.position().left) +  ($curMenu.outerWidth(true)/2);
			var centerPos = curPos*-1 + (innerW/2);
			var wmax = -1*($ul.outerWidth(true) - innerW) ;
			var tg;

			if(centerPos <=wmax )	{
				tg = wmax;
			}
			else if(centerPos>=0){
				tg = 0;
			}
			else{
				tg = centerPos;
			}

			setTimeout(function(){
				scroll_menu.scrollTo(tg,0,200);
			},200);
		}
	}
}

/* // Group VIP 상세 보기 레이어 */

/* ktshop 전체요금제 레이어 */
var ktshopScroll = null;
var prevAwardScroll = null;

KtshopDetailLayer = {
	// 레이어 닫기
	CloseLayer : function() {
		var $layerPopupObj = $('.ktshop_detail_wrap');
		$layerPopupObj.removeClass('on');
		$layerPopupObj.next('.dimmed').fadeOut(500,function(){
			$(this).remove();
		})
	},
	// 레이어 열기
	OpenLayer : function(event) {
		event.preventDefault();
		event.stopPropagation();
		var $layerPopupObj = $('.ktshop_detail_wrap');
		var $dimmedHtml = '<div class="dimmed" style="display:none"></div>';
		$layerPopupObj.after($dimmedHtml);
		$layerPopupObj.next('.dimmed').fadeIn(300);
		$layerPopupObj.addClass('on');
		if ($("#detail_content").length>0) ktshopScroll.scrollTo(0, 0); // 팝업열 때 iscroll 항상 맨위로 가게함
		this.iscrollHeight; // 팝업열 때 iscroll 높이 체크

		// 팝업열 때 스와이프 처음 슬라이드로 이동
	},
	// iscroll 초기화
	InitSwiper : function() {
		ktshopScroll = null;
		prevAwardScroll = null;
		if ($("#ktshop_layer_content").length>0) {
			ktshopScroll = new iScroll("ktshop_layer_content" , {
			vScroll:true,
			hScrollbar: true,
			vScrollbar: true,
			hScroll:true,
			hideScrollbar:false,
			checkDOMChanges: true,
			bounce:true,
			freeModeMomentum:false,
			freeModeMomentumBounce:false,
			freeModeMomentumBounceRatio:0
			}); // iscroll 생성
		}
	},
	KtshopDetailSwiper : function() {
		KtshopDetailSwiper = new Swiper('.ktshop_detail_wrap .swiper-container', {
			loop: false,
			autoplay: false,
			speed: 300,
			threshold:50,
			onSlideChangeEnd: function(swiper) {
				var layer_wrap = $(".ktshop_detail_wrap")
				var active_sw_idx = layer_wrap.find(".swiper-slide.swiper-slide-active").index();
				var active_sw_height = layer_wrap.find(".swiper-slide.swiper-slide-active .content_area").outerHeight()
				$(".ktshop_detail_wrap .lst_cate li").removeClass("on")
				$(".ktshop_detail_wrap .lst_cate li").eq(active_sw_idx).addClass("on")
				$(".ktshop_layer_content2").css("transform","tra0nslateY(0)")
				KtshopDetailLayer.swHeight()
			}
		}); // swiper 생성함수
	},
	swHeight : function(){
		var active_obj = $(".ktshop_detail_wrap .swiper-slide-active")
		var active_obj_height = active_obj.find(".content_area").outerHeight();
		$(active_obj).css("height",active_obj_height)
		$(".ktshop_layer_content2").css("height",active_obj_height)
	}
}

var KtshopDetailLayer_cate = function (idx){
	if(!$(this).hasClass("disabled")){
		KtshopDetailSwiper.slideTo(idx)
	}
}

/* //ktshop 전체요금제 레이어 */

// ktshop agree layer
var ktshop_agree_layer_open = function (target){
	var $dimmedHtml = '<div class="dimmed" style="display:none"></div>';
	if(target === "agree_info1"){
		var $layer_wrap = $("#agree_info1")
	}else if(target === "agree_info2"){
		var $layer_wrap = $("#agree_info2")
	}
	$layer_wrap.after($dimmedHtml);
	$layer_wrap.show();
	$layer_wrap.next('.dimmed').fadeIn(300);
}

var ktshop_agree_layer_cls = function (){
	var $layer_wrap = $(".agree_layer_wrap")

	$layer_wrap.hide();
	$layer_wrap.next('.dimmed').fadeOut(300);
	$layer_wrap.next('.dimmed').remove();
}

//ktshop bottomoption
var ktshop_btmotp = function(){
	var otp_layer = $(".vip_option_layer");
	var otp_layer_wrap = $(otp_layer).find(".ly_scroll_wrap");
	var otp_layer_price = $(otp_layer).find(".price_lst");
	var otp_layer_obj = $('.vip_ktshop .add_option input,.vip_ktshop .add_option textarea');
	otp_layer_obj.focus(function(){
		$(otp_layer_price).hide();
		$(otp_layer_wrap).css("height","275px");
	});
	otp_layer_obj.blur(function(){
		$(otp_layer_price).show();
		$(otp_layer_wrap).removeAttr("style");
	});
}

// Group Vip Tab iScroll
var gVipTabScroll = function(){
    if($("#content.g_vip").length == 0 || $('#wrap.vip_smiledel').length) return;
	var tab_trans_pos;
	function tab_trans_pos_check(){
		var sTop = $('#vipTabScroll ul').css('transform');
		var values = sTop.split('(')[1];
		values = values.split(')')[0];
		values = values.split(',');
		tab_trans_pos = values[4];
	}
	var boxW = 0,liW = 0;
    $('#vipTabScroll ul li').each(function(){
		liW = $(this).width();
		boxW += liW;
	});
    var $scrollTab = $('#vipTabScroll ul');
    $scrollTab.css('width',$(window).width()/1.1);
	var scrollTabRight = -($scrollTab.width()-$("#vipTabScroll").width());
	vipScroll = new iScroll('vipTabScroll', {
		vScroll: false,
		hScrollbar: false,
		vScrollbar: false,
		hideScrollbar: true,
		checkDOMChanges: true,
		bounce: false,
        onScrollEnd : function(){
            tab_trans_pos_check();
            if(tab_trans_pos == 0){
                $('.vip_tab_nav').removeClass('left');
                $('.vip_tab_nav').addClass('right');
            }else if(tab_trans_pos == scrollTabRight){
                $('.vip_tab_nav').addClass('left');
                $('.vip_tab_nav').removeClass('right');
            }
        }
	});

	$("#vipTabScroll ul li").unbind("click").bind("click", function(e) {
		e.preventDefault();
		$("#vipTabScroll ul li").removeClass("selected");
		$(this).addClass("selected");
		refreshTab($('#vipTabScroll ul li'), vipScroll);
		setTimeout(function() {
		  window.scrollTo(0, 1);
		}, 200);
	});

	var refreshTab = function(target, scroll_menu) {
		if (scroll_menu !== undefined) {
			var target;
			var $ul = target.parent("ul");
			var w=0;
			var idx;

			target.each(function() {
				if($(this).hasClass("selected")) idx = $(this).index();
				w+=$(this).outerWidth(true);
			});

			var btnsW = 0;
			var btnAll = $('#supdTab').find('button').each(function() {
				btnsW += $(this).outerWidth(true);
			});

			if (target != undefined) {
				var innerW = parseInt($(window).innerWidth()) - $(".btn_opt_view span").outerWidth(true);
				var ulW =  $ul.outerWidth(true);
				var $curMenu = $ul.find("li").eq(idx);
				var cur_Padding = parseInt($curMenu.css('padding-left'));
				var curPos =($curMenu.position().left-cur_Padding) +  ($curMenu.outerWidth(true)/2);
				var centerPos = curPos*-1 + (innerW/2);
				var wmax = -1*($ul.outerWidth(true) - innerW + 40) ;
				var tg;
				if(centerPos <=wmax )	{
					tg = wmax;
				}
				else if(centerPos>=0){
					tg = 0;
				}
				else{
					tg = centerPos;
				}

				setTimeout(function(){
					scroll_menu.scrollTo(tg,0,200);
				},300);
			}
		}
	}
	//refreshTab($('#vipTabScroll ul li'), vipScroll);
}

$(function(){
	//배송예고제 레이어 show/hide
    $(document).on('click','.delivery-noti .questicon',function(e){
        e.preventDefault();
        var $this = $(this);
        var boxH = $this.parents('.delivery-noti').innerHeight();
        $(this).toggleClass('active').next('.ly_delset_info').toggleClass('active').css('top',boxH);
        $('.delivery-noti .bt_close').on('click',function(e){
            e.preventDefault();
            $(this).parent('.ly_delset_info').removeClass('active');
            $this.removeClass('active');
        });
	});

	//배송예고제 레이어 개편 show/hide
	$(document).on('click','.delivery-noti .button__detail',function(e){
        e.preventDefault();
        var $this = $(this);
        $(this).next('.box__detail').toggleClass('box__detail--active');
        $('.delivery-noti .box__detail .button__closed').on('click',function(e){
            e.preventDefault();
            $(this).parent('.box__detail').removeClass('box__detail--active');
        });
	});

    //해피포인트 추가 혜택 안내
    $(document).on('click','.benefit-slidings .slide_btn',function(e){
        e.preventDefault();
        var $this = $(this);
        var $li = $this.parent('li');
        var $siblingLi = $li.siblings();
        var $con =  $this.next('ul');
        $siblingLi.removeClass('on');
        $li.toggleClass('on');
    });

    //dimmed layer - used : G9 mypage exchangelayer
    $(document).on('click','.bt_uxdimmedctrl',function(e){
		e.preventDefault();
		var $this = $(this);
		var $layer = $($this.attr('href'));
		var $dimmed = '<div class="uxdimmed"></div>';
		$layer.show().attr('tabindex','0').focus();
		$('#wrap').append($dimmed);
		var $closeCtrl = $layer.find('.bt_close').add('.uxdimmed');
		$closeCtrl.on('click',function(e){
			e.preventDefault();
			$layer.hide();
			$('.uxdimmed').remove();
			$this.focus();
		})
	});

    //여행탭 메인 - topbanner :: swiper.js
	var traveTabBannerImgCount = $('#travel-topbanner li').length;
	var TravelTab = {
		InitSwiper : function(){
			if($('#travel-topbanner .swiper-container').length > 0){
                $('#travel-topbanner .swiper-container').swiperSet({
                    nextControl : true,
                    prevControl : true,
                    pageControl : true,
                    loop : (traveTabBannerImgCount > 1),
                    paginationType: "fraction",
                    onInit :  function(swiper) {
                        if(swiper.slides.length == 1) {$('.swiper-pagination').hide();
                        }
                    },
                });
			}
		}
	}

	TravelTab.InitSwiper()

	//여행탭 메인개편 :: swiper.js
	var $slider = $("#travel_tab_slide .travel-slide");
	var TravelTabSlider = {
		InitSwiper : function(){
            if($slider.length > 0 ) {
                $slider.swiperSet({
                    slidesPerView: "auto",
                    centeredSlides: true,
                    pageControl : true,
                    loop : true,
                    observer: true,
                    pagination: $slider+" .swiper-pagination",
                    paginationClickable: true,
                    onInit : function(swiper) {
						var InitialSlide = $slider.attr('data-initial');
						swiper.slideTo(InitialSlide, 0)
                        var names = [];
                        var total = $slider.find(".swiper-pagination span").length;
                        tabName();
                        $( window ).resize(function() {
                            tabName();
                        });
                        function tabName() {
                            setTimeout(function(){
                                $slider.find(".swiper-slide").each(function(i) {
                                    names.push($(this).data("name"));
                                });
                                for(var i=0;i <= total;i++){
                                    $slider.find(".swiper-pagination").find("span").eq(i).append("<em>"+names[i]+"</em>");
                                }
                            }, 10);
                        }
                        if(swiper.slides.length == 1) {
                            $("#travel_tab_slide .swiper-pagination").hide();
                        }
                    },
                });
            }
		}
	}

	//슬라이드 내 tab js
	$("#content.travel .js_tab").each(function() {
		var $mCont = $("#content.travel .slide_tab_in .m_contents");
		var $list = $(this).find("button");
		$list.on("click", function() {
			var $data = $(this).attr("data-tab");
			$list.removeClass("active");
			$(this).addClass("active");
			$("#content.travel div[data-contents='"+$data+"']").siblings().removeClass("active");
			$("#content.travel div[data-contents='"+$data+"']").addClass("active");
		})
	})
	//여행 탭 메인 상품 slide
	var TravelItem = {
		InitSwiper : function(){
            if($('.travel_sub .swiper-container').length > 0 ) {
                $('.travel_sub .swiper-container').swiperSet({
                    slidesPerView: 'auto',
                    centeredSlides: true,
                    loop: true
                });
            }
		}
	}
	TravelTabSlider.InitSwiper();
	TravelItem.InitSwiper();

	//여행 추천카테고리 상품 slide
	/* 개발이슈 때문에 front에서 노출
	var recommendItem = {
		InitSwiper : function(){
			$('.rec_item_list .swiper-container').swiperSet({
				slidesPerView: 'auto',
				centeredSlides: true,
				pageControl : true,
				loop : true,
				pagination: '.swiper-pagination',
				paginationClickable: true,
				onInit : function(swiper) {
					if(swiper.slides.length == 1) {
						$('.swiper-pagination').hide();
					}
				}
			});
		}
	}
	recommendItem.InitSwiper();
	*/

	//CPC
	$(document).on('click','.ad_infobox_btn',function(e){
		e.preventDefault();
		var $target = $(this).parent().find('.ly_adinfo-tooltip');
		$target.toggle();
		$target.find('.btn_close').click(function(e){
			e.preventDefault();
			$target.hide();
		})
	});

    $(document).on('click','.ly_cancel_smiledev .btn_close',function(){
        $(this).parents('.ly_cancel_smiledev').hide();
    });

	//ktshop bottomoption
	ktshop_btmotp();

});

/* Main - Smile Day */
window.mainSmileDay = (function(){
	var method ={};
	var member ={};
	method.init = function(){
		method.setElements();
		method.bindEvents();
		method.initLayOut();
		method.scrollFunc();
	};
	method.setElements = function(){
		member.bannerWrap = $('.smileday_main_banner');
		member.toggleWrap = member.bannerWrap.find('span');
		member.bannerBadge = $('.smileday_icon_banner');
		member.floatBadge = $('.box__sponsor-floating');
	};
	method.bindEvents = function(){
		if(!member.bannerWrap.hasClass('active')){
			member.toggleWrap.on('click', method.bannerToggleFunc);
		}
	};
	method.initLayOut = function(){
		member.bannerWrap.addClass('once');
	};
	method.scrollDone = function(){
		var scrollTop = $(window).scrollTop();
		var bannerTop = member.bannerWrap.offset().top;
		if(scrollTop < 10){
			member.bannerWrap.addClass('once');
			method.bannerCloseFunc();
		}else if(member.bannerWrap.hasClass('once')){
			member.bannerWrap.removeClass('once');
			method.bannerOpenFunc();
		};
		if(scrollTop < bannerTop - 100){
			member.bannerBadge.fadeOut();
			member.floatBadge.animate({'bottom': '64px'});
		}else{
			member.bannerBadge.fadeIn();
			member.floatBadge.animate({'bottom': '131px'});
		}
	};
	method.scrollFunc = function(){
		var timer = null;
		$(window).on('scroll',function(){
			clearTimeout(timer);
			timer = setTimeout(method.scrollDone,100);
		});
	};
	method.bannerToggleFunc = function(){
		if(member.bannerWrap.hasClass('active')){
			method.bannerCloseFunc();
		}else{
			method.bannerOpenFunc();
		}
	};
	method.bannerOpenFunc = function(){
		member.bannerWrap.addClass('active');
	};
	method.bannerCloseFunc = function(){
		member.bannerWrap.removeClass('active');
	};
    method.badgeOnlyFunc = function(){
        method.setElements();
        $(window).on('scroll', function(){
            var scrollTop = $(window).scrollTop();
            if(scrollTop < 100){
                member.bannerBadge.fadeOut();
            }else{
                member.bannerBadge.fadeIn();
            }
        });
    };
	return{
        init : method.init,
        badgeOnlyFunc : method.badgeOnlyFunc
	}
})();

var EBAY = {
    UI: {
        SMILEDELIVERY: {
            COMMON: {},
            HOME: {},
            LP: {},
            SRP: {},
            UTIL: {},
			VIP : {}
        },
	COMMON: {
        	LAYER : {}
	},
	CART : {

	}
    }
};

$(document).ready(function () {
    // 스마일배송 전용 헤더 검색창 열지 말지 결정
    if ($("body.sd_srp").length > 0) {
		$("#head.smiledelivery .btn_search").hide();
		$(".smiledelivery_search_box").show();
	}
    else {
		$("#head.smiledelivery .btn_search").show();
		$(".smiledelivery_search_box").hide();
	}

	// 상품 템플릿 관심상품 클릭 시
	/*
	// 개발팀 요청으로 이벤트 제거
    $(".element-info .element-info-favorite").unbind("click").bind("click", function () {
        if ($(this).hasClass("on"))
            $(this).removeClass("on");
        else
			$(this).addClass("on");

		EBAY.UI.SMILEDELIVERY.COMMON.favoriteIcon.toggleAction(this);
	});
	*/
    // 옵션 레이어 및 카트 게이지 레이어 호출
    if ($('button.element-info-cart').length > 0) {
		EBAY.UI.SMILEDELIVERY.COMMON.smileDelOtpLyInter.init();
	}

	/* 스마일배송 홈탭 메인 배너 이미지 Clipping */
	if($("#head.head_main").length > 0) {
		$(".smiledelivery-mainbanner .swiper-container .swiper-slide").each(function(index) {
			var imgW = $(this).find("img").width()
			, imgH = $(this).find("img").height()
			, newImgH = Math.ceil(imgW / 4) * 3
			, marginH = (imgH - newImgH) / 2;

			if(marginH < 0) return;

			$(this).find("a").find("img").css("margin-top", (-1)*marginH+"px");
			$(this).find("a").find(".banner_title").css("margin-top",(-1)*marginH+"px");
		});
	}
	// Main - SmileDay
	if($('.smileday_main_banner').length > 0){
		mainSmileDay.init();
	}else if(!$('.smileday_main_banner').length && $('.smileday_icon_banner').length){
		mainSmileDay.badgeOnlyFunc();
	};
});

EBAY.UI.SMILEDELIVERY.COMMON.favoriteIcon = (function() {
	var method = {};

	method.toggleAction = function(obj) {
		if ($(obj).hasClass("on")) {
			$(obj).text("관심상품 등록됨, 등록 해제 버튼");
            $('<div class="ly_inter"><embed src="//pics.gmarket.co.kr/mobile/single/kr/common/heart_toast.svg" type="image/svg+xml"></div>').appendTo('#content');
			$('#content .ly_inter').animate({ opacity: 1 }, 300).delay(1000).animate({ opacity: 0 }, 300,function(){
                $('#content .ly_inter').remove();
			});
        }
        else {
			$(obj).text("관심상품 등록되지 않음, 등록 버튼");
			$('#content .ly_inter').remove();
        }
	};

	return {
		toggleAction: method.toggleAction
	};
})();

EBAY.UI.SMILEDELIVERY.COMMON.SetSmileDeliverySearchResultSet = (function () {
	var favorite_keyword_list_width = 0;
    var favorite_keyword_list = $(".favorite_srch_keyword_list ul");

    var headerHeight = $("#head.smiledelivery").outerHeight;

	if($(".favorite_srch_keyword_list").length > 0)
	{
		favorite_keyword_list.find("li").each(function () {
			favorite_keyword_list_width = favorite_keyword_list_width + $(this).outerWidth() + 6;
		}).delay(200);
		favorite_keyword_list_width = favorite_keyword_list_width + 12 + 10;

		setTimeout(function() {
			$(".favorite_srch_keyword_list ul").css("width", favorite_keyword_list_width + "px").css("height", "30px");
			$(".favorite_srch_keyword_list").css("width", window.innerWidth + "px");
		}, 800);

        $(".favorite_srch_keyword_list").scrollLeft(0);
	}

	if($(".smiledelivery_section_srch").length > 0) {
		var search_box_height = window.innerHeight - $("#simple_header.smiledelivery_search").height();
        if(!$('.vip_top_banner').length){
            $(".smiledelivery_section_srch").css("height", search_box_height + "px");
        }else{
            $(".smiledelivery_section_srch").css({
				"top" : 104 + "px",
				"height" : (search_box_height - 50 ) + "px"
            });
        }
    }

    if ($(".smiledelivery_recent_srch_keyword li.blank").length > 0)
		$(".smiledelivery_recent_srch_keyword li.blank").css("height", (window.innerHeight - ($("#simple_header.smiledelivery_search").height() + $(".smiledelivery_favorite_srch_keyword").outerHeight() + $(".smiledelivery_recent_srch_keyword li.title").outerHeight())) + "px");

	$(".smiledelivery_section_srch").unbind("touchstart").bind("touchstart", function() {
		$(".smiledelivery_search input#scb_ip").blur(function() {
		}).blur();
	});

	$(".smiledelivery_search input#scb_ip").blur(function() {
	}).blur();
});

EBAY.UI.SMILEDELIVERY.COMMON.OpenSmileDeliverySearchResultSet = (function () {
    EBAY.UI.SMILEDELIVERY.COMMON.SetSmileDeliverySearchResultSet();
	EBAY.UI.SMILEDELIVERY.UTIL.fixedViewPort(true);
});

EBAY.UI.SMILEDELIVERY.COMMON.CloseSmileDeliverySearchResultSet = (function () {
	EBAY.UI.SMILEDELIVERY.UTIL.fixedViewPort(false);
});

EBAY.UI.SMILEDELIVERY.COMMON.smileDelOtpLyInter = (function () {
	var method = {};
	var member = {};

    method.init = function () {
    	$("#content").append(method.getLayerDom());
        method.setElements();
        method.bindEvents();
    };

    method.reinit = function(){
    	method.setElements();
        method.unBindEvents();
        method.bindEvents();
    }

    method.setElements = function () {
        member.contentMain = $('#content.smiledelivery');
        member.layerWrap = $('.smiledelivery-option-layer');
        member.layerDimmed = member.layerWrap.find('.dimmed');
        member.layerContent = member.layerWrap.find('.smiledelivery-option-layer-inner');
        member.itemImage = member.layerWrap.find('.item-img img');
        member.itemName = member.layerWrap.find('.item-name');
		member.btnLayerClose = member.layerWrap.find('.btn-close');
    };

    method.bindEvents = function () {
		member.btnLayerClose.on('click', $.proxy(method.layerCloseFunc, this));
		member.layerDimmed.on('click', $.proxy(method.layerCloseFunc, this));
    };

    method.unBindEvents = function () {
		member.btnLayerClose.off('click', $.proxy(method.layerCloseFunc, this));
		member.layerDimmed.off('click', $.proxy(method.layerCloseFunc, this));
    };

    method.layerOpenClick = function(){
    	method.reinit();
    	method.layerOpenFunc();
    };

    method.layerCloseClick = function(){
    	method.reinit();
    	method.layerCloseFunc();
    };

    method.layerOpenFunc = function () {
        member.layerWrap.show();
        member.layerDimmed.fadeIn();
        member.layerContent.addClass('open');
        member.contentMain.addClass('on_layer');
        EBAY.UI.SMILEDELIVERY.UTIL.fixedViewPort(true);
    };

    method.layerCloseFunc = function () {
        member.layerDimmed.fadeOut();
        member.layerContent.removeClass('open');
        member.contentMain.removeClass('on_layer');
        setTimeout(function () {
            $('.smiledelivery-option-layer').hide();
            EBAY.UI.SMILEDELIVERY.UTIL.fixedViewPort(false);
        }, 200);
    };

	method.setLayerBasicDom = function(img_url,item_name){
    	member.itemImage.attr('src',img_url);
    	member.itemName.empty().append(item_name);
	};

	method.setLayerOptionDom = function(textDom){
    	$('.smiledelivery-option-layer .scroll-box').empty().append(textDom);
    };

    /* [Start] 마크업 확인용 */
    method.getLayerTestDom = function () {
        var markupTxt = "";
        markupTxt = markupTxt + "						<div class=\"secelct-option\">";
        markupTxt = markupTxt + "							<span class=\"option-title\">색상</span>";
        markupTxt = markupTxt + "							<ul class=\"option-list\">";
        markupTxt = markupTxt + "								<li class=\"selected\"><a href=\"#\">화이트</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">블랙</a></li>";
        markupTxt = markupTxt + "								<li class=\"disabled\"><a href=\"#\">그레이</a></li>";
        markupTxt = markupTxt + "							</ul>";
        markupTxt = markupTxt + "						</div>";
        markupTxt = markupTxt + "						<div class=\"secelct-option\">";
        markupTxt = markupTxt + "							<span class=\"option-title\">입력하세요</span>";
        markupTxt = markupTxt + "							<div class=\"option-input-box\">";
        markupTxt = markupTxt + "								<input type=\"text\" title=\"옵션 입력\" />";
        markupTxt = markupTxt + "							</div>";
        markupTxt = markupTxt + "						</div>";
        markupTxt = markupTxt + "						<div class=\"secelct-option\">";
        markupTxt = markupTxt + "							<span class=\"option-title\">사이즈</span>";
        markupTxt = markupTxt + "							<span class=\"option-notice\">색상을 먼저 선택해주세요.</span>";
        markupTxt = markupTxt + "						</div>";
        markupTxt = markupTxt + "						<div class=\"secelct-option\">";
        markupTxt = markupTxt + "							<span class=\"option-title\">패턴</span>";
        markupTxt = markupTxt + "							<ul class=\"option-list\">";
        markupTxt = markupTxt + "								<li class=\"selected\"><a href=\"#\">라인</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">블루스타</a></li>";
        markupTxt = markupTxt + "								<li class=\"disabled\"><a href=\"#\">삼각형</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">삼선</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">스네이크</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">스퀘어</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">스파이더</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">아일랜드</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">알파벳</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">유나이티드</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">자가드</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">캘리포니아블루그레이</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">체스</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">플래그</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">필리스그린</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">투폰</a></li>";
        markupTxt = markupTxt + "								<li><a href=\"#\">캘리포니아블루그레이캘리포니아블루그레이</a></li>";
        markupTxt = markupTxt + "							</ul>";
        markupTxt = markupTxt + "						</div>";
        return markupTxt;
    };

    var testImgUrl = 'http://pics.auction.co.kr/mobile/smiledelivery/dummy/smiledelivery_dummy_best_item1.png';
    var testItemName = '<span>슬레진저</span> 여성 키높이 슬립온 스니커즈';
    var textDom = method.getLayerTestDom();

    $(function(){
		setTimeout(function() {
			if ($('button.element-info-cart').length > 0) {
				method.setLayerBasicDom(testImgUrl,testItemName);
				method.setLayerOptionDom(textDom);
			}
		}, 500);
    });
    /* [End] 마크업 확인용 */

    method.getLayerDom = function () {
        var markupTxt = "";
        markupTxt = markupTxt + "		<!-- 옵션 레이어 -->";
        markupTxt = markupTxt + "		<div class=\"smiledelivery-option-layer\">";
        markupTxt = markupTxt + "			<div class=\"dimmed\"></div>";
        markupTxt = markupTxt + "			<div class=\"smiledelivery-option-layer-inner\">";
        markupTxt = markupTxt + "				<a href=\"javascript:;\" class=\"btn-close\"><span class=\"sp_sd\">닫기</span></a>";
        markupTxt = markupTxt + "				<div class=\"basic-info-area\">";
        markupTxt = markupTxt + "					<div class=\"item-img\">";
        markupTxt = markupTxt + "						<img src=\"\" alt=\"\">";
        markupTxt = markupTxt + "					</div>";
        markupTxt = markupTxt + "					<p class=\"item-name\"></p>";
        markupTxt = markupTxt + "				</div>";
        markupTxt = markupTxt + "				<div class=\"scroll-box-wrap\" id=\"sdOtpLyScroll\">";
        markupTxt = markupTxt + "					<div class=\"scroll-box\"></div>";
        markupTxt = markupTxt + "				</div>";
        markupTxt = markupTxt + "				<div class=\"cart-info-area\">";
        markupTxt = markupTxt + "					<span class=\"quantity-control\">";
        markupTxt = markupTxt + "						<button type=\"button\" class=\"btn-minus\" disabled>";
        markupTxt = markupTxt + "							<span class=\"sp_sd\"></span>";
        markupTxt = markupTxt + "						</button>";
        markupTxt = markupTxt + "						<input type=\"number\" value=\"1\" title=\"주문수량\" readonly class=\"input_number\" />";
        markupTxt = markupTxt + "						<button type=\"button\" class=\"btn-plus\">";
        markupTxt = markupTxt + "							<span class=\"sp_sd\">+</span>";
        markupTxt = markupTxt + "						</button>";
        markupTxt = markupTxt + "					</span>";
        markupTxt = markupTxt + "					<div class=\"btn-area\">";
        markupTxt = markupTxt + "						<a href=\"javascript:;\" class=\"btn-cart\">장바구니</a>";
        markupTxt = markupTxt + "					</div>";
        markupTxt = markupTxt + "				</div>";
        markupTxt = markupTxt + "			</div>";
        markupTxt = markupTxt + "		</div>";
        markupTxt = markupTxt + "		<!--// 옵션 레이어 -->";

        return markupTxt;
	};

	method.setLayerBasicDomClear = function(){
    	if(member.itemImage.length > 0) member.itemImage.attr('src',"");
    	if(member.itemName.length > 0) member.itemName.empty();
	};

	method.setLayerOptionDomClear = function(){
    	if($('.smiledelivery-option-layer .scroll-box').length > 0) $('.smiledelivery-option-layer .scroll-box').empty();
    };

    return {
        init: method.init,
        layerOpenClick: method.layerOpenClick,
        layerCloseClick: method.layerCloseClick,
		setLayerBasicDom : method.setLayerBasicDom,
		setLayerOptionDom : method.setLayerOptionDom,
		setLayerBasicDomClear : method.setLayerBasicDomClear,
		setLayerOptionDomClear : method.setLayerOptionDomClear
    }
})();

/**
 * 상단 장바구니 게이지 레이어
*/
EBAY.UI.SMILEDELIVERY.COMMON.cartGauageLayer = (function () {
    var nowMoney = 0;
    var method = {};
    var maxMoney = 50000;
    var baseMarkup = $("#head .cart_guage_layer");
	var coinSelector = "<div class=\"coin-flip\">동전튀기기</div>";
	var frames = 36;
	var spriteWidth = 124;
	var timerId = 0;
	var flipTimer = 300;
	var guageballoonSize = 0;

	method.init = function (initMoney) {
        nowMoney = initMoney;
		if ($("#head .cart_guage_layer").length > 0) {
			method.getBaseLayout();
		}
		else {
			$.when($("#head").append("<div class=\"cart_guage_layer\">")).then( function() {
				method.getBaseLayout();
			});
		}
	};

	method.setMemberGuageBase = function() {
		var markup_txt = "";

		markup_txt = markup_txt + "<!-- 장바구니 Guage Layer -->";
        //markup_txt = markup_txt + "<div class=\"cart_guage_layer\">";
        markup_txt = markup_txt + "	<div class=\"blank_cover\">";
        markup_txt = markup_txt + "		<div class=\"g30000 sp_sd\"></div><div class=\"g50000 sp_sd\"></div>";
        markup_txt = markup_txt + "	</div>";
        markup_txt = markup_txt + "	<div class=\"guage\">";
        markup_txt = markup_txt + "		<div class=\"guage_bar\">게이지바<div class=\"cover\"></div><div class=\"graph\"></div></div>";
        markup_txt = markup_txt + "		<span class=\"guage_desc\">10,300원 더 담으면 <span>2천원 적립</span></span>";
		markup_txt = markup_txt + "		<div class=\"guage_balloon\"><span class=\"balloon_money\">0</span><div class=\"money_tip\"></div></div>";
		markup_txt = markup_txt + "</div>";

		$.when($("#head .cart_guage_layer").empty().append(markup_txt)).then(function () {
			var thirty = $(".blank_cover .g30000")
				, fifty = $(".blank_cover .g50000")
				, guagebar = $(".guage .guage_bar");

			setTimeout(function() {
				if (thirty.length > 0) thirty.css("left", (parseInt(thirty.css("left").replace(/[^-\d\.]/g, ''), 10) + ((guagebar.width() * (3 / 5)) - thirty.width())) + "px");
				if ($(".guage .guage_balloon").length > 0) $(".guage .guage_balloon").css("left", (parseInt($(".guage").css("padding-left").replace(/[^-\d\.]/g, ''), 10) - ($(".guage .guage_balloon").outerWidth() / 2)) + "px")
			}, 300);
        });
	}

	method.setNonMemberGuageBase = function() {
		var markup_txt = "";

		markup_txt = markup_txt + "  <span class=\"guest_member\">상품을 장바구니에 담았습니다.</span>";

		$("#head .cart_guage_layer").empty().append(markup_txt);
	}

	method.getBaseLayout = function () {
		/* function 분리한 후 일단 회원용 Guage Layer가 나오도록 해둠 */
		method.setMemberGuageBase();
    }

    method.drawGuageBar = function (value, isAnimation, callback) {
		if($("#head .cart_guage_layer .guage").length > 0)
		{
			var guagebar = $(".guage .guage_bar"),
				graphbar = $(".guage .guage_bar .graph"),
				guageballoon = $(".guage .guage_balloon"),
				guagebar_width = 0,
				guage_padding_left = 0,
				guage_balloon_left = 0,
				guage_speed = guagebar_width > 320 ? 500 : 500;

			$(".balloon_money").empty().text(numberWithCommas(value));

			if (isAnimation) {
				guagebar_width = (value / maxMoney) >= 1 ? guagebar.width() : (value / maxMoney) * guagebar.width();
				guage_padding_left = parseInt($(".guage").css("padding-left").replace(/[^-\d\.]/g, ''), 10);
				guage_balloon_left = (value / maxMoney) >= 1 ? guage_padding_left + (guagebar.width() / 2) - ($(".guage .guage_balloon").outerWidth() / 2) : guage_padding_left + guagebar_width - ($(".guage .guage_balloon").outerWidth() / 2);

				graphbar.animate({ width: guagebar_width }, guage_speed);
				guageballoon.animate({ left: guage_balloon_left }, guage_speed);
			}
			else {
				guagebar_width = (value / maxMoney) >= 1 ? guagebar.width() : (value / maxMoney) * guagebar.width();
				guage_padding_left = parseInt($(".guage").css("padding-left").replace(/[^-\d\.]/g, ''), 10);
				guage_balloon_left = (value / maxMoney) >= 1 ? guage_padding_left + (guagebar.width() / 2) - ($(".guage .guage_balloon").outerWidth() / 2) : guage_padding_left + guagebar_width - ($(".guage .guage_balloon").outerWidth() / 2);

				graphbar.css("width", guagebar_width + "px");
				guageballoon.css("left", guage_balloon_left + "px");
			}


		}

        if (callback) callback();
    }

	method.coinFlip = function (startValue, endValue, callback) {
		if($("#head .cart_guage_layer .guage").length > 0)
		{
			if(endValue < 30000) {
				method.stopFlip(callback);
				return;
			}
			else if(startValue >= 30000 && endValue < 50000) {
				method.stopFlip(callback);
				return;
			}
			else if(startValue >= 50000) {
				method.stopFlip(callback);
				return;
			}


			$.when($(".cart_guage_layer").append(coinSelector))
				.then(function() {
					if(endValue >= 50000) {
						$(".coin-flip").addClass("c50000");
						flipTimer = 400;
					}
					else {
						$(".coin-flip").addClass("c30000");
						flipTimer = 300;
					};
				})
				.then(function() {
					var i = 0;
					setTimeout(function() {
						timerId = setInterval(function() {
							if(i > frames) {
								clearInterval(timerId);
								method.stopFlip(callback);
							}
							else {
								$(".coin-flip").css("background-position", "-"+(i*spriteWidth)+"px 0px");
								i++;
							}
						}, 25);
					}, flipTimer);
				});
		}
		else {
			if(callback) callback();
		}
    };

	method.stopFlip = function(callback) {
		$(".coin-flip").remove();
		if(callback) callback();
	};

    method.setGuageBar = function (startValue, endValue) {
		guageballoonSize = $(".guage .guage_balloon").outerWidth();
		if($("#head.vip").length > 0) {
			$("#simple_header").animate({"opacity":"0"},1500);
			$("#head").removeClass("head_new_groupvip").animate({"z-index":"1010"}, 100, function() {
				method.drawGuageBar(startValue, false, function () { // Resetting
					$("#head .cart_guage_layer").animate({ top: 0 }, 1000, function () { // Layer Down
						method.drawGuageBar(endValue, true, function () { // Graph Draw
							method.coinFlip(startValue, endValue, function() {
								$("#head .cart_guage_layer").delay(2000).animate({ top: -100 }, 1000, function() {
									$.when($("#head").addClass("head_new_groupvip")).then(function() {
										$("#simple_header").animate({"opacity":"1"}, 300);
									});
								});
							});
						});
					});
				});
			});
		}
		else {
			method.drawGuageBar(startValue, false, function () { // Resetting
				$("#head .cart_guage_layer").animate({ top: 0 }, 1000, function () { // Layer Down
						method.drawGuageBar(endValue, true, function () { // Graph Draw
							method.coinFlip(startValue, endValue, function() {
								$("#head .cart_guage_layer").delay(2000).animate({ top: -100 }, 1000); // Layer Up
						});
					});
				});
			});
		}
	}

    return {
        init: method.init,
		setGuageBar: method.setGuageBar,
		setMemberGuageBase : method.setMemberGuageBase,
		setNonMemberGuageBase : method.setNonMemberGuageBase
    }
})();

EBAY.UI.SMILEDELIVERY.UTIL = (function () {
    var config = {};
    var util = {
        $dom: {
            win: $(window),
            body: $('body'),
            header: $('#simple_header')
        },
        cachedWindowOffsetTop: 0,
        prevScrollTop: $(window).scrollTop(),
        currentScrollTop: $(window).scrollTop(),

        // todo 검색결과 없을경우 화면 100% 높이값 처리
        hideActiveUio: function () {
            if ($('.filter-sort-box').hasClass('active')) {
                EBAY.UI.SMILEDELIVERY.COMMON.filterBar.toggleSortingLayer(event)
            }
        },

        getHeaderHeight: function () {
            return this.$dom.header.outerHeight();
        },

        fixedViewPort: function (fixedView) {
            if (fixedView) {
                this.cachedWindowOffsetTop = this.$dom.win.scrollTop();

                $("body").css({
                    'position': 'fixed',
                    'top': this.cachedWindowOffsetTop * -1,
                    'left': '0',
					'right': '0',
					'overflow-y': 'hidden'
                });
            } else {
                $("body").css({
					'position': 'static',
					'overflow-y': 'auto'
                });

                this.$dom.win.scrollTop(this.cachedWindowOffsetTop);
            }
        },

        /**
         * 템플릿 랜더링 메소드
         * @param {object} 파리미터 객체
         * 파라미터 객체 키
         * @param {string} templateId[require] 템플릿 식별자
         * @param {string} appendTarget[require] jquery 객체로 랩핑될 css 선택자 ex) '#filter-wrap', '.filter-list', 'span'
         * @param {string} appendTarget[option] prepend, append로 붙일 곳 위치 선택 default = append
         * @param {object} renderData[options] 템플릿 랜더링에 필요한 json타입 객체
         * @param {function} callBack[options] 콜백
         */
        renderTemplate: function (option) {
            var renderData = option.renderData || {},
    			templateFragment = $.tmpl(option.templateId, renderData),
				appendType = 'append';

            switch (option.appendType) {
                case 'prevend':
                    $(option.appendTarget).prepend(templateFragment);
                    break;
                default:
                    $(option.appendTarget).append(templateFragment);
            }

            option.callBack ? option.callBack() : null;
        },

        numberWithCommas: function (number) {
            return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        },

        getScrollDirection: function () {
            var scrollInfo = {};

            this.currentScrollTop = $(window).scrollTop();

            if (this.currentScrollTop > this.prevScrollTop) {
                this.currentDirection = 'down';
            } else if (this.currentScrollTop < this.prevScrollTop) {
                this.currentDirection = 'up';
            }

            scrollInfo.direction = this.currentDirection;
            scrollInfo.currentTop = this.currentScrollTop;
            scrollInfo.prevTop = this.prevScrollTop;
            this.prevScrollTop = this.currentScrollTop;

            return scrollInfo;
        }
    };

    return util;
})();

// app header
function smileDeliveryAppHeaderCheck(){
	/* android App Check */
	var name="pcid", start, end, pcid = "", isAndroidApp;
	if (document.cookie.length > 0) {
		start = document.cookie.indexOf(name + "=");
		if (start != -1) {
			start = start + name.length + 1;
			end = document.cookie.indexOf(";", start);
			if (end == -1) end = document.cookie.length;

			pcid = unescape(document.cookie.substring(start, end));
		}
	}
	isAndroidApp = (pcid.substr(0, 1) == "3");
	isAndroidApp = false;

	/* ios Version Check */
	var ua = navigator.userAgent.toLowerCase();
	var iosIndex = ua.indexOf('ios');
	var mobileAppIndex = ua.indexOf('mobileapp');
	var isIphoneApp = false;
	var versionStartIndex, versionEndIndex;
	var iosVersion = -1;

	if((mobileAppIndex != -1) && (iosIndex != -1))
		isIphoneApp = true;

	if(isIphoneApp){
		versionStartIndex = iosIndex + 4;
		versionEndIndex = ua.indexOf(';', versionStartIndex);
		iosVersion = parseInt(ua.slice(versionStartIndex, versionEndIndex).replace(/\./g, ""));
	}

	var andIndex = ua.indexOf('android;');
	var andVersion = -1;

	if((mobileAppIndex != -1) && (andIndex != -1))
		isAndroidApp = true;

	if(isAndroidApp){
		versionStartIndex = andIndex + 8;
		versionEndIndex = ua.indexOf(';', versionStartIndex);
		andVersion = parseInt(ua.slice(versionStartIndex, versionEndIndex).replace(/\./g, ""));
	}

	//if(isAndroidApp || isIphoneApp){
	if(isAndroidApp && andVersion >= 660){
		$("#content.smiledelivery").addClass("app_top");
	}
	else if(isIphoneApp && iosVersion >= 660) {
		$("#content.smiledelivery").addClass("app_top");
	}
	else {
		$("#content.smiledelivery").removeClass("app_top");
	}
}

smileDeliveryAppHeaderCheck();

$(function(){

	/* Body Scroll Fixed */
    window.fixedViewPort = (function(){
        var win = $(window),
            body = $('body'),
            scrollTopOffset,
            cachedWindowOffsetTop = 0;

        var _fixedViewPort = function(fixedView){
            cachedWindowOffsetTop = win.scrollTop();

            if (fixedView) {
                body.css({
                    'position': 'fixed',
                    'top': cachedWindowOffsetTop * -1,
                    'left': '0',
                    'right': '0',
                    'overflow-y': 'hidden'
                });
            } else {
                body.css({
                    'position': 'static',
                    'overflow-y': 'auto'
                });
                scrollTopOffset = body.css('top').split('px')[0] * -1;
                win.scrollTop(scrollTopOffset);
            }
        }

        return _fixedViewPort;
    })();
});

EBAY.UI.COMMON.LAYER = {
	open : function(openlayerObj){
		var $target = $(openlayerObj);
		$target.show().attr('tabindex',0).css('outline','none').focus();
	},
	close : function(closelayerObj,focusbackObj){
		var $target = $(closelayerObj);
		var $focusTarget = $(focusbackObj);
        if(!$target.hasClass('box__app-install-banner--active')){
            $target.hide();
        }else{
            $target.removeClass('box__app-install-banner--active');
        }
		if($focusTarget.is('ul' || 'div' || 'ol')){
			$focusTarget.attr('tabindex',0).css('outline','none');
		}else{}
		$focusTarget.focus();
	},
	drawLayerAppinstall : {
		check: function(){
			var getUrlVars = function(){
			    var vars = [], hash;
			    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
			    for(var i = 0; i < hashes.length; i++){
			        hash = hashes[i].split('=');
			        vars.push(hash[0]);
			        vars[hash[0]] = hash[1];
			    }
			    return vars;
			};

			var checkUrlParamAppGatePopup = getUrlVars()['appGatePopup'];
			var checkUrlParamAppGatePopupA = getUrlVars()['appGatePopupA'];
			var checkUrlParamAppGatePopupB = getUrlVars()['appGatePopupB'];
			var checkUrlParamAppGatePopupC = getUrlVars()['appGatePopupC'];
			var checkUrlParamAppGatePopupD = getUrlVars()['appGatePopupD'];
			var checkUrlParamAppGatePopupE = getUrlVars()['appGatePopupE'];
			var checkUrlParamAppGatePopupF = getUrlVars()['appGatePopupF'];

			var isApp = false;
			var checkApp = function(){
				/* android App Check */
				var name="pcid", start, end, pcid = "", isAndroidApp;
				if (document.cookie.length > 0) {
					start = document.cookie.indexOf(name + "=");
					if (start != -1) {
						start = start + name.length + 1;
						end = document.cookie.indexOf(";", start);
						if (end == -1) end = document.cookie.length;

						pcid = unescape(document.cookie.substring(start, end));
					}
				}
				isAndroidApp = (pcid.substr(0, 1) == "3");
				isAndroidApp = false;

				/* ios Version Check */
				var ua = navigator.userAgent.toLowerCase();
				var iosIndex = ua.indexOf('ios');
				var mobileAppIndex = ua.indexOf('mobileapp');
				var isIphoneApp = false;
				var versionStartIndex, versionEndIndex;
				var iosVersion = -1;

				if((mobileAppIndex != -1) && (iosIndex != -1))
					isIphoneApp = true;

				if(isIphoneApp){
					versionStartIndex = iosIndex + 4;
					versionEndIndex = ua.indexOf(';', versionStartIndex);
					iosVersion = parseInt(ua.slice(versionStartIndex, versionEndIndex).replace(/\./g, ""));
				}

				var andIndex = ua.indexOf('android;');
				var andVersion = -1;

				if((mobileAppIndex != -1) && (andIndex != -1))
					isAndroidApp = true;

				if(isAndroidApp){
					versionStartIndex = andIndex + 8;
					versionEndIndex = ua.indexOf(';', versionStartIndex);
					andVersion = parseInt(ua.slice(versionStartIndex, versionEndIndex).replace(/\./g, ""));
				}

				//if(isAndroidApp || isIphoneApp)
				if((isAndroidApp && andVersion >= 660)||(isIphoneApp && iosVersion >= 660)){
					isApp = true;
				}
			}

			checkApp();
            if( !(isApp === true) && (checkUrlParamAppGatePopup === 'true')){
                this.draw();
            }else if(!(isApp === true) && (checkUrlParamAppGatePopupA === 'true')){
				this.drawTypeA();
            }else if(!(isApp === true) && (checkUrlParamAppGatePopupB === 'true')){
                this.drawTypeB();
            }else if(!(isApp === true) && (checkUrlParamAppGatePopupC === 'true')){
                this.drawTypeC();
            }else if(!(isApp === true) && (checkUrlParamAppGatePopupD === 'true')){
                this.drawTypeD();
            }else if(!(isApp === true) && (checkUrlParamAppGatePopupE === 'true')){
                this.drawTypeE();
            }else if(!(isApp === true) && (checkUrlParamAppGatePopupF === 'true')){
                this.drawTypeF();
            }
		},
		removeURLParameter :function(key){
			var url = window.location.href;
			var urlparts= url.split('?');
		    if (urlparts.length>=2) {
		        var prefix= encodeURIComponent(key)+'=';
		        var pars= urlparts[1].split(/[&;]/g);

		        for (var i= pars.length; i-- > 0;) {
		            //idiom for string.startsWith
		            if (pars[i].lastIndexOf(prefix, 0) !== -1) {
		                pars.splice(i, 1);
		            }
		        }
		        url= urlparts[0] + (pars.length > 0 ? '?' + pars.join('&') : "");
		        history.pushState({state:1, rand: Math.random()}, '', url);
		    } else {}
		},
		draw : function(){
			var $body = $('body');
			var currentUrl = $(location).attr('href');
			var encodedUrl = encodeURIComponent(currentUrl);
			var linkUrl = 'http://mobile.gmarket.co.kr/AppGate/V3?link='+encodedUrl+'&app=gmkt&store=true';
			var html = '<div id="layer-banner-appinstall" class="layer-uidimmed__wrap layer-banner-appinstall">';
			html += '<div class="layer-uidimmed">';
			html += '<div class="layer-uidimmed__inner">';
			html += '<img src="//pics.gmarket.co.kr/mobile/banner/banner_extapp.png" alt="gmarket 더 빠르고 편리한 앱에서 쇼핑하세요 " class="layer-banner-appinstall__image">';
			html += '<button class="layer-banner-appinstall__link01"  onclick="EBAY.UI.COMMON.LAYER.drawLayerAppinstall.clickAppstore(\''+linkUrl+'\');event.stopPropagation();pvprofiler.sendEvt(\'click\', \'200002054\', \'link\',{\'url\':\'' + encodedUrl + '\'});return false"><span class="forA11y">g마켓 앱으로 보기</span></button>';
			html += '<button class="layer-banner-appinstall__link02" onclick="pvprofiler.sendEvt(\'click\', \'200002055\', \'link\',{\'url\':\'' + encodedUrl + '\'});EBAY.UI.COMMON.LAYER.close(\'#layer-banner-appinstall\',\'#wrap\');return false"><span class="forA11y">괜찮아요! 모바일웹으로 볼게요</span></button>';
			html += '</div></div>';
			html += '<div class="layer-uidimmed__bg">&nbsp;</div>';
			html += '</div>';
			$body.append(html);

			pvprofiler.sendEvt("click_view", "200002054", "link", JSON.parse('{"url": "' + encodedUrl + '"}'));
		},
		drawTypeA : function(){
            var $body = $('body');
            var currentUrl = $(location).attr('href');
            var encodedUrl = encodeURIComponent(currentUrl);
            var linkUrl = 'http://mobile.gmarket.co.kr/AppGate/V3?link='+encodedUrl+'&app=gmkt&store=true';
            var html = '<div id="layer-banner-appinstall" class="box__app-install-banner">';
            html += '<span class="for-a11y">1,000만 회원의 선택, G마켓! 앱으로 더 빠르고 편하게 쇼핑하세요</span>';
            html += '<button type="button" class="button__app" onclick="EBAY.UI.COMMON.LAYER.drawLayerAppinstall.clickAppstore(\''+linkUrl+'\');event.stopPropagation();pvprofiler.sendEvt(\'click\', \'200002054\', \'link\',{\'url\':\'' + encodedUrl + '\'});return false">';
            html += '<img class="image__banner" src="//pics.gmarket.co.kr/mobile/single/kr/common/appGatePopupA.png" alt="G마켓 앱으로 보기" />';
            html += '</button>';
            html += '<button type="button" class="button__close" onclick="pvprofiler.sendEvt(\'click\', \'200002055\', \'link\',{\'url\':\'' + encodedUrl + '\'});EBAY.UI.COMMON.LAYER.close(\'#layer-banner-appinstall\',\'#wrapper\');return false">';
            html += '<span class="for-a11y">괜찮아요! 모바일웹으로 볼게요</span>';
			html += '</button>';
			html += '</div>';
			$body.append(html);
            this.openBottomBanner();

            pvprofiler.sendEvt("click_view", "200002054", "link", JSON.parse('{"url": "' + encodedUrl + '"}'));
		},
        drawTypeB : function(){
            var $body = $('body');
            var currentUrl = $(location).attr('href');
            var encodedUrl = encodeURIComponent(currentUrl);
            var linkUrl = 'http://mobile.gmarket.co.kr/AppGate/V3?link='+encodedUrl+'&app=gmkt&store=true';
            var html = '<div id="layer-banner-appinstall" class="box__app-install-banner box__app-install-banner--type-b">';
            html += '<span class="for-a11y">빅세일 최대 25만원 할인, 앱으로 더 쉽고 빠르게!</span>';
            html += '<button type="button" class="button__app" onclick="EBAY.UI.COMMON.LAYER.drawLayerAppinstall.clickAppstore(\''+linkUrl+'\');event.stopPropagation();pvprofiler.sendEvt(\'click\', \'200002054\', \'link\',{\'url\':\'' + encodedUrl + '\'});return false">';
            html += '<img class="image__banner" src="//pics.gmarket.co.kr/mobile/single/kr/common/appgatepopup/202107/appGatePopupB.png" alt="G마켓 앱으로 보기" />';
            html += '</button>';
            html += '<button type="button" class="button__close" onclick="pvprofiler.sendEvt(\'click\', \'200002055\', \'link\',{\'url\':\'' + encodedUrl + '\'});EBAY.UI.COMMON.LAYER.close(\'#layer-banner-appinstall\',\'#wrapper\');return false">';
            html += '<span class="for-a11y">괜찮아요! 모바일웹으로 볼게요</span>';
            html += '</button>';
            html += '</div>';
            $body.append(html);
            this.openBottomBanner();

            pvprofiler.sendEvt("click_view", "200002054", "link", JSON.parse('{"url": "' + encodedUrl + '"}'));
        },
        drawTypeC : function(){
            var $body = $('body');
            var currentUrl = $(location).attr('href');
            var encodedUrl = encodeURIComponent(currentUrl);
            var linkUrl = 'http://mobile.gmarket.co.kr/AppGate/V3?link='+encodedUrl+'&app=gmkt&store=true'
            var html = '<div id="layer-banner-appinstall" class="box__app-install-banner box__app-install-banner--type-c">';
            html += '<span class="for-a11y">빅세일 최대 5만원 할인, 앱으로 더 쉽고 빠르게!</span>';
            html += '<button type="button" class="button__app" onclick="EBAY.UI.COMMON.LAYER.drawLayerAppinstall.clickAppstore(\''+linkUrl+'\');event.stopPropagation();pvprofiler.sendEvt(\'click\', \'200002054\', \'link\',{\'url\':\'' + encodedUrl + '\'});return false">';
            html += '<img class="image__banner" src="//pics.gmarket.co.kr/mobile/single/kr/common/appgatepopup/202105/appGatePopupC.png" alt="G마켓 앱으로 보기" />';
            html += '</button>';
            html += '<button type="button" class="button__close" onclick="pvprofiler.sendEvt(\'click\', \'200002055\', \'link\',{\'url\':\'' + encodedUrl + '\'});EBAY.UI.COMMON.LAYER.close(\'#layer-banner-appinstall\',\'#wrapper\');return false">';
            html += '<span class="for-a11y">괜찮아요! 모바일웹으로 볼게요</span>';
            html += '</button>';
            html += '</div>';
            $body.append(html);
            this.openBottomBanner();

            pvprofiler.sendEvt("click_view", "200002054", "link", JSON.parse('{"url": "' + encodedUrl + '"}'));
        },
        drawTypeD : function(){
            var $body = $('body');
            var currentUrl = $(location).attr('href');
            var encodedUrl = encodeURIComponent(currentUrl);
            var linkUrl = 'http://mobile.gmarket.co.kr/AppGate/V3?link=http%3A%2F%2Fm.gmarket.co.kr%2Fevent%2F2021%2FBigS%2F1st%2Fteaser%2Fevent.asp&app=gmkt&store=true'
            var html = '<div id="layer-banner-appinstall" class="box__app-install-banner box__app-install-banner--type-d">';
            html += '<span class="for-a11y">빅세일 최대 20만원 할인, 앱으로 더 쉽고 빠르게!</span>';
            html += '<button type="button" class="button__app" onclick="EBAY.UI.COMMON.LAYER.drawLayerAppinstall.clickAppstore(\''+linkUrl+'\');event.stopPropagation();pvprofiler.sendEvt(\'click\', \'200002054\', \'link\',{\'url\':\'' + encodedUrl + '\'});return false">';
            html += '<img class="image__banner" src="//pics.gmarket.co.kr/mobile/single/kr/common/appgatepopup/202105/appGatePopupD.png" alt="G마켓 앱으로 보기" />';
            html += '</button>';
            html += '<button type="button" class="button__close" onclick="pvprofiler.sendEvt(\'click\', \'200002055\', \'link\',{\'url\':\'' + encodedUrl + '\'});EBAY.UI.COMMON.LAYER.close(\'#layer-banner-appinstall\',\'#wrap\');return false">';
            html += '<span class="for-a11y">괜찮아요! 모바일웹으로 볼게요</span>';
            html += '</button>';
            html += '</div>';
            $body.append(html);
            this.openBottomBanner();

            pvprofiler.sendEvt("click_view", "200002054", "link", JSON.parse('{"url": "' + encodedUrl + '"}'));
        },
        drawTypeE : function(){
            var $body = $('body');
            var currentUrl = $(location).attr('href');
            var encodedUrl = encodeURIComponent(currentUrl);
            var linkUrl = 'http://mobile.gmarket.co.kr/AppGate/V3?link=http%3A%2F%2Fm.gmarket.co.kr%2Fevent%2F2021%2Fbigs%2F1st%2Ftab1.asp&app=gmkt&store=true';
            var html = '<div id="layer-banner-appinstall" class="box__app-install-banner box__app-install-banner--type-e">';
            html += '<span class="for-a11y">빅세일 최대 25만원 할인, 앱으로 더 쉽고 빠르게!</span>';
            html += '<button type="button" class="button__app" onclick="EBAY.UI.COMMON.LAYER.drawLayerAppinstall.clickAppstore(\''+linkUrl+'\');event.stopPropagation();pvprofiler.sendEvt(\'click\', \'200002054\', \'link\',{\'url\':\'' + encodedUrl + '\'});return false">';
            html += '<img class="image__banner" src="//pics.gmarket.co.kr/mobile/single/kr/common/appgatepopup/202107/appGatePopupE.png" alt="앱으로 보기" />';
            html += '</button>';
            html += '<button type="button" class="button__close" onclick="pvprofiler.sendEvt(\'click\', \'200002055\', \'link\',{\'url\':\'' + encodedUrl + '\'});EBAY.UI.COMMON.LAYER.close(\'#layer-banner-appinstall\',\'#wrap\');return false">';
            html += '<span class="for-a11y">괜찮아요! 모바일웹으로 볼게요</span>';
            html += '</button>';
            html += '</div>';
            $body.append(html);
            this.openBottomBanner();

            pvprofiler.sendEvt("click_view", "200002054", "link", JSON.parse('{"url": "' + encodedUrl + '"}'));
        },
        drawTypeF : function(){
            var $body = $('body');
            var currentUrl = $(location).attr('href');
            var encodedUrl = encodeURIComponent(currentUrl);
            var linkUrl = 'http://mobile.gmarket.co.kr/AppGate/V3?link='+encodedUrl+'&app=gmkt&store=true';
            var html = '<div id="layer-banner-appinstall" class="box__app-install-banner">';
            html += '<span class="for-a11y">1,000만 회원의 선택, G마켓! 앱으로 더 빠르고 편하게 쇼핑하세요</span>';
            html += '<button type="button" class="button__app" onclick="EBAY.UI.COMMON.LAYER.drawLayerAppinstall.clickAppstore(\''+linkUrl+'\');event.stopPropagation();pvprofiler.sendEvt(\'click\', \'200002054\', \'link\',{\'url\':\'' + encodedUrl + '\'});return false">';
            html += '<img class="image__banner" src="//pics.gmarket.co.kr/mobile/single/kr/common/appGatePopupA.png" alt="G마켓 앱으로 보기" />';
            html += '</button>';
            html += '<button type="button" class="button__close" onclick="pvprofiler.sendEvt(\'click\', \'200002055\', \'link\',{\'url\':\'' + encodedUrl + '\'});EBAY.UI.COMMON.LAYER.close(\'#layer-banner-appinstall\',\'#wrap\');return false">';
            html += '<span class="for-a11y">괜찮아요! 모바일웹으로 볼게요</span>';
            html += '</button>';
            html += '</div>';
            $body.append(html);
            this.openBottomBanner();

            pvprofiler.sendEvt("click_view", "200002054", "link", JSON.parse('{"url": "' + encodedUrl + '"}'));
        },
		clickAppstore : function(linkUrl){
			if(window.event){
			      window.event.cancelBubble=true;
			}
			$('#layer-banner-appinstall').remove();
			this.removeURLParameter('appGatePopup');
			window.location.href = linkUrl;
		},
		openBottomBanner : function(){
			setTimeout(function(){
                $('.box__app-install-banner').addClass('box__app-install-banner--active');
			});

		}
	}
};


$(function(){
    EBAY.UI.COMMON.LAYER.drawLayerAppinstall.check();
});

/* Body Scroll Fixed */
var fixedViewPort = (function(){
	var win = $(window),
		body = $('body'),
        scrollTopOffset,
        cachedWindowOffsetTop = 0

	var _fixedViewPort = function(fixedView){
        cachedWindowOffsetTop = win.scrollTop();
        if (fixedView) {
            body.css({
                'position': 'fixed',
                'top': cachedWindowOffsetTop * -1,
                'left': '0',
                'right': '0',
                'overflow-y': 'hidden'
            });
        } else {
            body.css({
                'position': 'static',
                'overflow-y': 'auto'
            });
            scrollTopOffset=body.css('top').split('px')[0]*-1;
            win.scrollTop(scrollTopOffset);
        }
	}

	return _fixedViewPort;
})();

/* 당일배송 */
var bridgeTotal = (function(){
    if ($('.bridge_total').length > 0) {
        $('.bridge_wrap').css('padding-bottom',$('.bridge_total').height());
    }
});
$(function(){
    $('.agree_replace .btn_question').click(function(e){
        e.preventDefault();
        $(this).parents('.agree_replace').find('.agree_replace_noti').toggle();
    });
});

var toggleTimepick = function (){
	$('.del_time .btn_timepick').click(function(e){
		e.preventDefault();
		$(this).parents('li').toggleClass('active');
	});
	$('.del_time .group_head .group_tit').each(function(){
		var parentWidth = $(this).parents('.group_head').width();
		$(this).css('max-width',parentWidth - ($(this).siblings('.free_delivery').width()+40));
	});
}

$(document).ready(function(){
    if($(".js_input").length > 0 ) {
        $(".js_input").inputForm();
    }
    if($(".js_select").length > 0 ) {
        $(".js_select").selectForm();
    }

});

//input placeholder
$.fn.inputForm = function () {
    return this.each(function (eq) {
        var trigger = $(this),
            label = trigger.find("label"),
            placeholder = trigger.find(".placeholder"),
            inputType = trigger.find("input[type=text], input[type=password], input[type=number], input[type=tel], textarea"),
            childs = trigger.find("input, textarea, button"),
            btn = trigger.find("button");
        placeholder.first().addClass("first");
        placeholder.on("click", function(){
            if (inputType.is(":disabled") == false) {
                $(this).addClass("blind").next(inputType).focus();
            }
        });
        label.on("mousedown", function() {
            trigger.addClass("frm_down");
        }).on("mouseup",  function() {
            trigger.removeClass("frm_down");
        });
        if ((placeholder.length == 1) && (inputType.length > 1)) {
            // placeholder 1개 이하 & input 1개 이상
            // 보안아이콘 버튼 예외처리
            trigger.addClass("secu_btn");
            childs.on("focus", function(){
                $(this).siblings(".placeholder").addClass("blind");
                trigger.addClass("frm_focus");
            }).on("blur change", function(){
                if(childs.eq(0).val().length == 0 && childs.eq(1).val().length > 0 || childs.eq(0).val().length > 0 && childs.eq(1).val().length > 0){
                    $(this).siblings(".placeholder").addClass("blind");
                } else if(childs.eq(0).val().length > 0) {
                    $(this).siblings(".placeholder").addClass("blind");
                } else if(trigger.find("button").length > 0) {
                    if (btn.eq(1).find("span>span.active").length < 1 && btn.eq(0).find("span>span.active").length < 1) {
                        $(this).siblings(".placeholder").removeClass("blind");
                        btn.children("em").removeClass("blind");
                    } else if (btn.eq(1).find("span>span.active").length > 0 && btn.eq(0).find("span>span.active").length < 1) {
                        $(this).siblings(".placeholder").addClass("blind");
                        btn.eq(0).children("em").removeClass("blind");
                        btn.eq(1).children("em").addClass("blind");
                    } else if (btn.eq(0).find("span>span.active").length > 0 && btn.eq(1).find("span>span.active").length < 1) {
                        $(this).siblings(".placeholder").addClass("blind");
                        btn.eq(0).children("em").addClass("blind");
                        btn.eq(1).children("em").removeClass("blind");
                    } else {
                        $(this).siblings(".placeholder").addClass("blind");
                        btn.children("em").addClass("blind");
                    }
                } else {
                    $(this).siblings(".placeholder").removeClass("blind");
                }
                trigger.removeClass("frm_focus");
            }).blur();
        } else {
            // placeholder 2개 이상
            childs.on("focus", function(){
                $(this).prev(".placeholder").addClass("blind");
                trigger.addClass("frm_focus");
            }).on("blur change", function(){
                if($(this).val() == ""){
                    $(this).prev(".placeholder").removeClass("blind");
                } else {
                    $(this).prev(".placeholder").addClass("blind");
                }
                trigger.removeClass("frm_focus");
            }).blur();
        }
    });
};

//selectbox 디자인 버튼
$.fn.selectForm = function () {
    return this.each(function () {
        var select = $(this).find("select"),
            select_name = select.children("option:selected").text();
        select.siblings("label").find(".label").text(select_name);
        select.on("change", function(){
            var select_name = $(this).children("option:selected").text();
            $(this).siblings("label").find(".label").text(select_name);
        });
        select.on("click focus", function() {
            $(this).parents(".frm_wrap").addClass("frm_focus");
            if($(this).parents(".frm_wrap").find('label').hasClass('disabled')){
                $(this).parents(".frm_wrap").find('label').removeClass('disabled')
            }
        }).on("blur", function(){
            $(this).parents(".frm_wrap").removeClass("frm_focus");
        });
        $(this).find("label").on("click", ">*", function() {
            $(this).parent(".frm_wrap").addClass("frm_focus");
            openSelect();
        });
        function openSelect() {
            var element = select[0], worked = false;
            if (document.createEvent) { // all browsers
                var e = document.createEvent("MouseEvents");
                e.initMouseEvent("mousedown", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
                worked = element.dispatchEvent(e);
            } else if (element.fireEvent) { // ie
                worked = element.fireEvent("onmousedown");
            }
            if (!worked) { // unknown browser / error
            }
        };
    });
};

/**
 * 당일배송 장바구니 게이지 레이어
 */
var gaugeLayerExpressShop = function(){
    this.init();
};

gaugeLayerExpressShop.prototype = {
    init: function(){
        this.setElements();
    },
    setElements: function(){
        this.layerWrap = $('.layer__expressshop-gauge');
        this.gaugeBar = this.layerWrap.find('.gauge');
    },
    /**
     * 장바구니 인터렉션
     * @param totalBasicPirceNumber {number} - 현재 담긴 금액
     * @param totalPrice {number} - 최종 담긴 금액
	 * @param animationType {number} - 0: 1/3 → 2/3, 1: 1/3 → 3/3, 2: 2/3 → 3/3
     */
    gaugeLayerOpenFunc: function(totalBasicPirceNumber, totalPrice, animationType){
        var totalPriceDom = this.layerWrap.find('.price');

        this.layerWrap.addClass('active');
        var $gaugeBar = this.gaugeBar;
        var $layerWrap = this.layerWrap;
        var priceAnimationTimer = setTimeout(function(){
            if(animationType == 0){
                $gaugeBar.addClass('gauge--middle').removeClass('gauge--full');
            }else if(animationType == 1){
                $gaugeBar.removeClass('gauge--middle').addClass('gauge--full');
            }else{
                $gaugeBar.removeClass('gauge--middle').addClass('gauge--full');
            }
            var layerCloseTimer = setTimeout(function(){
                $layerWrap.removeClass('active');
                clearTimeout(layerCloseTimer);
            },2500);
            clearTimeout(priceAnimationTimer);
        }, 500);

        var sumPrice = totalPrice.toLocaleString();
        totalPriceDom.text(sumPrice);

        var prcieAnimation = function(){
            Number.prototype.comma = function() {
                var a = this.toString().split(".");
                a[0] = a[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                return a.join(".")
            };
            $({val : totalBasicPirceNumber}).animate({val : totalPrice},{
                duration : 1000,
                step : function(){
                    totalPriceDom.text(Math.floor(this.val).comma());
                },
                complete : function(){
                    totalPriceDom.text(Math.floor(this.val).comma());
                }
            });
        };
        prcieAnimation();
    }
};

var uxSlidingContent = function($this,target){
	$target = $(target);
	$this = $($this);
	$wrap = $this.parents('.js-sliding-wrap');
	$wrap.toggleClass('js-sliding-wrap--active');
	$this.toggleClass('js-sliding-ctrl-button--active');
	$target.toggle().toggleClass('js-sliding-content--active');
}

window.homeTabInteraction = (function(){
	var member = {}
	var method = {}
	var option = {}
	method.init = function(){
		if(!$('.section__header-navigation').length){return}
		method.setElements();
		method.setOptions();
        method.initLayOut();
        method.scrollFunc();
        method.bindEvents();
	};
	method.setElements = function(){
		member.wrapper = $('#wrap');
		member.headerWrap = member.wrapper.find('#head');
		member.headerSearchWrap = member.headerWrap.find('.hd_wrap');
		member.headerNavWrap = member.headerWrap.find('.menu_scut');
		member.bottomBarWrap = member.wrapper.find('.section__tab-bar-home');
		member.bottomBenefit = member.bottomBarWrap.find('.list-item__benefit .sprite-image');
		member.bottomBenefitTwikle = member.bottomBarWrap.find('.box__animation');
		member.bottomBannerWrap = $('.section__home-bottom-banner .box__home-bottom-banner');
		member.buttonBottomBannerClose = member.bottomBannerWrap.find('.button__close');
		member.expressShopDeliveryScheduleWrap = member.wrapper.find('.box__delivery-schedule');
		member.bottomFloatingBannerWrap = member.wrapper.find('.smileday_icon_banner');
	};
	method.setOptions = function(){
		if (!member.wrapper) method.setElements();

		option.fixedHeight = member.headerNavWrap.offset().top;
		option.fixedNavClass = 'fixed';
	};
    method.initLayOut = function(){
        document.addEventListener("touchstart", function(){}, true);
	};
    method.scrollFunc = function(){
        var lastScrollTop = 0;
        $(window).scroll(function () {
			var scrollTop = $(this).scrollTop();
			if(scrollTop < option.fixedHeight){
				member.headerNavWrap.removeClass(option.fixedNavClass);
				member.expressShopDeliveryScheduleWrap.removeClass(option.fixedNavClass);
			}else if(scrollTop > lastScrollTop){
				member.headerNavWrap.addClass(option.fixedNavClass);
				member.expressShopDeliveryScheduleWrap.addClass(option.fixedNavClass);
			}
			lastScrollTop = scrollTop;
        });
    };
    method.bindEvents = function(){
        member.buttonBottomBannerClose.on('click',function(){
			method.bottomBannerCloseFunc();
			$('.box__sponsor-floating').fadeIn();
		});
	};
    method.bottomAnimationFunc = function(){
        member.bottomBannerWrap.addClass('js-spring-open');
        member.bottomBenefit.addClass('js-shaking-open');
	};
    method.bottomBannerCloseFunc = function(){
        member.bottomBannerWrap.addClass('js-spring-close');
        member.bottomBenefit.addClass('js-shaking-close');
        setTimeout(function(){
            member.bottomBenefitTwikle.addClass('js-twinkle');
            $('.section__home-bottom-banner').hide();
        },100);
	};
    return{
        init : method.init,
        setOptions : method.setOptions,
        bottomAnimationFunc : method.bottomAnimationFunc
    }
})();

var idpwFindUIFunction = function(){
	if($('.list-method-idpwfind').length > 0){
        $('.list-method-idpwfind').uxSlidingMenu({
            'itemClass': 'list-method-idpwfind__item',
            'navigation' : '.list-method-idpwfind__button',
            'activeItemClass': 'list-method-idpwfind__item--active',
            'slidingContentSelector' : '.list-method-idpwfind__content',
            'activeSlidingContentClass' : 'list-method-idpwfind__content--active',
            'clickedShowOnly': true
        });
	}
};



$(function(){
    if($('.page__idpwfind').length || $('.page__id-authenticate').length){
    	idpwFindUIFunction();
    	$('#tab-idpwfind .js_radio').checkForm();
    }

});

//G마켓 첫구매 본인인증 페이지 개선
$(document).ready(function(){

//체크박스 클릭 시 버튼 활성화
	$("#chk_phone").on('click',function(){
		var chk = $('input:checkbox[id="chk_phone"]').is(":checked");
		if(chk==true){
			$("#cnt-content1 button").addClass("active");
		}else{
			$("#cnt-content1 button").removeClass("active");
		}
    });

	$("#chk_card").on('click',function(){
		var chk = $('input:checkbox[id="chk_card"]').is(":checked");
		if(chk==true){
			$("#cnt-content2 button").addClass("active");
		}else{
			$("#cnt-content2 button").removeClass("active");
		}
    });

	$("#chk_ipin").on('click',function(){
		var chk = $('input:checkbox[id="chk_ipin"]').is(":checked");
		if(chk==true){
			$("#cnt-content3 button").addClass("active");
		}else{
			$("#cnt-content3 button").removeClass("active");
		}
    });

	if($('.cnttabs').length > 0){
        $('.cnttabs').uxTabs({'menuSelector':'cnttab_menu li','tabsContentSlector':'cnttab_content'});
	}
});

$.fn.uxTabs = function (options) {
    var settings = $.extend({
        'selector' : 'uxtabs',
        'menuSelector': 'uxtabs_menu',
        'menuBtnElement' : 'a',   //you can use 'a' or 'button' element, 'button'element use with data-' attribute
        'activeTabMenuClass': 'uxtab_menu-active',
        'tabsContentSlector' : 'uxtab_content',
        'activeTabContentClass' : 'uxtab_content-active',
        'speed': 0,
        'autoFirstActivate': false,
        'firstActiveIndex':0
    }, options);
    this.addClass(settings.selector);
    if(settings.autoFirstActivate === true){
        var fisrtMenuElement = this.find('.'+settings.menuSelector).eq(settings.firstActiveIndex);
        var fisrtHash = fisrtMenuElement.find('a').attr('href');
        fisrtMenuElement.addClass(settings.activeTabMenuClass).siblings().removeClass(settings.activeTabMenuClass);
        this.find(fisrtHash).show().addClass(settings.activeTabContentClass);
    };
    this.find('.'+settings.menuSelector).find(settings.menuBtnElement).click(function(e){
        e.preventDefault();
        var hash = $(this).attr('href' || 'data-target');
        var $parent = $(this).parents('.'+settings.selector);
        var $tabContent = $parent.find('.'+settings.tabsContentSlector);
        $parent.find('.'+settings.activeTabMenuClass).removeClass(settings.activeTabMenuClass);
        $tabContent.removeClass(settings.activeTabContentClass).hide();
        $(this).parents('.'+settings.menuSelector).addClass(settings.activeTabMenuClass);
        $(hash).show(settings.speed).addClass(settings.activeTabContentClass);
    });
};

/* 인기 검색어 Service */
var searchFunc = function(){
    $('.article__realtime-search').each(function(){
        if (!$(this).hasClass('js-live') && $(this).find('.list__search-word li').length !== 0){
            $(this).addClass('js-live');
            var realtimeSearch = $(this),
                realtimeSearchBox = realtimeSearch.find('.box__rolling-area'),
                realtimeSearchUl = realtimeSearch.find('.list__search-word'),
                realtimeSearchLi = realtimeSearchUl.find('.list-item'),
                realtimeSearchLiHeight = realtimeSearchUl.find('.list-item').height(),
                buttonView = realtimeSearch.find('.button__view'),
                activeClass = 'js-list__hidden',
                cloneList = null,
                rollAction, lengthList, prevList, lastTop, prevTop, nextTop,
                curTop, init = 0;

            var realtimeRoll = function(){ // Rolling Start
                lengthList = realtimeSearchLi.length,
                    lastTop = -(lengthList*realtimeSearchLiHeight);
                rollAction = setInterval(function(){
                    realtimeRollStart();
                }, 3000)
            }
            var realtimeRollStart = function(){
                curTop = parseInt(realtimeSearchUl.css('top').slice(0,-2)) - realtimeSearchLiHeight;
                prevTop = curTop - realtimeSearchLiHeight;
                nextTop = curTop + realtimeSearchLiHeight;
                if (prevTop == lastTop){
                    cloneList = realtimeSearchUl.clone()
                    cloneList.prependTo(realtimeSearchBox);
                    cloneList.css('top',realtimeSearchLiHeight);
                    cloneList.addClass('js-list-clone');
                }
                else if (curTop == lastTop){
                    prevList = realtimeSearchUl;
                    cloneList.css('top',0);
                }
                else if (nextTop == lastTop){
                    prevList.remove();
                    realtimeSearchUl = cloneList;
                    init = 0;
                }
                realtimeSearchUl.css({
                    top: init - realtimeSearch.height()
                })
                init -= realtimeSearch.height();
            }
            var realtimeRollClear = function(){ // Rolling Clear
                clearInterval(rollAction);
            }
            buttonView.click(function(){
                if (realtimeSearch.hasClass(activeClass)) {
                    $(this).text('인기검색어 닫기');
                    realtimeSearch.removeClass(activeClass);
                    realtimeRollClear();
                } else {
                    $(this).text('인기검색어 보기');
                    realtimeSearch.addClass(activeClass)
                    realtimeRoll();
                }
            });
            if(realtimeSearch.hasClass(activeClass)){
                realtimeRoll();
            }
        }
    });
}


//빅스마일 필터 버튼
button__filterOn = function(){
	$('.filter__bigsmile-area .button__toggle').removeClass('button__filter-off');
	$('.filter__bigsmile-area .button__toggle').addClass('button__filter-on');
	$('.filter__bigsmile-area .button__toggle').find('.button__toggle-back').text('필터켜짐');
}
button__filterOff = function(){
	$('.filter__bigsmile-area .button__toggle').removeClass('button__filter-on');
	$('.filter__bigsmile-area .button__toggle').addClass('button__filter-off');
	$('.filter__bigsmile-area .button__toggle').find('.button__toggle-back').text('필터꺼짐');
}


function notice_layer(){
	var Smilecash_button = $('.js-button__help');
	var Smilecashlayer = $(".js-box__layer-standby");
	var SmilecashLayerClosed = $(".js-box__layer-standby").find('.js-button__closed');
	Smilecash_button.bind('click',function(){
		SmilecashLayerTarget = $(this);
		Smilecashlayer.show().attr('tabindex', 0).focus();
	});
	SmilecashLayerClosed.bind('click',function(){
		Smilecashlayer.hide();
		Smilecash_button.focus();
		Smilecashlayer.removeAttr('tabIndex');
	});
}
$(function(){
	notice_layer();
})

$(window).on("load", function(){
	//VIP CPC - scrollslider
	if($('.vip-togetheritems_inner').length > 0){
        $('.vip-togetheritems_inner').uxeScrollProgressbar();
	}
});

// Old2NewApp banner
NEWAPPGATEDATA =  {
    old2newGateA: {
        myghome : {
            guideImg : "newapp_bottom_img_01",
            textNotice : "<span>최신앱에서 myG를</span> <span>사용해 보세요!</span>",
            textNoticeInfo : "쇼핑알림함을 통해 배송정보, 환불정보,<br>문의답변 내용을 한번에 확인 할 수 있어요.",
            textbutton: "지금 업데이트 하기"
        },
        deliverytracking : {
            guideImg : "newapp_bottom_img_02",
            textNoticeInfo : "최신앱에서는 G마켓 홈에서<br>배송 상태를 바로 확인 할 수 있어요.",
            textbutton: "지금 업데이트 하기"
        },
        ecoupon : {
            guideImg : "newapp_bottom_img_03",
            textNoticeInfo : "최신앱에서는 스마일캐시 적립이<br>많이 되는 상품을 알려드려요.",
            textbutton: "지금 업데이트 하기"
        },
        couponzone : {
            guideImg : "newapp_bottom_img_04",
            textNotice : "6월 1일부터 최신앱에서<br>쿠폰/출첵을 이용해 주세요!",
            textNoticeInfo : "사용중인 앱버전에서는 5월 31일까지만<br>서비스가 제공됩니다.",
            textbutton: "지금 업데이트 하기"
        }
    },
    old2newGateB: {
        myghome : { 
            textNotice: "최신앱에서는 최근 2년 동안의<br><strong>구매 내역을 조회 할 수 있어요!</strong>",
            textbutton: "지금 업데이트 하기"
        },
        deliverytracking : { 
            textNotice: "최신앱에서는 G마켓 홈에서<br><strong>배송상태를 확인 할 수 있어요!</strong>",
            textbutton: "지금 업데이트 하기"
        },
        ecoupon : { 
            textNotice: "최신앱에서는 스마일캐시 적립이<br><strong>많이 되는 상품을 알려드려요!</strong>",
            textbutton: "지금 업데이트 하기"
        },
        couponzone : { 
            textNotice: "현재 앱버전에서는 5/31까지만<br><strong>쿠폰을 받을 수 있어요!</strong>",
            textNoticeInfo: "6월 1일부터는 최신앱에서 쿠폰을 받아주세요.",
            textbutton: "지금 업데이트 하기"
        },
        pluszone : {
            textNotice: "현재 앱버전에서는 5/31까지만<br><strong>출석체크를 할 수 있어요!</strong>",
            textNoticeInfo: "6월 1일부터는 최신앱에서 출석체크를 해주세요.",
            textbutton: "지금 업데이트 하기"
        },
        smileclub : {
            textNotice: "현재 앱버전에서는 5/30까지만<br><strong>쿠폰을 받을 수 있어요!</strong>",
            textNoticeInfo: "5월 31일부터는 최신앱에서 쿠폰을 받아주세요.",
            textbutton: "지금 업데이트 하기"
        },
        smilestamp : {
            textNotice: "현재 앱버전에서는 6/17까지만<br><strong>선물상자를 열 수 있어요!</strong>",
            textNoticeInfo: "6월 18일부터는 최신앱에서 참여해 주세요.",
            textbutton: "지금 업데이트 하기"
        },
        exhibition : { 
            textNotice: "즐거운 이벤트와 다양한 혜택을<br><strong>최신 앱으로 만나요!</strong>",
            textbutton: "지금 업데이트 하기"
        }
    },
    old2newGateC: {
        couponzone : { 
            textNotice: "최신앱에서 쿠폰을 받으세요!",
            textNoticeInfo: "사용중인 앱버전에서는<br>쿠폰을 받을 수 없어요.",
            textbutton: "최신앱에서 쿠폰 받기"
        },
        pluszone : { 
            textNotice: "최신앱에서 출석체크 해주세요!",
            textNoticeInfo: "사용중인 앱버전에서는<br>출석체크를 할 수 없어요.",
            textbutton: "최신앱에서 출석체크 하기"
        },
        smileclub : { 
            textNotice: "최신앱에서 쿠폰을 받으세요!",
            textNoticeInfo: "사용중인 앱버전에서는<br>쿠폰을 받을 수 없어요.",
            textbutton: "최신앱에서 쿠폰 받기"
        },
        smilestamp : { 
            textNotice: "<span>최신앱에서 선물상자를</span> <span>열어주세요!</span>",
            textNoticeInfo: "사용중인 앱버전에서는<br>선물상자를 열 수 없어요.",
            textbutton: "최신앱에서 선물상자 열기"
        }
    }
};